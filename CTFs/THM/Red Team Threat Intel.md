Task 1 - Introduction
----------------------------------------

Theat-Intel (TI) or Cyber Threat Intel (CTI) is the information, or Tactics, Techniques and Proceedures (TTP) attributed ti an adversary and used by defenders to aid in detection. The Red Team can also use this info.

__Questions__
Read the above and continue to the next task.
Answer: _None Needed_

Task 2 - What is Threat Intelligence
-------------------------------------------------------


Defenders can use currenty Indicators of Compromise and TTPs in their TI reports and understand the types of threats they may be dealing with. Note that this Thread Landscape changes daily.

The Blue Teams can use these IOCs to build watchdogs into monitoring so that intruders can be more readily found. From a Red Team perspective, they can use it to see how the Blue team may be prepared.

Here we will start focussing on the Advanced Persistent Threat (APT)

__Questions__
Read the above and continue to the next task.
Answer: _None Needed_


Task 3 - Applying Threat Intel to the Red Team
-----------------------------------------------------------------------

Red Team will leverage CTI to aid in adversary emulation and support evidence of adversary's behavior.

Some TI Platforms:
 **MITRE ATT&CK**, **TIBER-EU**, and **OST Map**.


These cyber frameworks will collect known TTPs and categorize them based on varying characteristics such as,

1.  Threat Group
2.  Kill Chain Phase
3.  Tactic
4.  Objective/Goal

Once we target an adverary based on the identified TTPs for that adversary, we can map them to a cyber kill chain.

The Red teams can use this to analyze and emulate the behaviors of different adversaries.  These behaviors of adveraries are collected through the TTPs and IOCs.

__Questions__
Read the above and continue to the next task.
Answer: _None Needed_

Task 4 - The TIBER-EU Framework
------------------------------------------------------

Threat Intelligence-based Ethical Red Teaming or TIBER-EU was developed by the European Central Bank that centers around threat intel.

This enables National authorities to work with financial institutions/entities to put in place a test program to improve their ability to withstand a real cyber attack.

This framework requires threat intel to feed the red tream's testing.

It uses best practices rather than anything actionable from a red team perspective.


__Questions__
Read the above and continue to the next task.
Answer: _None Needed_


Task 5 - TTP Mapping
-------------------------------------

TTP Mapping is done by the Red Team. It is collecting TTPs and mapping them to a known kill chain. This aides in planning an engagement to emulate an advarsary.

Select a target advarsary:

1. Target Industry
2. Employed Attack Vectors
3. Country of Origin
4. Other Factors

In this task we use **[APT 39](https://attack.mitre.org/groups/G0087/)**, a cyber-espionage group run by the Iranian ministry, known for targeting a wide variety of industries.

Here we will use Lockheed Martin cyber kill chain to map our TTPs

![[Pasted image 20230103095919.png]]

First we collect TTPs from is **[MITRE ATT&CK](https://attack.mitre.org/)**. It provides IDs and descriptions.

We can use **[ATT&CK Navigator](https://mitre-attack.github.io/attack-navigator/)** to help us visualize each TTP and categorize its place in the kill chain.

After mapping in the tools we have something like this:

![[Pasted image 20230103100147.png]]

1.  Reconnaissance:
    -   No identified TTPs, use internal team methodology
2.  Weaponization:
    -   Command and Scripting Interpreter
        -   PowerShell
        -   Python
        -   VBA
    -   User executed malicious attachments
3.  Delivery:
    -   Exploit Public-Facing Applications
    -   Spearphishing
4.  Exploitation:
    -   Registry modification
    -   Scheduled tasks
    -   Keylogging
    -   Credential dumping
5.  Installation:
    -   Ingress tool transfer
    -   Proxy usage
6.  Command & Control:
    -   Web protocols (HTTP/HTTPS)
    -   DNS
7.  Actions on Objectives
    -   Exfiltration over C2

Another graphical TTP framework is **[OST Map](https://www.intezer.com/ost-map/)**.

Other open-source and enterprise threat intelligence platforms can aid red teamers in adversary emulation and TTP mapping, such as,

-   **Mandiant Advantage**
-   **Ontic**
-   **CrowdStrike Falcon**

__Questions__
Read the above and use MITRE ATT&CK Navigator to answer the questions below using a Carbanak layer.
Answer: _None Needed_

How many Command and Control techniques are employed by Carbanak?
Answer: _2_

What signed binary did Carbanak use for defense evasion?
Answer: _Rundll32_

What Initial Access technique is employed by Carbanak?
Answer: _Valid Accounts_


Task 6 - Other Red Team Applications of CTI
---------------------------------------------------------------------


CTI can also be used during engagement execution, emulating the adversary's behavioral characteristics, such as:

-   C2 Traffic
    -   User Agents
    -   Ports, Protocols
    -   Listener Profiles
-   Malware and Tooling
    -   IOCs
    -   Behaviors

First we will showcase C2 Command and Control traffic manipulation. As Red Team we can use CTI to identify the adversaries traffic so we can emulate it.

An example of a red team modifying C2 traffic based on gathered CTI is **[malleable profiles](https://www.cobaltstrike.com/help-malleable-c2)**. A malleable profile allows a red team operator to control multiple aspects of a C2's listener traffic.

Information we wish to implement in the profile can be gathered from ISACs and IOCs/packet captures, Host Headers, POST URIs, Server Responses etc.

We then use this info to make our traffic look similar to get as close to emulating our advarsary as possible.

Next we need to examine the behavioral use of CTI to gain knowledge of the malware and tools our intendeded Advarsary uses so that we use the same ones and have as many of the same vital indicators as possible.

As an example the advarsary always uses a custom dropper. The red team can emulate the dropper by:

-   Identifying traffic
-   Observing syscalls and API calls
-   Identifying overall dropper behavior and objective
-   Tampering with file signatures and IOCs

The Red Team will use all of the info gathered to prepare any specific tools etc needed to emulate the advarsary.

__Questions__
Read the above and continue to the next task.
Answer: _None Needed_


Task 7 - Creating a Theat Intel Driven Campaign
-----------------------------------------------------------------------------

In this task we take all the knowledge we have gained previously to make a full treat intel driven campaign.

We basically follow the same steps for this as we do for planning the campaign:

1.  Identify framework and general kill chain
2.  Determine targeted adversary
3.  Identify adversary's TTPs and IOCs
4.  Map gathered threat intelligence to a kill chain or framework
5.  Draft and maintain needed engagement documentation
6.  Determine and use needed engagement resources (tools, C2 modification, domains, etc.)

| Cyber Kill Chain      | MITRE ATT&CK                  |
| --------------------- | ----------------------------- |
| Recon                 | Reconnaissance                |
| Weaponization         | Execution                     |
| Delivery              | Initial Access                |
| Exploitation          | Initial Access                |
| Installation          | Persistence / Defense Evation |
| Command & Control     | Command and Control           |
| Actions on Objectives | Exfiltration / Impacket       |
|                       |                               |
| 


