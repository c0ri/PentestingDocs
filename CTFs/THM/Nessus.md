Task 1 - Introduction
--------------------------------

Nessus vulnerability scanner is exactly what you think is its! A vulnerability scanner!

It uses techniques similar to Nmap to find and report vulnerabilities, which are then, presented in a nice GUI for us to look at.

Nessus is different from other scanners as it doesn't make assumptions when scanning,

like assuming the web application is running on port 80 for instance.

  

Nessus offers a free and paid service, in which some features are left out from the free to make you more inclined to buy the paid service. 

Their pricing is similar to Burp Suite, so unless you got some spare change, we will be just be using their free version.

  

You can check out their pricing options here: [https://www.tenable.com/products/nessus](https://www.tenable.com/products/nessus)

__Questions:__

I have read the description!
Answer: _None Needed_

Task 2 - Installation
-------------------------------

**Warning**: Do **not** install Nessus on the **THM AttackBox**. It will **not** work, as there's no sufficient space!

Other OS's **will not** be covered in this walkthrough, in which case the official installation guide can be found below. 

 [https://docs.tenable.com/nessus/Content/GettingStarted.htm](https://docs.tenable.com/nessus/Content/GettingStarted.htm)

__Questions:__

<span class="highlight" style="color: yellow; background-color: #072742">Step  #1</span>

![[nessus-1.png]]

Goto [https://www.tenable.com/products/nessus/nessus-essentials](https://www.tenable.com/products/nessus/nessus-essentials) and register an account.

**You will need to do this for an activation code.**
Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #2</span>
![[nessus-2.png]]

We will then download the Nessus-#.##.#-debian6_**amd64.**deb file

Save it to your **/Downloads/** folder
Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #3</span>

In the terminal we will navigate to that folder and run the following command:  

sudo dpkg -i **package_file.deb**

Remember to replace package_file.deb with the file name you downloaded.

![[nessus-3.png]]

Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #4</span>

We will now start the Nessus Service with the command:  

**sudo /bin/systemctl start nessusd.service**

![[nessus-4.png]]

Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #5</span>

Open up Firefox and goto the following URL:  

[https://localhost:8834/](http://localhost:8834/) 

You may be prompted with a security risk alert.

Click **Advanced...** -> **Accept the Risk and Continue**

![[nessus-5.png]]

Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #6</span>

Next, we will set up the scanner.  

Select the option **Nessus Essentials**

![[nessus-6.png]]

Clicking the **Skip** button will bring us to a page, which we will input that code we got in the email from Nessus.
![[nessus-7.png]]

Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #7</span>

Fill out the **Username** and **Password** fields. Make sure to use a strong password!

![[nessus-8.png]]
Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #8</span>

Nessus will now install the **plugins** required for it to function.
![[nessus-9.png]]

This will take some time, which will depend on your internet connection and the hardware attached to your VM.

If the progress bar appears to be **not moving**, it means you do not have **enough space** on the VM to install.
Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #9</span>

**Log in** with the account credentials you made earlier.
![[nessus-10.png]]
Answer: _None Needed_

<span class="highlight" style="color: yellow; background-color: #072742">Step  #10</span>

You have now successfully installed **Nessus**!
![[nessus-11.png]]
Answer: _None Needed_

Task 3 - Navigation and Scans
-----------------------------------------------

__Questions:__

What is the name of the **button** which is used to launch a scan?
**HINT:** Top right blue button
Answer: _New Scan_

What side menu option allows us to create **custom templates**?
**HINT:** One of the options under "Resources"
Answer: _Policies_

What menu allows us to change **plugin** properties such as hiding them or changing their severity?
**HINT:** One of the options under "Resources"
Answer: _Plugin Rules_

In the '**Scan Templates**' section after clicking on '**New Scan**', what scan allows us to see simply what hosts are alive?
Answer: _Host Discovery_

One of the most useful scan types, which is considered to be '**suitable for any host**'?
Answer: _Basic Network Scan_

What scan allows you to '**Authenticate to hosts and enumerate missing updates**'?
Answer: _Credentialed Patch Audit_

What scan is specifically used for scanning **Web Applications**?
Answer: _Web Application Tests_


Task 4 - Scanning
------------------------------

Start the attached Target Machine.


__Questions:__

Create a new '**Basic Network Scan**' targeting the deployed VM. What option can we set under '**BASIC**' (on the left) to set a time for this scan to run? This can be very useful when network congestion is an issue.
Answer: _Schedule_

Under '**DISCOVERY**' (on the left) set the '**Scan Type**' to cover ports 1-65535. What is this type called?
Answer: _Port Scan (all ports)_

What 'Scan Type' can we change to under '**ADVANCED**' for lower bandwidth connection?
Answer: _Scan Low Bandwidth Links_

With these options set, launch the scan.
Answer: _None Needed_

After the scan completes, which '**Vulnerability**' in the '**Port scanners**' family can we view the details of to see the open ports on this host?
![[nessus-12.png]]
Answer: _Nessus SYN Scanner_

What **Apache HTTP Server Version** is reported by Nessus?
**HINT:** Wait for the scan to complete. This will take 1-5 minutes.
![[nessus-13.png]]
Answer: _2.4.99_

Task 5 - Scanning a Web Application
---------------------------------------------------------

**Run a Web Application scan on the VM!**

**(Running this Scan will take some time to complete, please be patient)**


__Questions:__

What is the plugin id of the plugin that determines the HTTP server type and version?
**HINT:** Found on the right after clicking 'HTTP Server Type and Version'
![[nessus-14.png]]
Answer: _10107_

What authentication page is discovered by the scanner that transmits credentials in cleartext?
**HINT:** It has the Severity of Low
Answer: _Login.php_

What is the file extension of the config backup?
**HINT:** It has the Severity of Medium
Answer: _.bak_

Which directory contains example documents? (This will be in a php directory)
**HINT:** In the Browsable Web Directories tab
Answer: _/external/phpids/0.6/docs/examples/_

What vulnerability is this application susceptible to that is associated with X-Frame-Options?
**HINT:** It has the Severity of Medium
Answer: _Clickjacking_



