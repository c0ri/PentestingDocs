Task 1 - Introduction
---------------------------------

OPSEC - “Systematic and proven process by which potential adversaries can be denied information about capabilities and intentions by identifying, controlling, and protecting generally unclassified evidence of the planning and execution of sensitive activities. The process involves five steps: identification of critical information, analysis of threats, analysis of vulnerabilities, assessment of risks, and application of appropriate countermeasures.” 

-NIST

It is critical to deny our adversary the ability to gather info about our capabilities and intentions. This is critical for OPSEC.  OPSEC is indentifying, controlling and protecting that information. 

As we have seen, there a Cyber Kill Chain's like Lockheed Martin's Cyber Kill Chain and MITRE ATT_&CK which help defenders identify the objectives of an adversary and what they want to accomplish


The OPSEC process has five steps:

1.  Identify critical information
2.  Analyse threats
3.  Analyse vulnerabilities
4.  Assess risks
5.  Apply appropriate countermeasures. 

If a defender finds out that you are scanning their network with nmap, they could easily find the IP address you are using to scan it with. If you used the same address to host a phishing site, then it won't be hard to connect the dots and attribute them to the same actor.

OPSEC is not a solution in itself, but is a 5 step proces to help defend critical information from the advarsary. In this room we will check out each step and see how we can improve OPSEC as part of our Red Team Operations.

__Questions__

Aim to memorize the five steps of the OPSEC process as we explain each one in its own task.
Answer: _None Needed_

Task 2 - Critical Information Identification
-----------------------------------------------------------------

Critical Info may change upon the Red Team's misssion or directives, but it would be anything that would hinder or degrade their mission.

Some Examples:
* Client Information. It's unacceptible to share PII such as employee names, roles, etc. This information must be only divuldged using the principle of least privilege (PoLP)
* Red Team Information such as plans, identities, capabiltities and limitations. If the Blue teams knew this, they could defend against us better.
* Tactics, Techniques, and Proceedures (TTP) your team uses to emulate an attack.
* OS, Cloud hosting provider, or C2 framework your team users. Again if the Blue teams know this they can pre-block all that or be watching for it at all times.
* Public IP addresses your team uses.
* Domain names that your team has registered. These also play a big role in phishing campaigns. 
* Hosted Websites

__Questions__

  
Click on View Site and follow through till you get the flag.

(Please note that some browser extensions, such as NoScript, might prevent the site from loading correctly.)
Answer: _THM{OPSEC_CRITICAL_INFO}_

Task 3 - Threat Analysis
-------------------------------------------

The next step is Analysing Threats. This process refers to identifying potential adversaries and their intentions and capabilities.

US Department of Defense [(DoD) Operations Security (OPSEC) Program Manual](https://www.esd.whs.mil/Portals/54/Documents/DD/issuances/dodm/520502m.pdf), we aun ti answer the following:

1. Who - is the adversary
2. What - are their goals
3. What - are their tactics/techniques
4. What - critical info have they obtained

The Red Team's job is to emulate an attack, while the Blue Team's job is to defend so that they can learn lessons and correct before a real adversary strikes. Though the Blue Team's objectives are clear, their initial capabilities may not be known.

Malicious 3rd party players might have different capabilities and intentions and might pause a threat as a result. They may appear harmless or just scanning for low hanging fruit like an unpatched server, but they may be a very capable adversary.

| Adversary           | Intentions         | Capabilities     |
| ------------------- | ------------------ | ---------------- |
| Blue Team           | Keep intruders out | Not always known |
| Malicious 3rd Party | Varies             | Varies           |

As Red Team we must consider any adversary with the intent and capability to be a possible threat to our mission.
```threat = adversary + intent + capability```

An adversary without intent or capability does not pose a threat for our purposes.

__Questions__
  
Try to think of at least one adversary who is not a threat and one who is a threat.
Answer: _None Needed_


Task 4 - Vulnerability Analysis
------------------------------------------------

After analysing the threats, we can start the 3rd step which is to anaylse the vulnerabilities. This is not the same as Cybersecurity vulnerabilities, but rather an OPSEC vulnerability which is when an adversary finds critical information, analyses it and acts on it in such a way as to disrupt our plans.

Example 1:

If you use the same IP to run ops such as phishing, metasploit, nmap scans etc, this can lead to OPSEC vulnerability since if the blue team finds one of them and bans the IP, then everything else would fail.

Example 2:

Your Red Team uses a phishing campaign to collect PII, and then you store it in an un-encrypted datase. Then a malicious 3rd party finds it and uses it to hack into the customer ahead of you. Now instead of running your war game scenarios, you are helping the customer or Blue team expose the login names and passwords.

Other types of information your team may inadvertantly leak on Social Media may tip off a Blue team to investigate how you operate and put up a better defense.

__Questions__

Your red team uses THC-Hydra to find the password for a specific login page. Moreover, they are using the Metasploit framework on the same system as THC-Hydra. Would you consider this an OPSEC vulnerability? (Y/N)
Answer: _Y_

One of the red team members posts a photo of his cat every day. Would this be considered an OPSEC vulnerability? (Y/N)
Answer: __

Your red team went for dinner, took a photo, and tagged every team member on a popular social media platform. Would you consider this an OPSEC vulnerability? (Y/N)
Answer: __

Your red team posts on its website a list of clients you regularly conduct red team exercises with. Would you consider this an OPSEC vulnerability? (Y/N)
Answer: __

One of your red team members posted a photo of her morning coffee. Would you consider this an OPSEC vulnerability? (Y/N)
Answer: __

Task 5 - Risk Assessment
---------------------------------------------




