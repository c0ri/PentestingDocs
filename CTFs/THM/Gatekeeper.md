Today's challenge appears to be a mid-tier windows box with not much to go on. The only 2 questions are what are the user and root flags.

Task1 - Approach the Gates
---------------------------------
Power up the box.

Task2 - Defeat the Gatekeeper and pass through the fire.
--------------------------------

Starting off with a full port scan:


Found an interesting open port.
31337/tcp (Elite)

Logging in with SMB I  see'
```bash
root@ip-10-10-70-233:~# smbclient -L gatekeeper.thm
WARNING: The "syslog" option is deprecated
Enter WORKGROUP\root's password: 

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	Users           Disk      
Reconnecting with SMB1 for workgroup listing.
Connection to gatekeeper.thm failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Failed to connect with SMB1 -- no workgroup available
```

So let's try the Users share:

```bash
root@ip-10-10-70-233:~# smbclient \\\\gatekeeper.thm\\Users
WARNING: The "syslog" option is deprecated
Enter WORKGROUP\root's password: 
Try "help" to get a list of possible commands.
smb: \> ls
  .                                  DR        0  Fri May 15 02:57:08 2020
  ..                                 DR        0  Fri May 15 02:57:08 2020
  Default                           DHR        0  Tue Jul 14 08:07:31 2009
  desktop.ini                       AHS      174  Tue Jul 14 05:54:24 2009
  Share                               D        0  Fri May 15 02:58:07 2020

		7863807 blocks of size 4096. 3862809 blocks available
smb: \> cd Default
smb: \Default\> ls
  .                                 DHR        0  Tue Jul 14 08:07:31 2009
  ..                                DHR        0  Tue Jul 14 08:07:31 2009
  AppData                            DH        0  Tue Jul 14 04:20:08 2009
  Desktop                            DR        0  Tue Jul 14 03:34:59 2009
  Documents                          DR        0  Tue Jul 14 06:08:56 2009
  Downloads                          DR        0  Tue Jul 14 03:34:59 2009
  Favorites                          DR        0  Tue Jul 14 03:34:59 2009
  Links                              DR        0  Tue Jul 14 03:34:59 2009
  Music                              DR        0  Tue Jul 14 03:34:59 2009
  NTUSER.DAT                        AHS   262144  Sun Apr 19 20:51:09 2020
  NTUSER.DAT.LOG                     AH     1024  Tue Apr 12 09:32:10 2011
  NTUSER.DAT.LOG1                    AH   189440  Sun Apr 19 19:52:07 2020
  NTUSER.DAT.LOG2                    AH        0  Tue Jul 14 03:34:08 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TM.blf    AHS    65536  Tue Jul 14 05:45:54 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000001.regtrans-ms    AHS   524288  Tue Jul 14 05:45:54 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000002.regtrans-ms    AHS   524288  Tue Jul 14 05:45:54 2009
  Pictures                           DR        0  Tue Jul 14 03:34:59 2009
  Saved Games                         D        0  Tue Jul 14 03:34:59 2009
  Videos                             DR        0  Tue Jul 14 03:34:59 2009

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Default\> cd Downloads
smb: \Default\Downloads\> ls
  .                                  DR        0  Tue Jul 14 03:34:59 2009
  ..                                 DR        0  Tue Jul 14 03:34:59 2009

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Default\Downloads\> cd ..
smb: \Default\> ls
  .                                 DHR        0  Tue Jul 14 08:07:31 2009
  ..                                DHR        0  Tue Jul 14 08:07:31 2009
  AppData                            DH        0  Tue Jul 14 04:20:08 2009
  Desktop                            DR        0  Tue Jul 14 03:34:59 2009
  Documents                          DR        0  Tue Jul 14 06:08:56 2009
  Downloads                          DR        0  Tue Jul 14 03:34:59 2009
  Favorites                          DR        0  Tue Jul 14 03:34:59 2009
  Links                              DR        0  Tue Jul 14 03:34:59 2009
  Music                              DR        0  Tue Jul 14 03:34:59 2009
  NTUSER.DAT                        AHS   262144  Sun Apr 19 20:51:09 2020
  NTUSER.DAT.LOG                     AH     1024  Tue Apr 12 09:32:10 2011
  NTUSER.DAT.LOG1                    AH   189440  Sun Apr 19 19:52:07 2020
  NTUSER.DAT.LOG2                    AH        0  Tue Jul 14 03:34:08 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TM.blf    AHS    65536  Tue Jul 14 05:45:54 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000001.regtrans-ms    AHS   524288  Tue Jul 14 05:45:54 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000002.regtrans-ms    AHS   524288  Tue Jul 14 05:45:54 2009
  Pictures                           DR        0  Tue Jul 14 03:34:59 2009
  Saved Games                         D        0  Tue Jul 14 03:34:59 2009
  Videos                             DR        0  Tue Jul 14 03:34:59 2009

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Default\> cd AppData
smb: \Default\AppData\> ls
  .                                  DH        0  Tue Jul 14 04:20:08 2009
  ..                                 DH        0  Tue Jul 14 04:20:08 2009
  Local                               D        0  Tue Jul 14 06:08:56 2009
  Roaming                             D        0  Tue Apr 12 09:28:15 2011

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Default\AppData\> cd ..
smb: \Default\> cd ..
smb: \> cd Share
smb: \Share\> ls
  .                                   D        0  Fri May 15 02:58:07 2020
  ..                                  D        0  Fri May 15 02:58:07 2020
  gatekeeper.exe                      A    13312  Mon Apr 20 06:27:17 2020

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Share\> get gatekeeper.exe
getting file \Share\gatekeeper.exe of size 13312 as gatekeeper.exe (4333.2 KiloBytes/sec) (average 4333.3 KiloBytes/sec)
```

So I found this gatekeeper.exe which I am assuming is the target.

Doing some basic interaction with the script:
```bash
root@ip-10-10-70-233:~# nc gatekeeper.thm 31337
help
Hello help!!!
123
Hello 123!!!
/bin/bash
Hello /bin/bash!!!
`/bin/bash`
Hello `/bin/bash`!!!
$(/bin/bash)
Hello $(/bin/bash)!!!
```


Try some fuzzing:

Crash point is:

Downloaded gatekeeper.exe

Putting it on my local windows box so I can examine and test it with Immunity Debugger.

Here is a test exploit script:

```
root@ip-10-10-70-233:~# cat expoloit.py 
import socket

ip = "10.10.12.148"
port = 

offset =
overflow = "A" * offset
retn = ""
padding = ""
payload = ""
eol = "\r\n"

buffer = overflow + retn + padding + payload + eol

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect(ip, port)
    print("Sending exploit...")
    s.send(buffer)
    print("Done!")
except:
    print("Could not connect.")
    
```