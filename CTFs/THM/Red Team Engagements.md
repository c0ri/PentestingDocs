Task1 - Introduction
-------------------------------------

The key to success to well-coordinated planning and communications.

Red team engagement have several varieties such as:

* Tabletop excercises
* Adversary emulation
* Physical assessment

__Questions__

Read the above and continue to the next task.
Answer: _None needed_


Task2 - Defining Scope and Objectives
----------------------------------------------

The enagements can be very complex. It is key to clearly define the objectives of the test.

You also need to decide how focussed each objective is.

Engagements can be generally 2 types..
* General network penetration test
* focused adversary emulation

The latter define a specific APT or group to emulate. This is determined based on the groups that target the companies' particular industries such as finance industries and [APT38](https://content.fireeye.com/apt/rpt-apt38). An internal test is less focussed at will follow more standard TTPs.

One of the keys to a successful engagement is a well defined Scope.

The client's scope will typically define what you cannot do. This can be discussed with the Red Team prior. The following is an example of what kind of verbiage to expect:

-   No exfiltration of data.
-   Production servers are off-limits.
-   10.0.3.8/18 is out of scope.
-   10.0.0.8/20 is in scope.
-   System downtime is not permitted under any circumstances.
-   Exfiltration of PII is prohibited.

When performing these activities its important to understand the implications of the actions and what will happen on a broader scale.

__Questions__

Read the example client objectives and answer the questions below.
Answer: _None needed_

Example 1 - Global Enterprise:

**Objectives:**

1.  Identify system misconfigurations and network weaknesses.
    1.  Focus on exterior systems.
2.  Determine the effectiveness of endpoint detection and response systems.
3.  Evaluate overall security posture and response.
    1.  SIEM and detection measures.
    2.  Remediation.
    3.  Segmentation of DMZ and internal servers.
4.  Use of white cards is permitted depending on downtime and length.
5.  Evaluate the impact of data exposure and exfiltration.

**Scope:**

1.  System downtime is not permitted under any circumstances.
    1.  Any form of DDoS or DoS is prohibited.
    2.  Use of any harmful malware is prohibited; this includes ransomware and other variations.
2.  Exfiltration of PII is prohibited. Use arbitrary exfiltration data.
3.  Attacks against systems within 10.0.4.0/22 are permitted.
4.  Attacks against systems within 10.0.12.0/22 are prohibited.
5.  Bean Enterprises will closely monitor interactions with the DMZ and critical/production systems.
    1.  Any interaction with "*.bethechange.xyz" is prohibited.
    2.  All interaction with "*.globalenterprises.thm" is permitted.

Answer: _None needed_

What CIDR range is permitted to be attacked?
Answer: _10.0.4.0/22_

Is the use of white cards permitted? (Y/N)
Answer: _Y_

Are you permitted to access  "".bethechange.xyz?" (Y/N)
Answer: _N_


Task3 - Rules of Engagement
-----------------------------------------------

The Rules of Engagement (RoE) are a legally binding outline of the client objectives/scope with further details of engagement expectations between both parties. This is the 1st official document and requires proper authorization between the parties. This is more or less a general contract with further amendments such as NDA can be added.

The format/wording is critical since it is legally binding and we must be very clear on the expectations and objectives.

| Section Name                          | Section Details                                                                              |
| ------------------------------------- | -------------------------------------------------------------------------------------------- |
| Executive Summary                     | Overarching summary of all contents and authorization within RoE document                    |
| Pupose                                | Defines why the RoE document is used                                                         |
| References                            | Any references used throughout the RoE document (HIPAA, ISO, etc.)                           |
| Scope                                 | Statement of the agreement to restrictions and guidelines                                    |
| Definitions                           | Definitions of technical terms used throughout the RoE document                              |
| RoE and Support Agreement             | Defines obligations of both parties and general technical expectations of engagement conduct |
| Provisions                            | Define exceptions and additional information from the Rules of Engagement                    |
| Requirements,Restrictions & Authority | Define specific expectations of the red team cell                                            |
| Ground Rules                          | Define limitations of the red team cell's interactions                                       |
| Resolution of Issue/Points of Contact | Contains all essential personnel involved in an engagement                                   |
| Authorization                         | Statement of authorization for the engagement                                                |
| Approval                              | Signatures from both parties approving all subsections of the preceding document             |
| Appendix                              | Any further information from preceding subsections                                           |


Download the document attached to the room. It is a brief document adapted https://redteam.guide/docs/templates/roe_template/

__Questions__

Once downloaded, read the sample document and answer the questions below.
Answer: _None needed_

How many explicit restriction are specified?
Answer: _3_

What is the first access type mentioned in the document?
Answer: _phishing_

Is the red team permitted to attack 192.168.1.0/24? (Y/N)
Answer: _N_

Task4 - Campaign Planning
-------------------------------


Campaign planning is where we take the information that we aquired in the various plans and documents and determine how the Red Team will proceed. 

| Type of Plan      | Explanation of Plan                                                              | Plan Contents                                                |
| ----------------- | -------------------------------------------------------------------------------- | ------------------------------------------------------------ |
| Engagement Plan   | An overarching description of technical requirements of the red team.            | CONOPS, Resource and Personnel Requirements, Timelines       |
| Operations Plan   | An expansion of the Engagement Plan. Goes further into specifics of each detail. | Operators, Known Information, Responsibilities, etc.         |
| Mission Plan      | The exact commands to run and execution time of the engagement.                  | Commands to run, Time Objectives, Responsible Operator, etc. |
| Remendiation Plan | Defines how the engagement will proceed after the campaign is finished.          | Report, Remediation consultation, etc.                       |
|                   |                                                                                  |                                                              |



Another example of a campaign plan is the [redteam.guide](http://redteam.guide/) engagement checklist. The checklist, found [here](https://redteam.guide/docs/checklists/red-team-checklist/),

__Questions__

Read the above and move on to engagement documentation.
Answer: _None Needed_


Task5 - Engagement Documentation
-----------------------------------------------

In this an extention of the campaign planning where we document the planning. It doesn't need to be offical, even emails for example are good.

#### Engagement Plan

| Component                      | Purpose                                                                                             |
| ------------------------------ | --------------------------------------------------------------------------------------------------- |
| CONOPS (Concept of Operations) | Non-technically written overview of how the red team meets client objectives and target the client. |
| Resource Plan                  |    Includes timelines and information required for the red team to be successful—any resource requirements: personnel, hardware, cloud requirements.                                                                                                 |

#### Operation Plan
| Component           | Purpose                                                     |
| ------------------- | ----------------------------------------------------------- |
| Personnel           | Information on employee requirements.                       |
| Stopping Conditions | How and why should the red team stop during the engagement. |
| RoE (optional)      |     -                                                        |
| Technical           |    What knowledge will the red team need to be successful.                                                         |

#### Mission Plan

| Component                    | Purpose |
| ---------------------------- | ------- |
| Command Playbooks (optional) |   Exact commands and tools to run, including when, why, and how. Commonly seen in larger teams with many operators at varying skill levels.      |
| Execution Times              |  Times to begin stages of engagement. Can optionally include exact times to execute tools and commands.       |
| Responsiblities/Roles            Who does what, when.                 |         |

#### Remediation Plan (optional)
| Component | Purpose |
| --------- | ------- |
| Report    |   Summary of engagement details and report of findings.      |
| Remediation/Consul          |   How will the client remediate findings? It can be included in the report or discussed in a meeting between the client and the red team.      |

__Questions__

Read the above and move on to the upcoming engagement specific tasks.
Answer: _None needed_


Task6 - Concept of Operations
--------------------------------------------

The Concept of Operations (CONOPS) stage details the high level overview of the proceedings of an engagement.

Should be semi-technical, assuming target audience are laymen to these concepts. It should not omit common names for tools and targets.

The following are critical components which should be included:

* Client Name
* Service Provider
* Timeframe
* General Objectives/Phases
* Other Training Objectives (Exfiltration)
* High-Level Tools/Techniques planned to be used
* Threat group to emulate (if any)

The general idea is to provide just enough information to get a general undersatnding. They should be easy to read and understand.

__Questions__

Read the example CONOPS and answer the questions below.
Answer: _None needed_

Below is an example of the CONOPS for a mature organization with a strong security posture.

Example 1 - Holo Enterprises:

**CONOPS:**

Holo Enterprises has hired TryHackMe as an external contractor to conduct a month-long network infrastructure assessment and security posture. The campaign will utilize an assumed breach model starting in Tier 3 infrastructure. Operators will progressively conduct reconnaissance and attempt to meet objectives to be determined. If defined goals are not met, the red cell will move and escalate privileges within the network laterally. Operators are also expected to execute and maintain persistence to sustain for a period of three weeks. A trusted agent is expected to intervene if the red cell is identified or burned by the blue cell throughout the entirety of the engagement. The last engagement day is reserved for clean-up and remediation and consultation with the blue and white cell.

The customer has requested the following training objectives: assess the blue team's ability to identify and defend against live intrusions and attacks, Identify the risk of an adversary within the internal network. The red cell will accomplish objectives by employing the use of Cobalt Strike as the primary red cell tool. The red cell is permitted to use other standard tooling only identifiable to the targeted threat.

Based on customer security posture and maturity, the TTP of the threat group: FIN6, will be employed throughout the engagement.

Answer: _None needed_

How long will the engagement last?
Answer: _1 month_

How long is the red cell expected to maintain persistence?
Answer: _3 weeks_

What is the primary tool used within the engagement?
Answer: _Cobalt Strike_


Task7 - Resource Plan
----------------------------------------

The Resource Plan is the 2nd document of the engagement plan, detailing a brief overview of dates, knowlege required, and recource needs.

Unlike CONOPS, this should be written as a bulleted list of sub-sections. 

Here is a general outline:

-   Header
    -   Personnel writing
    -   Dates
    -   Customer
-   Engagement Dates
    -   Reconnaissance Dates
    -   Initial Compromise Dates
    -   Post-Exploitation and Persistence Dates
    -   Misc. Dates
-   Knowledge Required (optional)
    -   Reconnaissance
    -   Initial Compromise
    -   Post-Exploitation
-   Resource Requirements
    -   Personnel
    -   Hardware
    -   Cloud
    -   Misc.

The point here is to gather what is required, but not be too overbearing. It should be straight and to the point.

Navigate to the "_View Site"_  button and read the provided resource plan. Once complete, answer the questions below.
Answer: _None needed_

When will the engagement end? (MM/DD/YYYY)
Answer: _11/14/2021_

What is the budget the red team has for AWS cloud cost?
Answer: _$1000_

Are there any miscellaneous requirements for the engagement? (Y/N)
Answer: _N_



Task8 - Operations Plan
----------------------------------------

This is a flexible document that talks about the specific details of the engagement. This document expands on the CONOPS and should include the majority of the engagement information. The RoE can also be placed within.

Should follow the same scheme as the resource plan using bulleted lists. No standard set of operation plan templates or documents. Here is an example:

-   Header
    -   Personnel writing
    -   Dates
    -   Customer
-   Halting/stopping conditions (can be placed in ROE depending on depth)
-   Required/assigned personnel
-   Specific TTPs and attacks planned
-   Communications plan
-   Rules of Engagement (optional)

The most notable addition to this document is the comunications plan. This discusses how the Red Team will communicate with other cells and the client.

Some examples of communications tools:

-   [vectr.io](http://vectr.io/)
-   Email
-   Slack

__Quetions__

Navigate to the "_View Site"_  button and read the provided operations plan. Once complete, answer the questions below.
Answer: _None needed_

What phishing method will be employed during the initial access phase?
Answer: _spearphishing_

What site will be utilized for communication between the client and red cell?
Answer: _vectr.io_

If there is a system outage, the red cell will continue with the engagement. (T/F)
Answer: _F_


Task9 - Mission Plan
--------------------------------------------

The mission plan:
* Cell-specific
* Details exact locations to be completed by operators
* Uses info from previous plans and asigns actions to them

This document can be done in a variety of ways. It depends on the team involved how they would like to comunicate this info. It can be complex or less detailed. As a minimum it should however include at least the following information:

* Objectives
* Operators
* Exploits/Attacks
* Targets (users/machines/objectives)
* Execution plan variations

The operations plan is a business/client plan where the mission plan is a operator/red-cell plan.

__Questions__

Navigate to the "_View Site"_  button and read the provided mission plan. Once complete, answer the questions below.
Answer: _None Needed_

When will the phishing campaign end? (mm/dd/yyyy)
Answer: _10/23/2021_

Are you permitted to attack 10.10.6.78? (Y/N)
Answer: _N_

When a stopping condition is encountered, you should continue working and determine the solution yourself without a team lead. (T/F)
Answer: _F_


Task 10
------------------------------------------

It is crucial to understand how important proper documenation is prior to Red Team engagements.

__Questions__

Read the above and continue learning!
Answer: _None Needed_


