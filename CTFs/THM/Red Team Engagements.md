Task1 - Introduction
-------------------------------------

The key to success to well-coordinated planning and communications.

Red team engagement have several varieties such as:

* Tabletop excercises
* Adversary emulation
* Physical assessment

__Questions__

Read the above and continue to the next task.
Answer: _None needed_


Task2 - Defining Scope and Objectives
----------------------------------------------

The enagements can be very complex. It is key to clearly define the objectives of the test.

You also need to decide how focussed each objective is.

Engagements can be generally 2 types..
* General network penetration test
* focused adversary emulation

The latter define a specific APT or group to emulate. This is determined based on the groups that target the companies' particular industries such as finance industries and [APT38](https://content.fireeye.com/apt/rpt-apt38). An internal test is less focussed at will follow more standard TTPs.

One of the keys to a successful engagement is a well defined Scope.

The client's scope will typically define what you cannot do. This can be discussed with the Red Team prior. The following is an example of what kind of verbiage to expect:

-   No exfiltration of data.
-   Production servers are off-limits.
-   10.0.3.8/18 is out of scope.
-   10.0.0.8/20 is in scope.
-   System downtime is not permitted under any circumstances.
-   Exfiltration of PII is prohibited.

When performing these activities its important to understand the implications of the actions and what will happen on a broader scale.

__Questions__

Read the example client objectives and answer the questions below.
Answer: _None needed_

Example 1 - Global Enterprise:

**Objectives:**

1.  Identify system misconfigurations and network weaknesses.
    1.  Focus on exterior systems.
2.  Determine the effectiveness of endpoint detection and response systems.
3.  Evaluate overall security posture and response.
    1.  SIEM and detection measures.
    2.  Remediation.
    3.  Segmentation of DMZ and internal servers.
4.  Use of white cards is permitted depending on downtime and length.
5.  Evaluate the impact of data exposure and exfiltration.

**Scope:**

1.  System downtime is not permitted under any circumstances.
    1.  Any form of DDoS or DoS is prohibited.
    2.  Use of any harmful malware is prohibited; this includes ransomware and other variations.
2.  Exfiltration of PII is prohibited. Use arbitrary exfiltration data.
3.  Attacks against systems within 10.0.4.0/22 are permitted.
4.  Attacks against systems within 10.0.12.0/22 are prohibited.
5.  Bean Enterprises will closely monitor interactions with the DMZ and critical/production systems.
    1.  Any interaction with "*.bethechange.xyz" is prohibited.
    2.  All interaction with "*.globalenterprises.thm" is permitted.

Answer: _None needed_

What CIDR range is permitted to be attacked?
Answer: _10.0.4.0/22_

Is the use of white cards permitted? (Y/N)
Answer: _Y_

Are you permitted to access  "".bethechange.xyz?" (Y/N)
Answer: _N_


Task3 - Rules of Engagement
-----------------------------------------------

The Rules of Engagement (RoE) are a legally binding outline of the client objectives/scope with further details of engagement expectations between both parties. This is the 1st official document and requires proper authorization between the parties. This is more or less a general contract with further amendments such as NDA can be added.

The format/wording is critical since it is legally binding and we must be very clear on the expectations and objectives.

| Section Name                          | Section Details                                                                              |
| ------------------------------------- | -------------------------------------------------------------------------------------------- |
| Executive Summary                     | Overarching summary of all contents and authorization within RoE document                    |
| Pupose                                | Defines why the RoE document is used                                                         |
| References                            | Any references used throughout the RoE document (HIPAA, ISO, etc.)                           |
| Scope                                 | Statement of the agreement to restrictions and guidelines                                    |
| Definitions                           | Definitions of technical terms used throughout the RoE document                              |
| RoE and Support Agreement             | Defines obligations of both parties and general technical expectations of engagement conduct |
| Provisions                            | Define exceptions and additional information from the Rules of Engagement                    |
| Requirements,Restrictions & Authority | Define specific expectations of the red team cell                                            |
| Ground Rules                          | Define limitations of the red team cell's interactions                                       |
| Resolution of Issue/Points of Contact | Contains all essential personnel involved in an engagement                                   |
| Authorization                         | Statement of authorization for the engagement                                                |
| Approval                              | Signatures from both parties approving all subsections of the preceding document             |
| Appendix                              | Any further information from preceding subsections                                           |


Download the document attached to the room. It is a brief document adapted https://redteam.guide/docs/templates/roe_template/

__Questions__

Once downloaded, read the sample document and answer the questions below.
Answer: _None needed_

How many explicit restriction are specified?
Answer: _3_

What is the first access type mentioned in the document?
Answer: _phishing_

Is the red team permitted to attack 192.168.1.0/24? (Y/N)
Answer: _N_

Task4 - Campaign Planning
-------------------------------


Campaign planning is where we take the information that we aquired in the various plans and documents and determine how the Red Team will proceed. 

| Type of Plan      | Explanation of Plan                                                              | Plan Contents                                                |
| ----------------- | -------------------------------------------------------------------------------- | ------------------------------------------------------------ |
| Engagement Plan   | An overarching description of technical requirements of the red team.            | CONOPS, Resource and Personnel Requirements, Timelines       |
| Operations Plan   | An expansion of the Engagement Plan. Goes further into specifics of each detail. | Operators, Known Information, Responsibilities, etc.         |
| Mission Plan      | The exact commands to run and execution time of the engagement.                  | Commands to run, Time Objectives, Responsible Operator, etc. |
| Remendiation Plan | Defines how the engagement will proceed after the campaign is finished.          | Report, Remediation consultation, etc.                       |
|                   |                                                                                  |                                                              |



Another example of a campaign plan is the [redteam.guide](http://redteam.guide/) engagement checklist. The checklist, found [here](https://redteam.guide/docs/checklists/red-team-checklist/),

__Questions__

Read the above and move on to engagement documentation.
Answer: _None Needed_


Task5 - Engagement Documentation
-----------------------------------------------

In this an extention of the campaign planning where we document the planning. It doesn't need to be offical, even emails for example are good.

#### Engagement Plan

| Component                      | Purpose                                                                                             |
| ------------------------------ | --------------------------------------------------------------------------------------------------- |
| CONOPS (Concept of Operations) | Non-technically written overview of how the red team meets client objectives and target the client. |
| Resource Plan                  |    Includes timelines and information required for the red team to be successful—any resource requirements: personnel, hardware, cloud requirements.                                                                                                 |

#### Operation Plan
| Component           | Purpose                                                     |
| ------------------- | ----------------------------------------------------------- |
| Personnel           | Information on employee requirements.                       |
| Stopping Conditions | How and why should the red team stop during the engagement. |
| RoE (optional)      |     -                                                        |
| Technical           |    What knowledge will the red team need to be successful.                                                         |

#### Mission Plan

| Component                    | Purpose |
| ---------------------------- | ------- |
| Command Playbooks (optional) |   Exact commands and tools to run, including when, why, and how. Commonly seen in larger teams with many operators at varying skill levels.      |
| Execution Times              |  Times to begin stages of engagement. Can optionally include exact times to execute tools and commands.       |
| Responsiblities/Roles            Who does what, when.                 |         |

#### Remediation Plan (optional)
| Component | Purpose |
| --------- | ------- |
| Report    |   Summary of engagement details and report of findings.      |
| Remediation/Consul          |   How will the client remediate findings? It can be included in the report or discussed in a meeting between the client and the red team.      |

__Questions__

Read the above and move on to the upcoming engagement specific tasks.
Answer: _None needed_

