
Task 1 - Introduction
------------------------------------

In this room we discuss techniques used in password attacks. We'll also cover how to get and generate password lists. Here are some topics:

-   Password profiling
-   Password attacks techniques
-   Online password attacks

### What is a password?

Passwords are used as an authentication method for individuals to access systems or services. Typically only the owner would know the password. This would ensure they are the only ones who can access the service. However, as we have seen many times, passwords and password lists can fall into the wrong hands and unauthorized events/changes may happen. This type of unauthorized access could also lead to loss of private information, theft, severe damage to systems, etc. Passwords can be compromised of letters (both upper and lower case), numbers, and special characters. Those are typically defined by the password policy set by the system administrator.

In the Red team world, a collection of passwords is often referred to as a dictionary or wordlist. Passwords that have a low complexity like:

* password
* 123456
* 11111111
* god
* etc

are easily cracked within seconds. Here are the [top 100 and most common and seen passwords](https://techlabuzz.com/top-100-most-common-passwords/) for your reference. Therefore, it is wise to choose a strong password, and it should be checked again password lists/dictionaries to ensure it doesn't exist. Passwords should contain:

* at LEAST 8 characters, prefereably 12 or more
* Upper case letters
* Lower case letters
* Numbers
* and Special Symbols such as \*&^%$#@

Most companies use a password policy that forces users to create a strong password. It will dictate how many letters, numbers, upper/lowercase and special characters must be used. However, if the attacks figures out the password policy, he could generate a list that satisfies the policy.

### How secure are passwords?

It really depends how they are stored.  Storing passwords in plaintext format is a very bad idea. So is obfuscating methods like using base64 to encode a plaintext password.  Passwords that are encrypted/hashed are the best, but even they can be cracked if an adversary gets access to the system and is able to download them. 

__Questions__

Learn about password attacking techniques in the next task!
Answer: _None Needed_


Task 2 - Password Attacking Techniques
------------------------------------------------------------------

### Password Attack Techniques

Here we will cover some techniques that could be used to perform password attacks:

* dictionary
* brute-force
* rule-based
* guessing

All of these are considered an 'online' attack and must be performed when connected to the target to obtain the password and gain unauthorized access.

### Password Cracking vs. Password Guessing

Password cracking is a technique used to discover passwords from encrypted/hashed data.

Password guessing is a method of guessing passwords based on dictionaries.

Here are some differences between the two:

-   Password guessing is a technique used to target online protocols and services. Therefore, it's considered time-consuming and opens up the opportunity to generate logs for the failed login attempts. A password guessing attack conducted on a web-based system often requires a new request to be sent for each attempt, which can be easily detected. It may cause an account to be locked out if the system is designed and configured securely.
-   Password cracking is a technique performed locally or on systems controlled by the attacker.

__Questions__

Which type of password attack is performed locally?
Answer: _Password Cracking_


Task3 - Password Profiling #1
---------------------------------------------------------
Default, Weak, Leaked, Combined, and Username Wordlists

Having good wordlists is critical to a successful attack. Sometimes, especially if time is of the essence, doing proper recon and knowing how to build wordlists is very important. 

### Default Passwords

Before performing password attacks, it is always worth trying a couple of default passwords. Manufacturers set a default password and put these in the online documentation. Many times systems administrators never change these. Here are some defaults to try:

* admin:admin
* root:root
* root:toor
* admin:123456
* etc

If we know the target, we can look up what the vendor may have set for default password and use that. For example if the target is a Tomcat webserver we could try:

* admin:admin
* tomcat:admin

Here are some website lists that provide default passwords for various products.

-   [](https://cirt.net/passwords)[https://cirt.net/passwords](https://cirt.net/passwords)
-   [](https://default-password.info/)[https://default-password.info/](https://default-password.info/)
-   [](https://datarecovery.com/rd/default-passwords/)[https://datarecovery.com/rd/default-passwords/](https://datarecovery.com/rd/default-passwords/)

### Weak Passwords

Weak passwords that are collected by professionals over time, are put into large wordlists. Here are some common weak password lists:

-   [https://wiki.skullsecurity.org/index.php?title=Passwords](https://wiki.skullsecurity.org/index.php?title=Passwords)[](https://wiki.skullsecurity.org/index.php?title=Passwords) - This includes the most well-known collections of passwords.
-   [SecLists](https://github.com/danielmiessler/SecLists/tree/master/Passwords) - A huge collection of all kinds of lists, not only for password cracking.

### Leaked Passwords

Sensitive data like passwords or hashes maybe publically disclosed or sold after a breach. These leaks are referred to as 'dumps'.  These dumps may contain hashes of passwords which would require cracking. The following are some of the common password lists that have weak and leaked passwords, including webhost, elitehacker,hak5, Hotmail, PhpBB companies' leaks:  

-   [SecLists/Passwords/Leaked-Databases](https://github.com/danielmiessler/SecLists/tree/master/Passwords/Leaked-Databases)

### Combined wordlists

If we want to combine wordlists in Linux, we can do this with the `cat` command like this:

```bash
cat file1.txt file2.txt file3.txt > combined_list.txt
```

Afterwards we can clean up the wordlist and remove the duplicates like this:

```bash
sort combined_list.txt | uniq -u > cleaned_combined_list.txt
```

### Customized wordlists

Using a customized list is one of the best ways to increase our chances of finding valid credentials. Often, company websites show valuable data, such as it's employees, email addresses, etc. It may also contain company products and services which might be used in an employees password.

Tools like **Cewl** can be used to crawl a website and extract strings/keywords. This is a powerful tool to help generate wordlists specific to a company:

```bash
user@thm$ cewl -w list.txt -d 5 -m 5 http://thm.labs
```

-w will write the contents to a file. In this case, list.txt.

-m 5 gathers strings (words) that are 5 characters or more

-d 5 is the depth level of web crawling/spidering (default 2)

http://thm.labs is the URL that will be used

Apply what we discuss using cewl against https://clinic.thmredteam.com/ to parse all words and generate a wordlist with a minimum length of 8. Note that we will be using this wordlist later on with another task!

### Username wordlists

Gathering employee names during enumeration is essential.  We can generate username lists from a target's website. In the following we will assume we have {first name}{last name} (ex: John Smith) and a method for generating these.

-   **{first name}:** john
-   **{last name}:** smith
-   **{first name}{last name}:  johnsmith** 
-   **{last name}{first name}:  smithjohn**  
-   first letter of the **{first name}{last name}: jsmith** 
-   first letter of the **{last name}{first name}: sjohn**  
-   first letter of the **{first name}.{last name}: j.smith** 
-   first letter of the **{first name}-{last name}: j-smith** 
-   and so on

Thankfully, there is a tool username_generator that could help create a list with most of the possible combinations if we have a first name and last name.

```bash
user@thm$ git clone https://github.com/therodri2/username_generator.git
Cloning into 'username_generator'...
remote: Enumerating objects: 9, done.
remote: Counting objects: 100% (9/9), done.
remote: Compressing objects: 100% (7/7), done.
remote: Total 9 (delta 0), reused 0 (delta 0), pack-reused 0
Receiving objects: 100% (9/9), done.

user@thm$ cd username_generator
```

Using python3 username_generator.py -h shows the tool's help message and optional arguments.

```bash
user@thm$ python3 username_generator.py -h
usage: username_generator.py [-h] -w wordlist [-u]

Python script to generate user lists for bruteforcing!

optional arguments:
  -h, --help            show this help message and exit
  -w wordlist, --wordlist wordlist
                        Specify path to the wordlist
  -u, --uppercase       Also produce uppercase permutations. Disabled by default
```

Now let's create a wordlist that contains the full name John Smith to a text file. Then, we'll run the tool to generate the possible combinations of the given full name.

```bash
user@thm$ echo "John Smith" > users.lst
user@thm$ python3 username_generator.py -w users.lst
usage: username_generator.py [-h] -w wordlist [-u]
john
smith
j.smith
j-smith
j_smith
j+smith
jsmith
smithjohn
```

These are just some examples. Feel free to find others.

__Questions__

What is the Juniper Networks ISG 2000 default password?
Answer: _netscreen:netscreen_


Task 4 - Password Profiling #2
----------------------------------------------------
Keyspace Technique and CUPP

