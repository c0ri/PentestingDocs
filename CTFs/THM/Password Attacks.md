
Task 1 - Introduction
------------------------------------

In this room we discuss techniques used in password attacks. We'll also cover how to get and generate password lists. Here are some topics:

-   Password profiling
-   Password attacks techniques
-   Online password attacks

### What is a password?

Passwords are used as an authentication method for individuals to access systems or services. Typically only the owner would know the password. This would ensure they are the only ones who can access the service. However, as we have seen many times, passwords and password lists can fall into the wrong hands and unauthorized events/changes may happen. This type of unauthorized access could also lead to loss of private information, theft, severe damage to systems, etc. Passwords can be compromised of letters (both upper and lower case), numbers, and special characters. Those are typically defined by the password policy set by the system administrator.

In the Red team world, a collection of passwords is often referred to as a dictionary or wordlist. Passwords that have a low complexity like:

* password
* 123456
* 11111111
* god
* etc

are easily cracked within seconds. Here are the [top 100 and most common and seen passwords](https://techlabuzz.com/top-100-most-common-passwords/) for your reference. Therefore, it is wise to choose a strong password, and it should be checked again password lists/dictionaries to ensure it doesn't exist. Passwords should contain:

* at LEAST 8 characters, prefereably 12 or more
* Upper case letters
* Lower case letters
* Numbers
* and Special Symbols such as \*&^%$#@

Most companies use a password policy that forces users to create a strong password. It will dictate how many letters, numbers, upper/lowercase and special characters must be used. However, if the attacks figures out the password policy, he could generate a list that satisfies the policy.

### How secure are passwords?

It really depends how they are stored.  Storing passwords in plaintext format is a very bad idea. So is obfuscating methods like using base64 to encode a plaintext password.  Passwords that are encrypted/hashed are the best, but even they can be cracked if an adversary gets access to the system and is able to download them. 

__Questions__

Learn about password attacking techniques in the next task!
Answer: _None Needed_


Task 2 - Password Attacking Techniques
------------------------------------------------------------------

### Password Attack Techniques

Here we will cover some techniques that could be used to perform password attacks:

* dictionary
* brute-force
* rule-based
* guessing

All of these are considered an 'online' attack and must be performed when connected to the target to obtain the password and gain unauthorized access.

### Password Cracking vs. Password Guessing

Password cracking is a technique used to discover passwords from encrypted/hashed data.

Password guessing is a method of guessing passwords based on dictionaries.

Here are some differences between the two:

-   Password guessing is a technique used to target online protocols and services. Therefore, it's considered time-consuming and opens up the opportunity to generate logs for the failed login attempts. A password guessing attack conducted on a web-based system often requires a new request to be sent for each attempt, which can be easily detected. It may cause an account to be locked out if the system is designed and configured securely.
-   Password cracking is a technique performed locally or on systems controlled by the attacker.

__Questions__

Which type of password attack is performed locally?
Answer: _Password Cracking_


Task3 - Password Profiling #1
---------------------------------------------------------
Default, Weak, Leaked, Combined, and Username Wordlists

Having good wordlists is critical to a successful attack. Sometimes, especially if time is of the essence, doing proper recon and knowing how to build wordlists is very important. 

### Default Passwords

Before performing password attacks, it is always worth trying a couple of default passwords. Manufacturers set a default password and put these in the online documentation. Many times systems administrators never change these. Here are some defaults to try:

* admin:admin
* root:root
* root:toor
* admin:123456
* etc

If we know the target, we can look up what the vendor may have set for default password and use that. For example if the target is a Tomcat webserver we could try:

* admin:admin
* tomcat:admin

Here are some website lists that provide default passwords for various products.

-   [](https://cirt.net/passwords)[https://cirt.net/passwords](https://cirt.net/passwords)
-   [](https://default-password.info/)[https://default-password.info/](https://default-password.info/)
-   [](https://datarecovery.com/rd/default-passwords/)[https://datarecovery.com/rd/default-passwords/](https://datarecovery.com/rd/default-passwords/)

### Weak Passwords

Weak passwords that are collected by professionals over time, are put into large wordlists. Here are some common weak password lists:

-   [https://wiki.skullsecurity.org/index.php?title=Passwords](https://wiki.skullsecurity.org/index.php?title=Passwords)[](https://wiki.skullsecurity.org/index.php?title=Passwords) - This includes the most well-known collections of passwords.
-   [SecLists](https://github.com/danielmiessler/SecLists/tree/master/Passwords) - A huge collection of all kinds of lists, not only for password cracking.

### Leaked Passwords

Sensitive data like passwords or hashes maybe publically disclosed or sold after a breach. These leaks are referred to as 'dumps'.  These dumps may contain hashes of passwords which would require cracking. The following are some of the common password lists that have weak and leaked passwords, including webhost, elitehacker,hak5, Hotmail, PhpBB companies' leaks:  

-   [SecLists/Passwords/Leaked-Databases](https://github.com/danielmiessler/SecLists/tree/master/Passwords/Leaked-Databases)

### Combined wordlists

If we want to combine wordlists in Linux, we can do this with the `cat` command like this:

```bash
cat file1.txt file2.txt file3.txt > combined_list.txt
```

Afterwards we can clean up the wordlist and remove the duplicates like this:

```bash
sort combined_list.txt | uniq -u > cleaned_combined_list.txt
```

### Customized wordlists

Using a customized list is one of the best ways to increase our chances of finding valid credentials. Often, company websites show valuable data, such as it's employees, email addresses, etc. It may also contain company products and services which might be used in an employees password.

Tools like **Cewl** can be used to crawl a website and extract strings/keywords. This is a powerful tool to help generate wordlists specific to a company:

```bash
user@thm$ cewl -w list.txt -d 5 -m 5 http://thm.labs
```

-w will write the contents to a file. In this case, list.txt.

-m 5 gathers strings (words) that are 5 characters or more

-d 5 is the depth level of web crawling/spidering (default 2)

http://thm.labs is the URL that will be used

Apply what we discuss using cewl against https://clinic.thmredteam.com/ to parse all words and generate a wordlist with a minimum length of 8. Note that we will be using this wordlist later on with another task!

### Username wordlists

Gathering employee names during enumeration is essential.  We can generate username lists from a target's website. In the following we will assume we have {first name}{last name} (ex: John Smith) and a method for generating these.

-   **{first name}:** john
-   **{last name}:** smith
-   **{first name}{last name}:  johnsmith** 
-   **{last name}{first name}:  smithjohn**  
-   first letter of the **{first name}{last name}: jsmith** 
-   first letter of the **{last name}{first name}: sjohn**  
-   first letter of the **{first name}.{last name}: j.smith** 
-   first letter of the **{first name}-{last name}: j-smith** 
-   and so on

Thankfully, there is a tool username_generator that could help create a list with most of the possible combinations if we have a first name and last name.

```bash
user@thm$ git clone https://github.com/therodri2/username_generator.git
Cloning into 'username_generator'...
remote: Enumerating objects: 9, done.
remote: Counting objects: 100% (9/9), done.
remote: Compressing objects: 100% (7/7), done.
remote: Total 9 (delta 0), reused 0 (delta 0), pack-reused 0
Receiving objects: 100% (9/9), done.

user@thm$ cd username_generator
```

Using python3 username_generator.py -h shows the tool's help message and optional arguments.

```bash
user@thm$ python3 username_generator.py -h
usage: username_generator.py [-h] -w wordlist [-u]

Python script to generate user lists for bruteforcing!

optional arguments:
  -h, --help            show this help message and exit
  -w wordlist, --wordlist wordlist
                        Specify path to the wordlist
  -u, --uppercase       Also produce uppercase permutations. Disabled by default
```

Now let's create a wordlist that contains the full name John Smith to a text file. Then, we'll run the tool to generate the possible combinations of the given full name.

```bash
user@thm$ echo "John Smith" > users.lst
user@thm$ python3 username_generator.py -w users.lst
usage: username_generator.py [-h] -w wordlist [-u]
john
smith
j.smith
j-smith
j_smith
j+smith
jsmith
smithjohn
```

These are just some examples. Feel free to find others.

__Questions__

What is the Juniper Networks ISG 2000 default password?
Answer: _netscreen:netscreen_


Task 4 - Password Profiling #2
----------------------------------------------------
Keyspace Technique and CUPP

### Keyspace Technique

In this technique we specify a range of characters, numbers and symbols in our wordlist. `crunch` is one of the many powerful tools for creating an offline wordlist.  We can also specify numerous options:

```bash
 kali@kali  ~  crunch -h                                                    
crunch version 3.6

Crunch can create a wordlist based on criteria you specify.  The output from crunch can be sent to the screen, file, or to another program.

Usage: crunch <min> <max> [options]
where min and max are numbers

Please refer to the man page for instructions and examples on how to use crunch.
```

The following example creates a wordlist containing all possible combinations of 2 characters, including 0-4 and a-d. We can use the -o argument and specify a file to save the output to.

```bash
 kali@kali  ~  crunch 2 2 01234abcd -o crunch.txt
Crunch will now generate the following amount of data: 243 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 81 

crunch: 100% completed generating output
```

Here is a snippet of the output:

```bash
 kali@kali  ~  cat crunch.txt                    
00
01
02
03
04
0a
0b
0c
0d
10
[..]
d0
d1
d2
d3
d4
da
db
dc
dd
```

You can generate very large files as well depending on the options/requirements you give it.

For example:

```bash
 kali@kali  ~  crunch 8 8 0123456789abcdefABCDEF -o crunch.txt
```

Will generate  a filesize of 459 GB and will contain 54875873536 words.

`crunch` also has a handy `-t` option so we can combine words. Here are some options:

@ - lower case alpha characters

, - upper case alpha characters

% - numeric characters

^ - special characters including space

For example, if part of the password is known to us, and we know it starts with pass and follows two numbers, we can use the % symbol from above to match the numbers. Here we generate a wordlist that contains pass followed by 2 numbers:

```bash
 kali@kali  ~   crunch 6 6 -t pass%%
Crunch will now generate the following amount of data: 700 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 100
pass00
pass01
pass02
pass03
```


### CUPP - Common User Passwords Profiler

CUPP is an automatic and interactive tool written in Python that allows for creating custom wordlists. If you know some details about the target like birthdays, pet names, company, etc. this could help target their legitimate password.

CUPP will take the information you provide and generate a password list on that with various changes. It also supports `1337/leet` mode for replaces letters like  a, i,e, t, o, s, g, z  with numbers. For example, replace a  with 4  or i with 1. For more information about the tool, please visit the GitHub repo [here](https://github.com/Mebus/cupp).

```bash
 kali@kali  ~  git clone https://github.com/Mebus/cupp.git
Cloning into 'cupp'...
remote: Enumerating objects: 237, done.
Receiving objects: 100% (237/237), 2.14 MiB | 15.24 MiB/s, done.
remote: Total 237 (delta 0), reused 0 (delta 0), pack-reused 237
Resolving deltas: 100% (125/125), done.
```

After changing into the directory we cloned, we can run it to show options:

```bash
kali@kali  ~/cupp   master  python3 cupp.py          
 ___________ 
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\   
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]

usage: cupp.py [-h] [-i | -w FILENAME | -l | -a | -v] [-q]

Common User Passwords Profiler

options:
  -h, --help         show this help message and exit
  -i, --interactive  Interactive questions for user password profiling
  -w FILENAME        Use this option to improve existing dictionary, or WyD.pl output to make
                     some pwnsauce
  -l                 Download huge wordlists from repository
  -a                 Parse default usernames and passwords directly from Alecto DB. Project
                     Alecto uses purified databases of Phenoelit and CIRT which were merged
                     and enhanced
  -v, --version      Show the version of this program.
  -q, --quiet        Quiet mode (don't print banner)
```

CUPP supports an interactive mode usnig `-i` option.

```bash
user@thm$  python3 cupp.py -i
 ___________
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]


[+] Insert the information about the victim to make a dictionary
[+] If you don't know all the info, just hit enter when asked! ;)

> First Name: 
> Surname: 
> Nickname: 
> Birthdate (DDMMYYYY): 


> Partners) name:
> Partners) nickname:
> Partners) birthdate (DDMMYYYY):


> Child's name:
> Child's nickname:
> Child's birthdate (DDMMYYYY):


> Pet's name:
> Company name:


> Do you want to add some key words about the victim? Y/[N]:
> Do you want to add special chars at the end of words? Y/[N]:
> Do you want to add some random numbers at the end of words? Y/[N]:
> Leet mode? (i.e. leet = 1337) Y/[N]:

[+] Now making a dictionary...
[+] Sorting list and removing duplicates...
[+] Saving dictionary to .....txt, counting ..... words.
> Hyperspeed Print? (Y/n)
```

ِAs a result, a custom wordlist that contains various numbers of words based on your entries is generated. Pre-created wordlists can be downloaded to your machine as follows:

CUPP

```bash
kali@kali  ~/cupp   master   python3 cupp.py -l
 ___________
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]


        Choose the section you want to download:

     1   Moby            14      french          27      places
     2   afrikaans       15      german          28      polish
     3   american        16      hindi           29      random
     4   aussie          17      hungarian       30      religion
     5   chinese         18      italian         31      russian
     6   computer        19      japanese        32      science
     7   croatian        20      latin           33      spanish
     8   czech           21      literature      34      swahili
     9   danish          22      movieTV         35      swedish
    10   databases       23      music           36      turkish
    11   dictionaries    24      names           37      yiddish
    12   dutch           25      net             38      exit program
    13   finnish         26      norwegian


        Files will be downloaded from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/ repository

        Tip: After downloading wordlist, you can improve it with -w option

> Enter number:
```

Based on your interest, you can choose the wordlist from the list above to aid in generating wordlists for brute-forcing!

Finally, CUPP could also provide default usernames and passwords from the Alecto database by using the -a option. 

CUPP

```bash
kali@kali  ~/cupp   master   python3 cupp.py -a
 ___________
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]


[+] Checking if alectodb is not present...
[+] Downloading alectodb.csv.gz from https://github.com/yangbh/Hammer/raw/b0446396e8d67a7d4e53d6666026e078262e5bab/lib/cupp/alectodb.csv.gz ...

[+] Exporting to alectodb-usernames.txt and alectodb-passwords.txt
[+] Done.
```


__Questions__
  
Run the following crunch command:crunch 2 2 01234abcd -o crunch.txt. How many words did crunch generate?
Note: We ran this command 1st. If we look closely at the output it says 81 lines written to file.
Answer: _81_

What is the crunch command to generate a list containing THM@! and output to a file named tryhackme.txt?
Answer:  _crunch 5 5 -t THM^^ -o tryhackme.txt_

NOTE: This one is a bit tricky. First instinct is to just use the entire string `THM@!` but it just needs a word, and if you read the output carefully it says 'create a list containing...' so we use the special double carat modifier to generate all options using special characters after the word `THM..`


Task 5 - Offline Attacks
------------------------------------------
Dictionary and Brute-Force

### Dictionary attack

This attack uses a list of words from a text file that contain well-known words or phrases. We can use this word list with various tools to make password guessing faster and easier. In this section we will use `hashcat` which is a popular hash cracking tool.

Let's say we have obtained a hash `f806fc5a2a0d5ba2471600758452799c`. In order to crack it we need to know:

* What type of hash it is
* What wordlist or attack mode we can use

There are some tools we can use to id the hash such as:

* hashid
* hash-identifier
* Online tools such as crackstation

For this example, hash-identifier believed the possible hashing method is MD5. Please note the time to crack a hash will depend on the hardware you're using (CPU and/or GPU).

```bash
 kali@kali  ~  hashcat -a 0 -m 0 --force f806fc5a2a0d5ba2471600758452799c /usr/share/wordlists/rockyou.txt
hashcat (v6.2.6) starting

You have enabled --force to bypass dangerous warnings and errors!
This can hide serious problems and should only be done when debugging.
Do not report hashcat issues encountered when using --force.

OpenCL API (OpenCL 3.0 PoCL 3.0+debian  Linux, None+Asserts, RELOC, LLVM 14.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
============================================================================================================================================
* Device #1: pthread-11th Gen Intel(R) Core(TM) i7-1165G7 @ 2.80GHz, 2918/5900 MB (1024 MB allocatable), 2MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

ATTENTION! Pure (unoptimized) backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Temperature abort trigger set to 90c

Host memory required for this attack: 0 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

f806fc5a2a0d5ba2471600758452799c:rockyou                  
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 0 (MD5)
Hash.Target......: f806fc5a2a0d5ba2471600758452799c
Time.Started.....: Wed Jan 25 09:59:03 2023, (0 secs)
Time.Estimated...: Wed Jan 25 09:59:03 2023, (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:    17341 H/s (0.10ms) @ Accel:512 Loops:1 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 1024/14344385 (0.01%)
Rejected.........: 0/1024 (0.00%)
Restore.Point....: 0/14344385 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: 123456 -> bethany
Hardware.Mon.#1..: Util: 21%

Started: Wed Jan 25 09:59:03 2023
Stopped: Wed Jan 25 09:59:05 2023
```

-a 0  sets the attack mode to a dictionary attack

-m 0  sets the hash mode for cracking MD5 hashes; for other types, run hashcat -h for a list of supported hashes.

f806fc5a2a0d5ba2471600758452799c this option could be a single hash like our example or a file that contains a hash or multiple hashes.

/usr/share/wordlists/rockyou.txt the wordlist/dictionary file for our attack

We run hashcat with --show option to show the cracked value if the hash has been cracked:
```bash
 kali@kali  ~  hashcat -a 0 -m 0 F806FC5A2A0D5BA2471600758452799C /usr/share/wordlists/rockyou.txt --show
f806fc5a2a0d5ba2471600758452799c:rockyou
```

The output of this is in the original hashcat command, but using this its clear to see the password for the cracked hash is `rockyou`

### Brute-Force attack

Brute-force is another method of guessing the password. This method uses a method of sending standard password combinations. The difference between this method and a dictionary based attack is that the dictionary attack uses a wordlist.

The brute-force method will try all combinations of a character or characters. In the case where you know a bank account #, but need a 4 digit pin to login, you could brute-force all numbers from 0000 to 9999.  In another case you may add a sequence of numbers or letters to a partially known password such as `admin0`, `admin1`, ... `admin9999` 

`hashcat` has a charset option that could be used to generate your own combinations:

```bash
 kali@kali  ~  hashcat --help
 ? | Charset
 ===+=========
  l | abcdefghijklmnopqrstuvwxyz
  u | ABCDEFGHIJKLMNOPQRSTUVWXYZ
  d | 0123456789
  h | 0123456789abcdef
  H | 0123456789ABCDEF
  s |  !"#$%&'()*+,-./:;<=>?@[\]^_`{|}~
  a | ?l?u?d?s
  b | 0x00 - 0xff
```

The following example shows how we can use hashcat with the brute-force attack mode with a combination of our choice.

```bash
 kali@kali  ~  hashcat -a 3 ?d?d?d?d --stdout 1234 0234 2234 3234 9234 4234 5234 8234 7234 6234 .. ..
```

NOTE: If you are using ZSH for your shell, you might get something like this:
```bash
 kali@kali  ~  hashcat -a 3 ?d?d?d?d --stdout
zsh: no matches found: ?d?d?d?d
```
If that's the case just type `bash` to get into bash before running your command, and afterwards you can go back to zsh by typing `exit`

-a 3  sets the attacking mode as a brute-force attack

?d?d?d?d the ?d tells hashcat to use a digit. In our case, ?d?d?d?d for four digits starting with 0000 and ending at 9999

--stdout print the result to the terminal

Now let's apply the same concept to crack the following MD5 hash: 05A5CF06982BA7892ED2A6D38FE832D6 a four-digit PIN number.

```bash
┌──(kali㉿kali)-[~]
└─$ hashcat -a 3 -m 0 05A5CF06982BA7892ED2A6D38FE832D6 ?d?d?d?d
05a5cf06982ba7892ed2a6d38fe832d6:2021

Session..........: hashcat
Status...........: Cracked
Hash.Name........: MD5
Hash.Target......: 05a5cf06982ba7892ed2a6d38fe832d6
Time.Started.....: Mon Oct 11 10:54:06 2021 (0 secs)
Time.Estimated...: Mon Oct 11 10:54:06 2021 (0 secs)
Guess.Mask.......: ?d?d?d?d [4]
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........: 16253.6 kH/s (0.10ms) @ Accel:1024 Loops:10 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 10000/10000 (100.00%)
Rejected.........: 0/10000 (0.00%)
Restore.Point....: 0/1000 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-10 Iteration:0-10
Candidates.#1....: 1234 -> 6764

Started: Mon Oct 11 10:54:05 2021
Stopped: Mon Oct 11 10:54:08 2021

┌──(kali㉿kali)-[~]
└─$ hashcat -a 3 -m 0 05A5CF06982BA7892ED2A6D38FE832D6 ?d?d?d?d --show
05a5cf06982ba7892ed2a6d38fe832d6:2021
```

__Questions__

Considering the following hash: 8d6e34f987851aa599257d3831a1af040886842f. What is the hash type?

```bash
 kali@kali  ~  hash-identifier  hash-identifier                                                                             
   #########################################################################
   #     __  __                     __           ______    _____           #
   #    /\ \/\ \                   /\ \         /\__  _\  /\  _ `\         #
   #    \ \ \_\ \     __      ____ \ \ \___     \/_/\ \/  \ \ \/\ \        #
   #     \ \  _  \  /'__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #
   #      \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #
   #       \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #
   #        \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #
   #                                                             By Zion3R #
   #                                                    www.Blackploit.com #
   #                                                   Root@Blackploit.com #
   #########################################################################
--------------------------------------------------
 HASH: 8d6e34f987851aa599257d3831a1af040886842f

Possible Hashs:
[+] SHA-1
[+] MySQL5 - SHA-1(SHA-1($pass))

[..]
```
Answer: _SHA-1_

Perform a dictionary attack against the following hash: 8d6e34f987851aa599257d3831a1af040886842f. What is the cracked value? Use rockyou.txt wordlist.
```bash
kali@kali  ~  hashcat -a 0 -m 100 --force 8d6e34f987851aa599257d3831a1af040886842f /usr/share/wordlists/rockyou.txt
hashcat (v6.2.6) starting

You have enabled --force to bypass dangerous warnings and errors!
This can hide serious problems and should only be done when debugging.
Do not report hashcat issues encountered when using --force.

OpenCL API (OpenCL 3.0 PoCL 3.0+debian  Linux, None+Asserts, RELOC, LLVM 14.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
============================================================================================================================================
* Device #1: pthread-11th Gen Intel(R) Core(TM) i7-1165G7 @ 2.80GHz, 2918/5900 MB (1024 MB allocatable), 2MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

ATTENTION! Pure (unoptimized) backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Temperature abort trigger set to 90c

Host memory required for this attack: 0 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

8d6e34f987851aa599257d3831a1af040886842f:sunshine         
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 100 (SHA1)
Hash.Target......: 8d6e34f987851aa599257d3831a1af040886842f
Time.Started.....: Wed Jan 25 10:36:13 2023, (0 secs)
Time.Estimated...: Wed Jan 25 10:36:13 2023, (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   395.0 kH/s (0.25ms) @ Accel:512 Loops:1 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 1024/14344385 (0.01%)
Rejected.........: 0/1024 (0.00%)
Restore.Point....: 0/14344385 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: 123456 -> bethany
Hardware.Mon.#1..: Util: 11%

Started: Wed Jan 25 10:36:02 2023
Stopped: Wed Jan 25 10:36:14 2023

```

Answer: _sunshine_

  
Perform a brute-force attack against the following MD5 hash: e48e13207341b6bffb7fb1622282247b. What is the cracked value? Note the password is a 4 digit number: [0-9][0-9][0-9][0-9]

```bash
┌──(kali㉿kali)-[~]
└─$ hashcat -a 3 -m 0 e48e13207341b6bffb7fb1622282247b ?d?d?d?d 
hashcat (v6.2.6) starting

OpenCL API (OpenCL 3.0 PoCL 3.0+debian  Linux, None+Asserts, RELOC, LLVM 14.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
============================================================================================================================================
* Device #1: pthread-11th Gen Intel(R) Core(TM) i7-1165G7 @ 2.80GHz, 2918/5900 MB (1024 MB allocatable), 2MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates

Optimizers applied:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Brute-Force
* Raw-Hash

ATTENTION! Pure (unoptimized) backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Temperature abort trigger set to 90c

Host memory required for this attack: 0 MB

The wordlist or mask that you are using is too small.
This means that hashcat cannot use the full parallel power of your device(s).
Unless you supply more work, your cracking speed will drop.
For tips on supplying more work, see: https://hashcat.net/faq/morework

Approaching final keyspace - workload adjusted.           

e48e13207341b6bffb7fb1622282247b:1337                     
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 0 (MD5)
Hash.Target......: e48e13207341b6bffb7fb1622282247b
Time.Started.....: Wed Jan 25 10:37:45 2023 (0 secs)
Time.Estimated...: Wed Jan 25 10:37:45 2023 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Mask.......: ?d?d?d?d [4]
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........: 16754.7 kH/s (0.41ms) @ Accel:512 Loops:10 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 10000/10000 (100.00%)
Rejected.........: 0/10000 (0.00%)
Restore.Point....: 0/1000 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-10 Iteration:0-10
Candidate.Engine.: Device Generator
Candidates.#1....: 1234 -> 6764
Hardware.Mon.#1..: Util: 23%

Started: Wed Jan 25 10:37:44 2023
Stopped: Wed Jan 25 10:37:46 2023

┌──(kali㉿kali)-[~]
└─$ hashcat -a 3 -m 0 e48e13207341b6bffb7fb1622282247b ?d?d?d?d --show                          
e48e13207341b6bffb7fb1622282247b:1337
```
Answer: _1337_



Task 6 - Offline Attacks
----------------------------------------
Rule-Based






