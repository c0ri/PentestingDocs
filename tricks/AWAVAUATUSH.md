I recently came across a notice that one of the files in my linux distro changed.

`/usr/bin/diff`

Since I didn't notice any updates, and since no other files were changed, I wanted to double check I hadn't been hacked or something by investigating the file.

One one of the 1st things I did was run strings on it:

```bash
strings /usr/bin/diff
[ .. ]
AVAUATUSH
t$ H
D;=-
L$(H
T$ A
\$8I9
t$8H
L$(A
T$ H
t$8L
D$4A
[]A\A]A^A_
ATUH
#[]A\
ATUSL
([]A\A]A^A_
T$0A
D$8H
D$ H
T$0H
t$(A
\$8M
D$ H
H[]A\A]A^A_
D$81
L$8dH3
D$81
T$8dH3
@[]A\
D$81
D$ H
D$(H
D$0D
t$8dH34%(
D$81
D$ H
D$(H
L$8dH3
@[]A\
AVAUATI
\$ L
|$(H
\$@L
t$8L
l$0u
D$0H)
T$(H
t$ M
\$0H
\$0H
D$0H)
|$(H
\$0H
l$8H
T$(H
t$ M
|$(M
[]A\A]A^A_
AWAVI
AUATUSH
D$(1
D$ L
D$ H
T$ L
D$ H
|$(dH3<%(
8[]A\A]A^A_
ATUS
[]A\
[]A\
[ .. ]
```

I came across all these instances of `AWAVAUATUSH, AUATUSH, AVAUATI`, etc.

Interestingly these are common  as opcode instructions as I will show here.

 `for i in *; do strings $i |grep AVAUATUSH && echo $i; done`

shows that a numer of files had this strings.

Let's check one out:

```bash
strings -otx /bin/gzip | grep AWAVAUATUSH
   35e0 AWAVAUATUSH
   69a0 AWAVAUATUSH
   7920 AWAVAUATUSH
   8900 AWAVAUATUSH
   92a0 AWAVAUATUSH
```

What section does it happen in?

```bash
readelf -WS /bin/gzip

There are 28 section headers, starting at offset 0x16860:

Section Headers:
  [Nr] Name              Type            Address          Off    Size   ES Flg Lk Inf Al
  [ 0]                   NULL            0000000000000000 000000 000000 00      0   0  0
  [ 1] .interp           PROGBITS        0000000000400238 000238 00001c 00   A  0   0  1
  [ 2] .note.ABI-tag     NOTE            0000000000400254 000254 000020 00   A  0   0  4
  [ 3] .note.gnu.build-id NOTE            0000000000400274 000274 000024 00   A  0   0  4
  [ 4] .gnu.hash         GNU_HASH        0000000000400298 000298 000038 00   A  5   0  8
  [ 5] .dynsym           DYNSYM          00000000004002d0 0002d0 000870 18   A  6   1  8
  [ 6] .dynstr           STRTAB          0000000000400b40 000b40 000360 00   A  0   0  1
  [ 7] .gnu.version      VERSYM          0000000000400ea0 000ea0 0000b4 02   A  5   0  2
  [ 8] .gnu.version_r    VERNEED         0000000000400f58 000f58 000080 00   A  6   1  8
  [ 9] .rela.dyn         RELA            0000000000400fd8 000fd8 000090 18   A  5   0  8
  [10] .rela.plt         RELA            0000000000401068 001068 0007e0 18   A  5  12  8
  [11] .init             PROGBITS        0000000000401848 001848 00001a 00  AX  0   0  4
  [12] .plt              PROGBITS        0000000000401870 001870 000550 10  AX  0   0 16
  [13] .text             PROGBITS        0000000000401dc0 001dc0 00f1ba 00  AX  0   0 16
  [14] .fini             PROGBITS        0000000000410f7c 010f7c 000009 00  AX  0   0  4
... etc.
```

Ok, so from the output we see instances of that string are in the .text section starting at [0x1dc0, 0x10f7a] offsets.

The address we are interested in here is 0x401dc0 (.text address) + 0x35e0 (offset of AWAVAUATUSH in the file) - 0x1dc0 (offset of .text in the file) == 0x4035e0

Is that correct?

```bash
gdb -q /bin/gzip

(gdb) x/s 0x4035e0
0x4035e0:       "AWAVAUATUSH\203\354HdH\213\004%("
```

yea.. next, what instructions are there?

```bash
(gdb) x/20i 0x4035e0
   0x4035e0:    push   %r15
   0x4035e2:    push   %r14
   0x4035e4:    push   %r13
   0x4035e6:    push   %r12
   0x4035e8:    push   %rbp
   0x4035e9:    push   %rbx
   0x4035ea:    sub    $0x48,%rsp
   0x4035ee:    mov    %fs:0x28,%rax
   0x4035f7:    mov    %rax,0x38(%rsp)
   0x4035fc:    xor    %eax,%eax
   0x4035fe:    mov    0x213363(%rip),%rax        # 0x616968
   0x403605:    mov    %rdi,(%rsp)
   0x403609:    mov    %rax,0x212cf0(%rip)        # 0x616300
   0x403610:    cmpb   $0x7a,(%rax)
   0x403613:    je     0x403730
   0x403619:    mov    $0x616300,%ebx
   0x40361e:    mov    (%rsp),%rdi
   0x403622:    callq  0x4019f0 <strlen@plt>
   0x403627:    cmp    $0x20,%eax
   0x40362a:    mov    %rax,0x8(%rsp)
```


Those are normal instructions. You can see a list here:

https://www.sandpile.org/x86/opc_1.htm

For example 0x41, 0x57 is push %r15 and those opcodes just happen to spell AW in ASCII, and so on.

Here is another way to disassemble the seq:
```bash
$ echo -n AWAVAUATUSH | rasm2 -B -a x86 -b 64 -Df -
0x00000000   2                     4157  push r15
0x00000002   2                     4156  push r14
0x00000004   2                     4155  push r13
0x00000006   2                     4154  push r12
0x00000008   1                       55  push rbp
0x00000009   1                       53  push rbx
0x0000000a   1                       48  invalid
```

Anyway, these opcode are very common in all x86 executables.

