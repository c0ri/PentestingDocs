
Please note you must be administrator to see this setting:

```powershell
Administrator  ~  ♥ 08:33  $Preferences = Get-MpPreference

Administrator  ~  ♥ 08:58  $Preferences.ExclusionPath

```

 Here we have nothing listed. If we  have something listed:


Store the folders in a variable ($currentItems):
```powershell
$currentItems=@($Preferences.ExclusionPath)
```

Then we can remove Items like this assuming $currentItems isn't empty:

```powershell
$newItems = $currentItems -notlike "C:\Users\sync\Pycharm"
$newItems = $currentItems -notlike "C:\Source\Project*"
```

Verifying the resulting list:
```powershell
$newItems
```

If we want to add folders:

```powershell
$updatedList=$newItems
$updatedList += "C:\Users\sync\PycharmProjects\"
$updatedList += "C:\Source\"
$updatedList
```

Now we can store our changed list to Defender:
```powershell
Set-MpPreference -ExclusionPath $updatedList
```

And verify the result:

```powershell
Get-MpPreference | %{$_.ExclusionPath}
```

Script to add the current folder to exclude list:

```powershell
$defSettings = Get-MpPreference
$currentItems=@($defSettings.ExclusionPath)
$currentItems +=$pwd.Path
$currentItems
Set-MpPreference -ExclusionPath $currentItems
```

